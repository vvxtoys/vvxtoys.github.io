<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>vvxtoys&#39;s Blog</title>
    <link>http://vvxtoys.cc/</link>
    <atom:link href="/atom.xml" rel="self" type="application/rss+xml"/>
    
    <description>向死而生</description>
    <pubDate>Mon, 24 Sep 2018 09:08:42 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>使用nexus3.x搭建maven私服</title>
      <link>http://vvxtoys.cc/2018/09/19/%E4%BD%BF%E7%94%A8nexus3.x%E6%90%AD%E5%BB%BAmaven%E7%A7%81%E6%9C%8D/</link>
      <guid>http://vvxtoys.cc/2018/09/19/%E4%BD%BF%E7%94%A8nexus3.x%E6%90%AD%E5%BB%BAmaven%E7%A7%81%E6%9C%8D/</guid>
      <pubDate>Wed, 19 Sep 2018 12:20:49 GMT</pubDate>
      <description>
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;  好久之前就想搭建maven仓库了，一直拖到了现在，也就是懒得动，现在终于是要付诸行动了。网上查了不少资料，好多博客都是关于2.x的搭建，我下载的是最新版的nexus，好多教程已经不能使用，以此记录我的踩坑搭建之路。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>  好久之前就想搭建maven仓库了，一直拖到了现在，也就是懒得动，现在终于是要付诸行动了。网上查了不少资料，好多博客都是关于2.x的搭建，我下载的是最新版的nexus，好多教程已经不能使用，以此记录我的踩坑搭建之路。</p>  <a id="more"></a><h2 id="安装环境和需要的软件"><a href="#安装环境和需要的软件" class="headerlink" title="安装环境和需要的软件"></a>安装环境和需要的软件</h2><ul><li>Centos 7</li><li>Java 1.8 </li><li>nexus OSS 3.13</li></ul><h2 id="Java安装"><a href="#Java安装" class="headerlink" title="Java安装"></a>Java安装</h2><ul><li>卸载openjdk</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1.rpm -qa|grep java 查找</div><div class="line">2.rpm -e --nodeps xxxx 卸载openjdk</div></pre></td></tr></table></figure><ul><li>下载jdk</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate --no-cookies --header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; &quot;http://download.oracle.com/otn-pub/java/jdk/8u181-b13/96a7b8442fe848ef90c96a2fad6ed6d1/jdk-8u181-linux-x64.tar.gz&quot;</div></pre></td></tr></table></figure><ul><li>安装</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">1.mkdir /usr/java 在/usr下建立Java文件夹</div><div class="line">2.mv jdk-8u181-linux-x64.tar.gz /usr/java/jdk-8u181-linux-x64.tar.gz</div><div class="line">3.tar -xzvf jdk-8u181-linux-x64.tar.gz 解压</div><div class="line">4.mv jdk1.8.0_181/ jdk1.8</div><div class="line">5.vim /etc/profile</div><div class="line">6.设置环境变量</div><div class="line">JAVA_HOME=/usr/java/jdk1.8</div><div class="line">JRE_HOME=/usr/java/jdk1.8/jre</div><div class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</div><div class="line">CLASSPARH=,:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</div><div class="line">export JAVA_HOME JRE_HOME PATH CLASSPATH</div><div class="line">分隔符是冒号不是分号</div><div class="line">7.source /etc/profile 使环境变量生效</div><div class="line">8.java -version 查看Java版本</div></pre></td></tr></table></figure><h2 id="Nexus安装"><a href="#Nexus安装" class="headerlink" title="Nexus安装"></a>Nexus安装</h2><ul><li>创建文件夹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir /usr/software/nexus</div></pre></td></tr></table></figure><ul><li>下载安装文件 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/software/nexus</div><div class="line">wget &quot;https://sonatype-download.global.ssl.fastly.net/repository/repositoryManager/3/nexus-3.13.0-01-unix.tar.gz&quot;</div></pre></td></tr></table></figure><ul><li>解压</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -xzvf nexus-3.13.0-01-unix.tar.gz</div></pre></td></tr></table></figure><p>解压后</p><p><img src="https://i.loli.net/2018/09/19/5ba24aee0fc0e.png" alt=""></p><ul><li>修改配置文件 也可以不改</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd nexus-3.13.0-01/etc</div><div class="line">vim nexus-default.properties</div></pre></td></tr></table></figure><p>默认端口8081,我修改为5743</p><p><img src="https://i.loli.net/2018/09/19/5ba24cf8db310.png" alt=""></p><ul><li>开放端口 root用户</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">1.查看防火墙状态</div><div class="line">firewall-cmd --state</div><div class="line">2.如果关闭开启防火墙</div><div class="line">systemctl start firewalld.service</div><div class="line">3.开放5743端口(以自己的配置为准)</div><div class="line">firewall-cmd --zone=public --add-port=5743/tcp --permanent </div><div class="line">4.重新加载</div><div class="line">firewall-cmd --reload</div><div class="line">5.重启防火墙</div><div class="line">systemctl restart firewalld.service</div></pre></td></tr></table></figure><ul><li><p>启动nexus</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cd nexus-3.13.0-01/bin</div><div class="line">./nexus start</div><div class="line">常用命令</div><div class="line">./nexus restart</div><div class="line">./nexus stop</div></pre></td></tr></table></figure></li><li><p>本地访问 ip:端口号 默认账户admin 密码 admin123</p><p><img src="https://i.loli.net/2018/09/19/5ba250721ef32.png" alt=""></p></li></ul><ul><li><p>选择Repositories  创建三方私有库<br><img src="https://i.loli.net/2018/09/19/5ba2517e0be97.png" alt=""></p></li><li><p>我创建了两个maven hosted仓库<br><img src="https://i.loli.net/2018/09/19/5ba252b4a63a9.png" alt="5.png"></p></li><li><p>将这两个仓库加入到maven-public中</p><p>点击maven-public</p><p><img src="https://i.loli.net/2018/09/19/5ba254898e0de.png" alt=""></p><p>到这里线上就配置完成了</p></li></ul><h2 id="配置Maven"><a href="#配置Maven" class="headerlink" title="配置Maven"></a>配置Maven</h2><ul><li>找到setting.xml 在mirrors中添加mirror</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span></span></div><div class="line">&lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>central repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>在servers中添加server</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- id与pom.xml中的distributionManagement下repository的id对应 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>在profiles中添加profile</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>激活profile</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activeProfiles</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--profile下的id--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">activeProfile</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">activeProfile</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">activeProfiles</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="上传jar-发布项目"><a href="#上传jar-发布项目" class="headerlink" title="上传jar 发布项目"></a>上传jar 发布项目</h2><ul><li>网页上传jar  upload</li></ul><p><img src="https://i.loli.net/2018/09/19/5ba2621c14d0b.png" alt=""></p><ul><li><p>maven deploy</p><ul><li>pom.xml 添加 distributionManagement</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></div></pre></td></tr></table></figure><p>id要和setting.xml中的server id一致</p><ul><li>运行maven deploy</li></ul><p><img src="https://i.loli.net/2018/09/19/5ba2634c00802.png" alt=""></p></li><li><p>查看线上</p></li></ul><p><img src="https://i.loli.net/2018/09/19/5ba263e5c1765.png" alt=""><br>发布成功,以后可以直接在别的项目中使用</p>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/09/19/%E4%BD%BF%E7%94%A8nexus3.x%E6%90%AD%E5%BB%BAmaven%E7%A7%81%E6%9C%8D/#disqus_thread</comments>
    </item>
    
    <item>
      <title>vgenerator(三)</title>
      <link>http://vvxtoys.cc/2018/07/11/vgenerator3/</link>
      <guid>http://vvxtoys.cc/2018/07/11/vgenerator3/</guid>
      <pubDate>Wed, 11 Jul 2018 06:00:26 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;该项目的最后一篇博文，最终构建，写入文件，整体项目流程将在本片文章中写出。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>该项目的最后一篇博文，最终构建，写入文件，整体项目流程将在本片文章中写出。</p><a id="more"></a><h3 id="jdbcType"><a href="#jdbcType" class="headerlink" title="jdbcType"></a>jdbcType</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*mysql单位 -&gt; jdbcType</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> JdbcType &#123;</div><div class="line"></div><div class="line">DATE(<span class="string">",date,year,"</span>),</div><div class="line">LONGVARCHAR(<span class="string">",longtext,text,mediumtext,"</span>),</div><div class="line">INTEGER(<span class="string">",int,mediumint,"</span>),</div><div class="line">REAL(<span class="string">",float,"</span>),</div><div class="line">OTHER(<span class="string">",point,multipoint,multilinestring,multipolygon,polygon,geometrycollection,linestring,"</span>),</div><div class="line">TINYINT(<span class="string">",tinyint,"</span>),</div><div class="line">BIGINT(<span class="string">",bigint,"</span>),</div><div class="line">TIMESTAMP(<span class="string">",datetime,timestamp,"</span>),</div><div class="line">VARCHAR(<span class="string">",varchar,tinytext,"</span>),</div><div class="line">BINARY(<span class="string">",tinyblob,binary,geometry,"</span>),</div><div class="line">CHAR(<span class="string">",enum,char,set,"</span>),</div><div class="line">DOUBLE(<span class="string">",double,"</span>),</div><div class="line">BIT(<span class="string">",bit,"</span>),</div><div class="line">SMALLINT(<span class="string">",smallint,"</span>),</div><div class="line">LONGVARBINARY(<span class="string">",mediumblob,blob,longblob,"</span>),</div><div class="line">DECIMAL(<span class="string">",decimal,"</span>),</div><div class="line">VARBINARY(<span class="string">",varbinary,"</span>),</div><div class="line">TIME(<span class="string">",time,"</span>);</div><div class="line"></div><div class="line"><span class="keyword">private</span> String type;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">JdbcType</span><span class="params">(String type)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.type = type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJdbcType</span><span class="params">(String dbtype)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(dbtype.indexOf(<span class="string">"("</span>)!=-<span class="number">1</span>)&#123;</div><div class="line">dbtype = dbtype.substring(<span class="number">0</span>,dbtype.indexOf(<span class="string">"("</span>));</div><div class="line">&#125;</div><div class="line">dbtype = <span class="string">","</span>+dbtype+<span class="string">","</span>;</div><div class="line"><span class="keyword">for</span>(JdbcType jdbc:JdbcType.values())&#123;</div><div class="line"><span class="keyword">if</span>(jdbc.getType().indexOf(dbtype)!=-<span class="number">1</span>)&#123;</div><div class="line"><span class="keyword">return</span> jdbc.name();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="string">"OTHER"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="生成xml"><a href="#生成xml" class="headerlink" title="生成xml"></a>生成xml</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*添加xml节点</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.vgenerator;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.MapperFactory;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlGenerator</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> XMLBean xml;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> k_size;<span class="comment">//主键数</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> c_size;<span class="comment">//去除主键列数</span></div><div class="line"><span class="keyword">private</span> String column;</div><div class="line"><span class="keyword">private</span> String endText = <span class="string">""</span>;<span class="comment">//最后一行  where id  = ""</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; keys;   <span class="comment">//主键   name = jdbctype</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; columns;<span class="comment">//列      name = jdbctype</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">SqlGenerator</span><span class="params">(XMLBean xml)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.xml = xml;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorSql</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(k_size&gt;<span class="number">0</span>)&#123;</div><div class="line">generator1();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">generator2();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generator1</span><span class="params">()</span></span>&#123;</div><div class="line">addResultMap();</div><div class="line">addSql();</div><div class="line">addInsert1();</div><div class="line">addInsert2();</div><div class="line">addSelect();</div><div class="line">addDelete();</div><div class="line">addUpdate1();</div><div class="line">addUpdate2();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generator2</span><span class="params">()</span></span>&#123;</div><div class="line">addResultMap();</div><div class="line">addSql();</div><div class="line">addInsert1();</div><div class="line">addInsert2();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addResultMap</span><span class="params">()</span></span>&#123;</div><div class="line">column  = <span class="string">""</span>;</div><div class="line"><span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">XMLBean resultMap = <span class="keyword">new</span> XMLBean(<span class="string">"resultMap"</span>);</div><div class="line">xml.addElement(resultMap);</div><div class="line">resultMap.init();</div><div class="line">resultMap.addAttribute(<span class="string">"id"</span>, <span class="string">"BaseResultMap"</span>);</div><div class="line">resultMap.addAttribute(<span class="string">"type"</span>, xml.getPojo());</div><div class="line"><span class="keyword">if</span>(k_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:keys.keySet())&#123;</div><div class="line">XMLBean id = <span class="keyword">new</span> XMLBean(<span class="string">"id"</span>);</div><div class="line">resultMap.addElement(id);</div><div class="line">id.init();</div><div class="line">id.addAttribute(<span class="string">"column"</span>, key);</div><div class="line">id.addAttribute(<span class="string">"property"</span>, key);</div><div class="line">id.addAttribute(<span class="string">"jdbcType"</span>, keys.get(key));</div><div class="line"><span class="keyword">if</span>(count&gt;<span class="number">10</span>)&#123;</div><div class="line">column+=<span class="string">"\n"</span>;</div><div class="line">count=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">column+=<span class="string">","</span>+key;</div><div class="line">            count++;</div><div class="line">            setEndText(key, keys.get(key));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean result = <span class="keyword">new</span> XMLBean(<span class="string">"result"</span>);</div><div class="line">resultMap.addElement(result);</div><div class="line">result.init();</div><div class="line">result.addAttribute(<span class="string">"column"</span>, key);</div><div class="line">result.addAttribute(<span class="string">"property"</span>, key);</div><div class="line">result.addAttribute(<span class="string">"jdbcType"</span>, columns.get(key));</div><div class="line"><span class="keyword">if</span>(count&gt;<span class="number">10</span>)&#123;</div><div class="line">column+=<span class="string">"\n"</span>;</div><div class="line">count=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">column+=<span class="string">","</span>+key;</div><div class="line">            count++;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addSql</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean sql = <span class="keyword">new</span> XMLBean(<span class="string">"sql"</span>);</div><div class="line">xml.addElement(sql);</div><div class="line">sql.init();</div><div class="line">sql.addAttribute(<span class="string">"id"</span>, <span class="string">"Base_Column_List"</span>);</div><div class="line">sql.addText(column.substring(<span class="number">1</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addSelect</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean select = <span class="keyword">new</span> XMLBean(<span class="string">"select"</span>);</div><div class="line">xml.addElement(select);</div><div class="line">select.init();</div><div class="line">select.addAttribute(<span class="string">"id"</span>, Vconst.select);</div><div class="line">select.addAttribute(<span class="string">"resultMap"</span>, <span class="string">"BaseResultMap"</span>);</div><div class="line"><span class="keyword">if</span>(k_size==<span class="number">1</span>)&#123;</div><div class="line">String prefix = <span class="string">"java.lang."</span>;</div><div class="line">String type = MapperFactory.ktypes.get(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span>(type.equalsIgnoreCase(<span class="string">"date"</span>))&#123;</div><div class="line">type = <span class="string">"java.util.Date"</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">type = prefix+type;</div><div class="line">&#125;</div><div class="line">select.addAttribute(<span class="string">"parameterType"</span>, type);</div><div class="line">&#125;</div><div class="line">select.addText(<span class="string">"select"</span>);</div><div class="line">XMLBean include = <span class="keyword">new</span> XMLBean(<span class="string">"include"</span>);</div><div class="line">select.addElement(include);</div><div class="line">include.init();</div><div class="line">include.addAttribute(<span class="string">"refid"</span>, <span class="string">"Base_Column_List"</span>);</div><div class="line">select.addEndText(<span class="string">"from "</span>+xml.getTname());</div><div class="line">select.addText(getEndText());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addDelete</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean delete = <span class="keyword">new</span> XMLBean(<span class="string">"delete"</span>);</div><div class="line">xml.addElement(delete);</div><div class="line">delete.init();</div><div class="line">delete.addAttribute(<span class="string">"id"</span>, Vconst.delete);</div><div class="line"><span class="keyword">if</span>(k_size==<span class="number">1</span>)&#123;</div><div class="line">String prefix = <span class="string">"java.lang."</span>;</div><div class="line">String type = MapperFactory.ktypes.get(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span>(type.equalsIgnoreCase(<span class="string">"date"</span>))&#123;</div><div class="line">type = <span class="string">"java.util.Date"</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">type = prefix+type;</div><div class="line">&#125;</div><div class="line">delete.addAttribute(<span class="string">"parameterType"</span>, type);</div><div class="line">&#125;</div><div class="line">delete.addText(<span class="string">"delete from "</span>+xml.getTname());</div><div class="line">delete.addText(getEndText());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addInsert1</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean insert = <span class="keyword">new</span> XMLBean(<span class="string">"insert"</span>);</div><div class="line">xml.addElement(insert);</div><div class="line">insert.init();</div><div class="line">insert.addAttribute(<span class="string">"id"</span>, Vconst.insert);</div><div class="line">insert.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line">String attr = <span class="keyword">null</span>;</div><div class="line">String jdbc = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">int</span> count1 = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> count2 = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span>(k_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:keys.keySet())&#123;</div><div class="line"><span class="keyword">if</span>(attr==<span class="keyword">null</span>)&#123;</div><div class="line">attr = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">attr+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(jdbc==<span class="keyword">null</span>)&#123;</div><div class="line">jdbc = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">jdbc+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(count1&gt;<span class="number">10</span>)&#123;</div><div class="line">attr+=<span class="string">"\n"</span>;</div><div class="line">count1=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(count2&gt;<span class="number">3</span>)&#123;</div><div class="line">jdbc+=<span class="string">"\n"</span>;</div><div class="line">count2=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">count1++;</div><div class="line">count2++;</div><div class="line">attr+=key;</div><div class="line">jdbc+=<span class="string">"#&#123;"</span>+key+<span class="string">","</span>+<span class="string">"jdbcType="</span>+keys.get(key)+<span class="string">"&#125;"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line"><span class="keyword">if</span>(attr==<span class="keyword">null</span>)&#123;</div><div class="line">attr = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">attr+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(jdbc==<span class="keyword">null</span>)&#123;</div><div class="line">jdbc = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">jdbc+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(count1&gt;<span class="number">10</span>)&#123;</div><div class="line">attr+=<span class="string">"\n"</span>;</div><div class="line">count1=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(count2&gt;<span class="number">3</span>)&#123;</div><div class="line">jdbc+=<span class="string">"\n"</span>;</div><div class="line">count2=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">count1++;</div><div class="line">count2++;</div><div class="line">attr+=key;</div><div class="line">jdbc+=<span class="string">"#&#123;"</span>+key+<span class="string">","</span>+<span class="string">"jdbcType="</span>+columns.get(key)+<span class="string">"&#125;"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">attr+=<span class="string">")"</span>;</div><div class="line">jdbc+=<span class="string">")"</span>;</div><div class="line">insert.addText(<span class="string">"insert into "</span>+xml.getTname());</div><div class="line">insert.addText(attr);</div><div class="line">insert.addText(<span class="string">"values"</span>);</div><div class="line">insert.addText(jdbc);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addInsert2</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean insert = <span class="keyword">new</span> XMLBean(<span class="string">"insert"</span>);</div><div class="line">xml.addElement(insert);</div><div class="line">insert.init();</div><div class="line">insert.addAttribute(<span class="string">"id"</span>, Vconst.insert1);</div><div class="line">insert.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line"></div><div class="line">insert.addText(<span class="string">"insert into "</span>+xml.getTname());</div><div class="line">XMLBean trim = <span class="keyword">new</span> XMLBean(<span class="string">"trim"</span>);</div><div class="line">insert.addElement(trim);</div><div class="line">trim.init();</div><div class="line">trim.addAttribute(<span class="string">"prefix"</span>, <span class="string">"("</span>);</div><div class="line">trim.addAttribute(<span class="string">"suffix"</span>, <span class="string">")"</span>);</div><div class="line">trim.addAttribute(<span class="string">"suffixOverrides"</span>, <span class="string">","</span>);</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean test = <span class="keyword">new</span> XMLBean(<span class="string">"if"</span>);</div><div class="line">trim.addElement(test);</div><div class="line">test.init();</div><div class="line">test.addAttribute(<span class="string">"test"</span>, key+<span class="string">" != null"</span>);</div><div class="line">test.addText(key+<span class="string">","</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">XMLBean trim1 = <span class="keyword">new</span> XMLBean(<span class="string">"trim"</span>);</div><div class="line">insert.addElement(trim1);</div><div class="line">trim1.init();</div><div class="line">trim1.addAttribute(<span class="string">"prefix"</span>, <span class="string">"values ("</span>);</div><div class="line">trim1.addAttribute(<span class="string">"suffix"</span>, <span class="string">")"</span>);</div><div class="line">trim1.addAttribute(<span class="string">"suffixOverrides"</span>, <span class="string">","</span>);</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean test = <span class="keyword">new</span> XMLBean(<span class="string">"if"</span>);</div><div class="line">trim1.addElement(test);</div><div class="line">test.init();</div><div class="line">test.addAttribute(<span class="string">"test"</span>, key+<span class="string">" != null"</span>);</div><div class="line">test.addText(<span class="string">"#&#123;"</span>+key+<span class="string">",jdbcType="</span>+columns.get(key)+<span class="string">"&#125;,"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">insert.addEndText(getEndText());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUpdate1</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean update = <span class="keyword">new</span> XMLBean(<span class="string">"update"</span>);</div><div class="line">xml.addElement(update);</div><div class="line">update.init();</div><div class="line">update.addAttribute(<span class="string">"id"</span>, Vconst.update);</div><div class="line">update.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line"></div><div class="line">update.addText(<span class="string">"update "</span>+xml.getTname());</div><div class="line">String content = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line"><span class="keyword">if</span>(content==<span class="keyword">null</span>)&#123;</div><div class="line">content = <span class="string">"set "</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">content+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line">content+=key+<span class="string">" = "</span>+<span class="string">"#&#123;"</span>+key+<span class="string">",jdbcType="</span>+columns.get(key)+<span class="string">"&#125;\n"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">update.addText(content);</div><div class="line">update.addText(getEndText());</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUpdate2</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean update = <span class="keyword">new</span> XMLBean(<span class="string">"update"</span>);</div><div class="line">xml.addElement(update);</div><div class="line">update.init();</div><div class="line">update.addAttribute(<span class="string">"id"</span>, Vconst.update1);</div><div class="line">update.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line"></div><div class="line">update.addText(<span class="string">"update "</span>+xml.getTname());</div><div class="line">XMLBean set = <span class="keyword">new</span> XMLBean(<span class="string">"set"</span>);</div><div class="line">update.addElement(set);</div><div class="line">set.init();</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean test = <span class="keyword">new</span> XMLBean(<span class="string">"if"</span>);</div><div class="line">set.addElement(test);</div><div class="line">test.init();</div><div class="line">test.addAttribute(<span class="string">"test"</span>, key+<span class="string">" != null"</span>);</div><div class="line">test.addText(key+<span class="string">" = #&#123;"</span>+key+<span class="string">",jdbcType="</span>+columns.get(key)+<span class="string">"&#125;,"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">update.addEndText(getEndText());</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setEndText</span><span class="params">(String key,String value)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(!<span class="string">""</span>.equals(endText))&#123;</div><div class="line">endText +=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line">endText+=key+<span class="string">" = "</span>+<span class="string">"#&#123;"</span>+key+<span class="string">","</span>+<span class="string">"jdbcType="</span>+value+<span class="string">"&#125;"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getEndText</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="string">"where "</span>+endText;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setK_size</span><span class="params">(<span class="keyword">int</span> k_size)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.k_size = k_size;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC_size</span><span class="params">(<span class="keyword">int</span> c_size)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.c_size = c_size;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="write类"><a href="#write类" class="headerlink" title="write类"></a>write类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*写入项目</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.vgenerator;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.ClassBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.MapperBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VgeneratorWrite</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;ClassBean&gt; clazzs = <span class="keyword">new</span> ArrayList&lt;ClassBean&gt;();</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;MapperBean&gt; mappers = <span class="keyword">new</span> ArrayList&lt;MapperBean&gt;();</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;XMLBean&gt; xmls = <span class="keyword">new</span> ArrayList&lt;XMLBean&gt;();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorFile</span><span class="params">()</span> </span>&#123;</div><div class="line">generatorClazz();</div><div class="line">generatorMapper();</div><div class="line">generatorXML();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorClazz</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (clazzs.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (ClassBean bean : clazzs) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">File file = <span class="keyword">new</span> File(bean.getFileName());</div><div class="line">File fileParent = file.getParentFile(); </div><div class="line"><span class="keyword">if</span>(!fileParent.exists())&#123; </div><div class="line">fileParent.mkdirs(); </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(file.exists())&#123;</div><div class="line">file.delete();</div><div class="line">&#125;</div><div class="line">file.createNewFile();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">Common.writeFile(bean.getFileName(), bean.getContext());</div><div class="line">System.out.println(<span class="string">"generator "</span>+bean.getFileName()+<span class="string">" done"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorMapper</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (mappers.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (MapperBean bean : mappers) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">File file = <span class="keyword">new</span> File(bean.getFileName());</div><div class="line">File fileParent = file.getParentFile(); </div><div class="line"><span class="keyword">if</span>(!fileParent.exists())&#123; </div><div class="line">fileParent.mkdirs(); </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(file.exists())&#123;</div><div class="line">file.delete();</div><div class="line">&#125;</div><div class="line">file.createNewFile();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">Common.writeFile(bean.getFileName(), bean.getContext());</div><div class="line">System.out.println(<span class="string">"generator "</span>+bean.getFileName()+<span class="string">" done"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorXML</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (xmls.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (XMLBean bean : xmls) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">File file = <span class="keyword">new</span> File(bean.getFileName());</div><div class="line">File fileParent = file.getParentFile(); </div><div class="line"><span class="keyword">if</span>(!fileParent.exists())&#123; </div><div class="line">fileParent.mkdirs(); </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(file.exists())&#123;</div><div class="line">file.delete();</div><div class="line">&#125;</div><div class="line">file.createNewFile();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">Common.writeFile(bean.getFileName(), bean.toString());</div><div class="line">System.out.println(<span class="string">"generator "</span>+bean.getFileName()+<span class="string">" done"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="generator类"><a href="#generator类" class="headerlink" title="generator类"></a>generator类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*调用该类实现构建</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.vgenerator;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.VgeneratorFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vgenerator</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> VgeneratorFactory factory;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vgenerator</span><span class="params">()</span> </span>&#123;</div><div class="line">factory = <span class="keyword">new</span> VgeneratorFactory();</div><div class="line">&#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vgenerator</span><span class="params">(String configpath)</span></span>&#123;</div><div class="line">    </div><div class="line">    Engine.setConfigFile(configpath);</div><div class="line">    factory = <span class="keyword">new</span> VgeneratorFactory();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">help</span><span class="params">()</span></span>&#123;</div><div class="line">    System.out.println(<span class="string">"url :数据库url"</span>);</div><div class="line">    System.out.println(<span class="string">"name:服务名称"</span>);</div><div class="line">    System.out.println(<span class="string">"user:用户名"</span>);</div><div class="line">    System.out.println(<span class="string">"pass:密码"</span>);</div><div class="line">    System.out.println(<span class="string">"targetProject:生成相对路径"</span>);</div><div class="line">    System.out.println(<span class="string">"targetPackage:实体类包名"</span>);</div><div class="line">    System.out.println(<span class="string">"targetMapper : mapper包名"</span>);</div><div class="line">    System.out.println(<span class="string">"targetXML    : xml包名"</span>);</div><div class="line">    System.out.println(<span class="string">"tableName    : 表名"</span>);</div><div class="line">    System.out.println(<span class="string">"objectName   : 实体名"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span></span>&#123;</div><div class="line">factory.runProperties();</div><div class="line">factory.close();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorAllFromDB</span><span class="params">()</span></span>&#123;</div><div class="line">factory.runDB();</div><div class="line">factory.close();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="generator工厂"><a href="#generator工厂" class="headerlink" title="generator工厂"></a>generator工厂</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.BaseBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.ClassBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.DBtype;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.JdbcType;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.MapperBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.DB;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.SqlGenerator;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VgeneratorFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> VgeneratorWrite write = <span class="keyword">new</span> VgeneratorWrite();</div><div class="line"><span class="keyword">private</span> Engine engine = Engine.getInstance();</div><div class="line"><span class="keyword">private</span> ClassFactory  cF;</div><div class="line"><span class="keyword">private</span> MapperFactory mF;</div><div class="line"><span class="keyword">private</span> XMLFactory    xF;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runProperties</span><span class="params">()</span></span>&#123;</div><div class="line">DB db = DB.getInstance();</div><div class="line">String [] tableNames = Engine.tableName;</div><div class="line">String [] objectNames = Engine.objectName;</div><div class="line"><span class="keyword">if</span>(tableNames.length!=objectNames.length)&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tableNames.length;i++)&#123;</div><div class="line">startOperator(tableNames[i], Common.upInitials(tableNames[i]),db);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tableNames.length;i++)&#123;</div><div class="line">startOperator(tableNames[i], objectNames[i],db);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runDB</span><span class="params">()</span></span>&#123;</div><div class="line">DB db = DB.getInstance();</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">List&lt;String&gt; list = db.getTables();</div><div class="line"><span class="keyword">for</span>(String s:list)&#123;</div><div class="line">startOperator(s, Common.upInitials(s), db);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startOperator</span><span class="params">(String tname,String oname,DB db)</span></span>&#123;</div><div class="line"></div><div class="line">SqlGenerator.keys = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">SqlGenerator.columns = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line"></div><div class="line">ClassBean  bean = <span class="keyword">new</span> ClassBean(oname);</div><div class="line">MapperBean mbean = <span class="keyword">new</span> MapperBean(oname);</div><div class="line">XMLBean    xbean = <span class="keyword">new</span> XMLBean(Vconst.DEFAULT_XML_ROOT,tname,oname);</div><div class="line"></div><div class="line">List&lt;String&gt; ps = db.getPrimaryKey(tname);</div><div class="line"><span class="keyword">if</span>(ps==<span class="keyword">null</span>||ps.size()==<span class="number">0</span>)&#123;</div><div class="line">mbean.setPrimary(<span class="keyword">false</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">cF = <span class="keyword">new</span> ClassFactory(bean);</div><div class="line">mF = <span class="keyword">new</span> MapperFactory(mbean);</div><div class="line">xF = <span class="keyword">new</span> XMLFactory();</div><div class="line"></div><div class="line"><span class="keyword">int</span> k_size = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> c_size = <span class="number">0</span>;</div><div class="line">List&lt;String&gt; kname = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">List&lt;String&gt; ktype = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line"><span class="keyword">boolean</span> flag = <span class="keyword">false</span>;<span class="comment">//是否存在时间格式</span></div><div class="line">Map&lt;String,String&gt; cs = db.getColumns(tname);</div><div class="line"><span class="keyword">for</span>(Map.Entry&lt;String, String&gt; m:cs.entrySet())&#123;</div><div class="line">String name = m.getKey();</div><div class="line">String type = m.getValue();</div><div class="line"></div><div class="line"><span class="keyword">if</span>(mbean.isPrimary()&amp;&amp;ps.contains(name))&#123;</div><div class="line">kname.add(name);</div><div class="line">ktype.add(DBtype.getModelType(type));</div><div class="line">SqlGenerator.keys.put(name, JdbcType.getJdbcType(type));</div><div class="line">k_size++;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">SqlGenerator.columns.put(name, JdbcType.getJdbcType(type));</div><div class="line">c_size++;</div><div class="line">&#125;</div><div class="line">cF.addAttribute(DBtype.getModelType(type), name);</div><div class="line"><span class="keyword">if</span>(type.equalsIgnoreCase(<span class="string">"date"</span>))&#123;</div><div class="line">flag = <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">bean.setDependency(flag);</div><div class="line">cF.autoAddMethod();</div><div class="line">cF.addConstructor();</div><div class="line">cF.loadClass();</div><div class="line"></div><div class="line">MapperFactory.knames = kname;</div><div class="line">MapperFactory.ktypes = ktype;</div><div class="line">mF.loadMapper();</div><div class="line"></div><div class="line">xF.createDoc(xbean,k_size,c_size);</div><div class="line"></div><div class="line">write.generatorFile();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</div><div class="line">engine.clear();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="流程分析"><a href="#流程分析" class="headerlink" title="流程分析"></a>流程分析</h3><ul><li><p>实例化Vgenerator g</p><ul><li>实例化 VgeneratorFactory<ul><li>实例化 VgeneratorWrite</li><li>实例化 Engine<ul><li>读取配置文件,加载文件保存到静态属性</li><li>无参默认使用vgenerator.properties</li><li>有参方法设置自定义配置文件,该方法会设置Engine的isDefault属性</li></ul></li></ul></li></ul></li><li><p>调用g.help</p><ul><li>输出配置文件注释</li></ul></li><li><p>调用g.generator() 读取配置文件中的表(支持多表,英文逗号隔开)，生成对应的文件</p><ul><li>factory.runProperties()<ul><li>DB实例化</li><li>获得表名和实体类名<ul><li>开始构建 startOperator()<ul><li>获得主键和所有列,获得列名和类型，保存到SqlGenerator和MapperFactory</li><li>判断是否存在Date类型 设置classBean的dependency属性</li><li>ClassFactory 生成类文本保存到 classbean的context<ul><li>VgeneratorWrite 保存classbean</li></ul></li><li>MapperFactory根据主键生成mapper文本保存到mapperbean的context<ul><li>VgeneratorWrite 保存mapperbean</li></ul></li><li>xmlFactory创建文本<ul><li>SqlGenerator根据主键生成对应xml文本保存到xmlbean<ul><li>VgeneratorWrite 保存xmlbean</li></ul></li></ul></li><li>VgeneratorWrite  generatorFile生成文件</li></ul></li></ul></li></ul></li><li>factory.clear() 结束</li></ul></li><li><p>调用g.generatorAllFromDB() 构建该数据库所有表,除了需要获取所有表，其他流程都一样。</p></li></ul><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>第一个自己写的小项目，虽然有瑕疵，但是感觉还是蛮充实的。下一步需要加强技术了，看看编程思想和设计模式。</p>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/11/vgenerator3/#disqus_thread</comments>
    </item>
    
    <item>
      <title>vgenerator(二)</title>
      <link>http://vvxtoys.cc/2018/07/11/vgenerator2/</link>
      <guid>http://vvxtoys.cc/2018/07/11/vgenerator2/</guid>
      <pubDate>Wed, 11 Jul 2018 06:00:11 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;接上篇，这一篇主要的工具类和工厂类，包括数据库方法、通用方法，三个工厂。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>接上篇，这一篇主要的工具类和工厂类，包括数据库方法、通用方法，三个工厂。</p><a id="more"></a><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*默认xml开头 </span></div><div class="line"><span class="comment">*文档分隔</span></div><div class="line"><span class="comment">*默认方法名</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.utils;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vconst</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_XML_ROOT     = <span class="string">"mapper"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_XML_PUBLICID = <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_XML_SYSTEMID = <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String [] ROOTELEMENT = <span class="keyword">new</span> String[<span class="number">1</span>];<span class="comment">//根标签</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SPACE = <span class="string">" "</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String LINE = <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAB  = <span class="string">"\t"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TTAB = <span class="string">"\t\t"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String END  = <span class="string">";"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SPLIT    = <span class="string">"\n\n"</span>;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String insert= <span class="string">"insert"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String insert1              = <span class="string">"insertSelective"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String select= <span class="string">"selectByPrimaryKey"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String delete= <span class="string">"deleteByPrimaryKey"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String update= <span class="string">"updateByPrimaryKey"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String update1= <span class="string">"updateByPrimaryKeySelective"</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="公用"><a href="#公用" class="headerlink" title="公用"></a>公用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.utils;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileWriter;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.PrintWriter;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.LinkedList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.XMLFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Common</span> </span>&#123;</div><div class="line"><span class="comment">//查找文件</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">searchAbsolutePath</span><span class="params">(String filename)</span> </span>&#123;</div><div class="line">String absolutePath = <span class="string">""</span>;</div><div class="line">LinkedList&lt;File&gt; list = <span class="keyword">new</span> LinkedList&lt;File&gt;();</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">File src = <span class="keyword">new</span> File(<span class="string">".\\src"</span>);</div><div class="line">File file = <span class="keyword">new</span> File(src.getCanonicalPath());</div><div class="line">File [] files = file.listFiles();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;files.length;i++)&#123;</div><div class="line">list.add(files[i]);</div><div class="line"><span class="keyword">if</span>(files[i].getAbsolutePath().endsWith(filename))&#123;</div><div class="line">absolutePath = files[i].getAbsolutePath();</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">while</span>(!list.isEmpty())&#123;</div><div class="line">File tmp = list.removeFirst();</div><div class="line"></div><div class="line"><span class="keyword">if</span>(tmp.isDirectory())&#123;</div><div class="line">File [] fs = tmp.listFiles();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;fs.length;j++)&#123;</div><div class="line">File f = fs[j];</div><div class="line"><span class="keyword">if</span>(f==<span class="keyword">null</span>)&#123;</div><div class="line"><span class="keyword">continue</span>;</div><div class="line">&#125;</div><div class="line">list.add(fs[j]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(tmp.getAbsolutePath().endsWith(filename))&#123;</div><div class="line">absolutePath = tmp.getAbsolutePath();</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line"><span class="comment">//首字母大写</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">upInitials</span><span class="params">(String str)</span></span>&#123;</div><div class="line"><span class="keyword">return</span> str.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase()+str.substring(<span class="number">1</span>); </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String filePath, String str)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(filePath), <span class="keyword">true</span>);</div><div class="line">PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">pw.println(str);</div><div class="line">pw.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//xml拼接属性</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">ConcatAttr</span><span class="params">(String name,String value)</span></span>&#123;</div><div class="line">String template = <span class="string">" "</span>+name+<span class="string">"="</span>+<span class="string">"\""</span>+value+<span class="string">"\""</span>;</div><div class="line"><span class="keyword">return</span> template;</div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*mysql数据库连接 </span></div><div class="line"><span class="comment">*获取所有表</span></div><div class="line"><span class="comment">*获取所有列</span></div><div class="line"><span class="comment">*获取主键</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.sql.Connection;</div><div class="line"><span class="keyword">import</span> java.sql.DatabaseMetaData;</div><div class="line"><span class="keyword">import</span> java.sql.DriverManager;</div><div class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</div><div class="line"><span class="keyword">import</span> java.sql.ResultSet;</div><div class="line"><span class="keyword">import</span> java.sql.SQLException;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.XMLFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DB</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String url;</div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="keyword">private</span> String user;</div><div class="line"><span class="keyword">private</span> String pass;</div><div class="line"></div><div class="line"><span class="keyword">public</span> Connection conn = <span class="keyword">null</span>;  </div><div class="line"><span class="keyword">public</span> PreparedStatement pst = <span class="keyword">null</span>;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_URL = <span class="string">"jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=utf8"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_NAME = <span class="string">"com.mysql.jdbc.Driver"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_USER    = <span class="string">"root"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PASS= <span class="string">"root"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">DB</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DB <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">DB db = <span class="keyword">new</span> DB();</div><div class="line">db.setName(Engine.name);</div><div class="line">db.setPass(Engine.pass);</div><div class="line">db.setUrl(Engine.url);</div><div class="line">db.setUser(Engine.user);</div><div class="line">db.Connection();</div><div class="line"></div><div class="line"><span class="keyword">return</span> db;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Connection</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">Class.forName(name);</div><div class="line">conn=DriverManager.getConnection(url,user,pass);</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getTables</span><span class="params">()</span></span>&#123;</div><div class="line">List&lt;String&gt; tables = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">  <span class="keyword">try</span>&#123;</div><div class="line">  <span class="keyword">if</span>(conn!=<span class="keyword">null</span>)&#123;</div><div class="line">  DatabaseMetaData dbmd = conn.getMetaData();</div><div class="line">  ResultSet res = dbmd.getTables(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">new</span> String[]&#123;<span class="string">"TABLE"</span>&#125;);</div><div class="line">  <span class="keyword">while</span> (res.next()) &#123;</div><div class="line"> tables.add(res.getString(<span class="number">3</span>));</div><div class="line">&#125;</div><div class="line">  &#125;</div><div class="line">  &#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line"></div><div class="line">  &#125;  </div><div class="line">  <span class="keyword">return</span> tables;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Map&lt;String,String&gt; <span class="title">getColumns</span><span class="params">(String tablename)</span></span>&#123;</div><div class="line">Map&lt;String,String&gt; result = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">String sql = <span class="string">"desc "</span>+tablename;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">pst = conn.prepareStatement(sql);</div><div class="line">PreparedStatement pst = <span class="keyword">this</span>.pst;</div><div class="line">ResultSet res = pst.executeQuery();</div><div class="line"><span class="keyword">while</span>(res.next())&#123;</div><div class="line">String name = res.getString(<span class="number">1</span>);</div><div class="line">String type = res.getString(<span class="number">2</span>);</div><div class="line">result.put(name, type);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getPrimaryKey</span><span class="params">(String tableName)</span></span>&#123;</div><div class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">DatabaseMetaData dmd = conn.getMetaData();</div><div class="line">ResultSet result = dmd.getPrimaryKeys(<span class="string">""</span>, <span class="string">""</span>, tableName);</div><div class="line"><span class="keyword">while</span>(result.next())&#123;</div><div class="line">list.add(result.getString(<span class="number">4</span>));</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> list;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;  </div><div class="line"><span class="keyword">this</span>.conn.close();  </div><div class="line"><span class="keyword">this</span>.pst.close();  </div><div class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;  </div><div class="line">e.printStackTrace();  </div><div class="line">&#125; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.url = url==<span class="keyword">null</span>||<span class="string">""</span>.equals(url)?DEFAULT_URL:url;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name==<span class="keyword">null</span>||<span class="string">""</span>.equals(name)?DEFAULT_NAME:name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(String user)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.user = user==<span class="keyword">null</span>||<span class="string">""</span>.equals(user)?DEFAULT_USER:user;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPass</span><span class="params">(String pass)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.pass = pass==<span class="keyword">null</span>||<span class="string">""</span>.equals(pass)?DEFAULT_PASS:pass;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="配置文件-vgenerator-properties"><a href="#配置文件-vgenerator-properties" class="headerlink" title="配置文件 vgenerator.properties"></a>配置文件 vgenerator.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">targetPackage=cc.vvxtoys.pojo</div><div class="line">targetProject=src/main/java</div><div class="line">objectName=Record</div><div class="line">tableName=record</div><div class="line">targetMapper=cc.vvxtoys.mapper</div><div class="line">targetXML=cc.vvxtoys.mapper</div><div class="line"></div><div class="line"></div><div class="line">user=root</div><div class="line">url=jdbc\:mysql\://127.0.0.1\:3306/test?useUnicode\=true&amp;characterEncoding\=utf8</div><div class="line">name=com.mysql.jdbc.Driver</div><div class="line">pass=root</div></pre></td></tr></table></figure><h3 id="基本的流程"><a href="#基本的流程" class="headerlink" title="基本的流程"></a>基本的流程</h3><ul><li>初始化配置</li><li>初始化db</li><li>读取对应表的列</li><li>把列单位转换为java单位</li><li>开始构建</li></ul><h3 id="转换单位"><a href="#转换单位" class="headerlink" title="转换单位"></a>转换单位</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*这个类是我用一个笨方法得到的，创建了一个所有类型的表，然后用mybatis-generator构建出来</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> DBtype &#123;</div><div class="line"></div><div class="line">Date(<span class="string">",date,datetime,timestamp,year,time,"</span>),</div><div class="line">String(<span class="string">",longtext,text,varchar,enum,char,mediumtext,tinytext,set,"</span>),</div><div class="line">Double(<span class="string">",double,"</span>),</div><div class="line">Integer(<span class="string">",int,mediumint,"</span>),</div><div class="line">Short(<span class="string">",smallint,"</span>),</div><div class="line">Byte(<span class="string">",tinyint,"</span>),</div><div class="line">ByteArray(<span class="string">",tinyblob,mediumblob,binary,blob,longblob,varbinary,geometry,"</span>),</div><div class="line">Object(<span class="string">",point,multipoint,multilinestring,multipolygon,polygon,geometrycollection,linestring,"</span>),</div><div class="line">Long(<span class="string">",bigint,decimal,"</span>),</div><div class="line">Boolean(<span class="string">",bit,"</span>),</div><div class="line">Float(<span class="string">",float,"</span>);</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> String type;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">DBtype</span><span class="params">(String type)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.type = type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getModelType</span><span class="params">(String dbtype)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(dbtype.indexOf(<span class="string">"("</span>)!=-<span class="number">1</span>)&#123;</div><div class="line">dbtype = dbtype.substring(<span class="number">0</span>,dbtype.indexOf(<span class="string">"("</span>));</div><div class="line">&#125;</div><div class="line">dbtype = <span class="string">","</span>+dbtype+<span class="string">","</span>;</div><div class="line"><span class="keyword">for</span>(DBtype db:DBtype.values())&#123;</div><div class="line"><span class="keyword">if</span>(db.getType().indexOf(dbtype)!=-<span class="number">1</span>)&#123;</div><div class="line">String model = db.name();</div><div class="line"><span class="keyword">if</span>(model.equals(<span class="string">"ByteArray"</span>))&#123;</div><div class="line">model = <span class="string">"byte[]"</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> model;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="string">"String"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="创建classFactory"><a href="#创建classFactory" class="headerlink" title="创建classFactory"></a>创建classFactory</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*该类实现拼接java</span></div><div class="line"><span class="comment">*生成属性、方法、构造,放进context</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.ClassBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> ClassBean bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span>  List&lt;String&gt; attrs;</div><div class="line"><span class="keyword">public</span>  List&lt;String&gt; types;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassFactory</span><span class="params">(ClassBean bean)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.bean = bean;</div><div class="line">attrs = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">types = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttribute</span><span class="params">(String declare,String type,String name)</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(Vconst.TAB);</div><div class="line">buff.append(declare);</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">buff.append(type);</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">buff.append(name);</div><div class="line">buff.append(Vconst.END);</div><div class="line">buff.append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setAttributes(bean.getAttributes()+buff.toString());</div><div class="line"></div><div class="line">attrs.add(name);</div><div class="line">types.add(type);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttribute</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">addAttribute(<span class="string">"private"</span>, type, name);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttributes</span><span class="params">(String declare,String [] type,String [] name)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(type.length!=name.length)&#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Attribute not available"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;type.length;i++)&#123;</div><div class="line">addAttribute(declare, type[i], name[i]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttributes</span><span class="params">(String [] type,String [] name)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(type.length!=name.length)&#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Attribute not available"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;type.length;i++)&#123;</div><div class="line">addAttribute(type[i], name[i]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addGetMethod</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(type).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"get"</span>);</div><div class="line">buffer.append(Common.upInitials(name)).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"("</span>);</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"return"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(name);</div><div class="line">buffer.append(Vconst.END);</div><div class="line">buffer.append(Vconst.LINE).append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setMethods(bean.getMethods()+buffer.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addSetMethod</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"void"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"set"</span>);</div><div class="line">buffer.append(Common.upInitials(name)).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"("</span>);</div><div class="line">buffer.append(type).append(Vconst.SPACE);</div><div class="line">buffer.append(name);</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"this."</span>).append(name).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"="</span>).append(Vconst.SPACE).append(name);</div><div class="line">buffer.append(Vconst.END);</div><div class="line">buffer.append(Vconst.LINE).append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setMethods(bean.getMethods()+buffer.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMethod</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">addGetMethod(type, name);</div><div class="line">addSetMethod(type, name);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoAddMethod</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.size();i++)&#123;</div><div class="line">addMethod(types.get(i),attrs.get(i));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addConstructor</span><span class="params">()</span></span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(bean.getClazz()).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"()"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"super();"</span>).append(Vconst.LINE).append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(bean.getClazz()).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"("</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.size();i++)&#123;</div><div class="line"><span class="keyword">if</span>(i&gt;<span class="number">0</span>)&#123;</div><div class="line">buffer.append(<span class="string">","</span>);</div><div class="line">&#125;</div><div class="line">buffer.append(types.get(i)).append(Vconst.SPACE).append(attrs.get(i));</div><div class="line">&#125;</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"super();"</span>).append(Vconst.LINE);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;attrs.size();j++)&#123;</div><div class="line">buffer.append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"this."</span>).append(attrs.get(j));</div><div class="line">buffer.append(Vconst.SPACE).append(<span class="string">"="</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(attrs.get(j)).append(Vconst.END).append(Vconst.LINE);</div><div class="line">&#125;</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setConstructors(bean.getConstructors()+buffer.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadClass</span><span class="params">(String declare)</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(<span class="string">"package"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getPackages()).append(Vconst.END);</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line"><span class="keyword">if</span>(bean.isDependency())&#123;</div><div class="line">buff.append(<span class="string">"import"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"java.util.Date"</span>).append(Vconst.END);</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">&#125;</div><div class="line">buff.append(declare).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"class"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getClazz()).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(bean.getAttributes());</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(bean.getConstructors());</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(bean.getMethods());</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(<span class="string">"&#125;"</span>);</div><div class="line"></div><div class="line">bean.setContext(buff.toString());</div><div class="line"></div><div class="line">VgeneratorWrite.clazzs.add(bean);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadClass</span><span class="params">()</span></span>&#123;</div><div class="line">loadClass(<span class="string">"public"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="生成Mapper"><a href="#生成Mapper" class="headerlink" title="生成Mapper"></a>生成Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*根据主键来生成相对的方法</span></div><div class="line"><span class="comment">*没有主键只会生成insert方法</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.MapperBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> MapperBean bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; knames;<span class="comment">//主键</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; ktypes;<span class="comment">//主键类型</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MapperFactory</span><span class="params">(MapperBean bean)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.bean = bean;</div><div class="line">knames = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">ktypes = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addKeyMethod</span><span class="params">(String method,String type)</span> </span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(type).append(Vconst.SPACE);</div><div class="line">buffer.append(method).append(<span class="string">"("</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; knames.size(); i++) &#123;</div><div class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</div><div class="line">buffer.append(<span class="string">","</span>);</div><div class="line">&#125;</div><div class="line">buffer.append(ktypes.get(i)).append(Vconst.SPACE).append(knames.get(i));</div><div class="line">&#125;</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.END).append(Vconst.SPLIT);</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addMethod</span><span class="params">(String method)</span> </span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"int"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(method).append(<span class="string">"("</span>);</div><div class="line">buffer.append(bean.getClazz()).append(Vconst.SPACE).append(<span class="string">"record"</span>);</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.END).append(Vconst.SPLIT);</div><div class="line"></div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addInsertMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"insert"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addInsertSelectiveMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"insertSelective"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addUpdateMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"updateByPrimaryKeySelective"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addUpdateSelectiveMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"updateByPrimaryKey"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addSelectMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addKeyMethod(<span class="string">"selectByPrimaryKey"</span>,bean.getClazz());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addDeleteMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addKeyMethod(<span class="string">"deleteByPrimaryKey"</span>,<span class="string">"int"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadMapper</span><span class="params">()</span> </span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(<span class="string">"package"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getPackages()).append(Vconst.END);</div><div class="line">buff.append(Vconst.SPLIT);</div><div class="line">buff.append(<span class="string">"import"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getPojo()).append(Vconst.END);</div><div class="line">buff.append(Vconst.SPLIT);</div><div class="line">buff.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"interface"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getClazz()).append(<span class="string">"Mapper"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"&#123;"</span>).append(Vconst.LINE);</div><div class="line"><span class="keyword">if</span> (bean.isPrimary()) &#123;</div><div class="line">buff.append(addDeleteMethod());</div><div class="line">buff.append(addUpdateMethod());</div><div class="line">buff.append(addUpdateSelectiveMethod());</div><div class="line">buff.append(addSelectMethod());</div><div class="line">&#125;</div><div class="line">buff.append(addInsertMethod());</div><div class="line">buff.append(addInsertSelectiveMethod());</div><div class="line">buff.append(<span class="string">"&#125;"</span>);</div><div class="line"></div><div class="line">bean.setContext(buff.toString());</div><div class="line">VgeneratorWrite.mappers.add(bean);<span class="comment">//保存到写入类</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="xml工厂类"><a href="#xml工厂类" class="headerlink" title="xml工厂类"></a>xml工厂类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.SqlGenerator;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">double</span> version    = <span class="number">1.0</span>;</div><div class="line"><span class="keyword">private</span> String encoding   = <span class="string">"UTF-8"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> headDeclare = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="comment">//xml声明</span></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">docStart</span><span class="params">()</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(<span class="string">"&lt;?xml version=\""</span>);</div><div class="line">buff.append(version);</div><div class="line">buff.append(<span class="string">"\" encoding=\""</span>+encoding+<span class="string">"\""</span>);</div><div class="line">buff.append(<span class="string">" ?&gt;"</span>).append(Vconst.LINE);</div><div class="line"><span class="keyword">return</span> buff.toString();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addDoctype</span><span class="params">(String name, String publicId, String systemId)</span></span>&#123;</div><div class="line">Vconst.ROOTELEMENT[<span class="number">0</span>] = name;<span class="comment">//设置根节点</span></div><div class="line">publicId = <span class="string">"\""</span>+publicId+<span class="string">"\""</span>;</div><div class="line">systemId = <span class="string">"\""</span>+systemId+<span class="string">"\""</span>;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer(headDeclare?docStart():<span class="string">""</span>);</div><div class="line">buffer.append(<span class="string">"&lt;!DOCTYPE"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(name).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"PUBLIC "</span>).append(publicId).append(Vconst.SPACE);</div><div class="line">buffer.append(systemId).append(<span class="string">" &gt;"</span>);</div><div class="line">buffer.append(Vconst.LINE);</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createDoc</span><span class="params">(XMLBean bean,<span class="keyword">int</span> k_size,<span class="keyword">int</span> c_size)</span></span>&#123;</div><div class="line">bean.init();</div><div class="line">String doctype = addDoctype(Vconst.DEFAULT_XML_ROOT, Vconst.DEFAULT_XML_PUBLICID, Vconst.DEFAULT_XML_SYSTEMID);</div><div class="line">bean.addAttribute(<span class="string">"namespace"</span>, bean.getMapper());</div><div class="line">bean.setContext(doctype+bean.getContext());</div><div class="line">SqlGenerator sql = <span class="keyword">new</span> SqlGenerator(bean);<span class="comment">//生成sql</span></div><div class="line">sql.setK_size(k_size);</div><div class="line">sql.setC_size(c_size);</div><div class="line">sql.generatorSql();</div><div class="line">VgeneratorWrite.xmls.add(bean);<span class="comment">//保存xml文本</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVersion</span><span class="params">(Double version)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.version = version;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEncoding</span><span class="params">(String encoding)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.encoding = encoding;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeadDeclare</span><span class="params">(<span class="keyword">boolean</span> headDeclare)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.headDeclare = headDeclare;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/11/vgenerator2/#disqus_thread</comments>
    </item>
    
    <item>
      <title>vgenerator(一)</title>
      <link>http://vvxtoys.cc/2018/07/11/vgenerator1/</link>
      <guid>http://vvxtoys.cc/2018/07/11/vgenerator1/</guid>
      <pubDate>Wed, 11 Jul 2018 05:59:47 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;想要自己实现一个mybatis-generator类似的轮子，目前只实现MySQL部分的方法。利用下班时间，写了一个小项目，实现了这个功能。我准备分成三篇博客来写这个东西。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>想要自己实现一个mybatis-generator类似的轮子，目前只实现MySQL部分的方法。利用下班时间，写了一个小项目，实现了这个功能。我准备分成三篇博客来写这个东西。</p><a id="more"></a><h3 id="基类"><a href="#基类" class="headerlink" title="基类"></a>基类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*基类</span></div><div class="line"><span class="comment">*通用方法和属性</span></div><div class="line"><span class="comment">*getMapper 获取mapper 例如：cc.vvxtoys.mapper.StudentMapper</span></div><div class="line"><span class="comment">*getPojo   获取实体   例如：cc.vvxtoys.pojo.Student</span></div><div class="line"><span class="comment">*getFileName 生成地址</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseBean</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">protected</span> String clazz =<span class="string">""</span>;<span class="comment">//实体类名</span></div><div class="line"><span class="keyword">protected</span> String context =  <span class="string">""</span>;<span class="comment">//bean内容</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> clazz==<span class="keyword">null</span>?<span class="string">""</span>:clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClazz</span><span class="params">(String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getContext</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> context==<span class="keyword">null</span>?<span class="string">""</span>:context;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContext</span><span class="params">(String context)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.context = context;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMapper</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetMapper+<span class="string">"."</span>+clazz+<span class="string">"Mapper"</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPojo</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetPackage+<span class="string">"."</span>+clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Bean"><a href="#Bean" class="headerlink" title="Bean"></a>Bean</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*ClassBean</span></div><div class="line"><span class="comment">*dependency 生成实体是否存在Date类型 存在的话导入java.util.Date</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassBean</span> <span class="keyword">extends</span> <span class="title">BaseBean</span></span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String attributes = <span class="string">""</span>;<span class="comment">//属性</span></div><div class="line"><span class="keyword">private</span> String methods= <span class="string">""</span>;<span class="comment">//方法</span></div><div class="line"><span class="keyword">private</span> String constructors = <span class="string">""</span>;<span class="comment">//构造</span></div><div class="line"><span class="keyword">private</span> String packages= Engine.targetPackage;</div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> dependency= <span class="keyword">false</span>;<span class="comment">//依赖</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassBean</span><span class="params">(String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getAttributes</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> attributes;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAttributes</span><span class="params">(String attributes)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.attributes = attributes;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMethods</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> methods;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMethods</span><span class="params">(String methods)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.methods = methods;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getConstructors</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> constructors;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConstructors</span><span class="params">(String constructors)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.constructors = constructors;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPackages</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> packages;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isDependency</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> dependency;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDependency</span><span class="params">(<span class="keyword">boolean</span> dependency)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.dependency = dependency;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetProject+File.separator+Engine.targetPackage.replace(<span class="string">"."</span>, File.separator)+File.separator+clazz+<span class="string">".java"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*MapperBean</span></div><div class="line"><span class="comment">*primary 主键 一般来说建表是有的，默认为true</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperBean</span> <span class="keyword">extends</span> <span class="title">BaseBean</span></span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String packages = Engine.targetMapper;</div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> primary = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MapperBean</span><span class="params">(String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPrimary</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> primary;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPackages</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> packages;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrimary</span><span class="params">(<span class="keyword">boolean</span> primary)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.primary = primary;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetProject + File.separator + Engine.targetMapper.replace(<span class="string">"."</span>, File.separator)</div><div class="line">+ File.separator + clazz + <span class="string">"Mapper.java"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*XmlBean</span></div><div class="line"><span class="comment">*这个类其实我是不想写的，原定计划使用dom4j来实现，但是最终使用dom4j换行没有达到我想要的</span></div><div class="line"><span class="comment">*效果，所以我就自己写了一个简单的xml方法，可以满足我现在的需求了。</span></div><div class="line"><span class="comment">*方法就不写注释了，感觉应该能看懂</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLBean</span> <span class="keyword">extends</span> <span class="title">BaseBean</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String name;<span class="comment">//节点名</span></div><div class="line"><span class="keyword">private</span> List&lt;XMLBean&gt; childrens = <span class="keyword">new</span> ArrayList&lt;XMLBean&gt;();<span class="comment">//子节点</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> cnt;<span class="comment">//用来判断空格</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> isEnd = <span class="keyword">true</span>;<span class="comment">//是否关闭节点</span></div><div class="line"><span class="keyword">private</span> String tname;<span class="comment">//表名</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">XMLBean</span><span class="params">(String name, String tname, String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name;</div><div class="line"><span class="keyword">this</span>.tname = tname;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (name.equals(Vconst.ROOTELEMENT[<span class="number">0</span>])) &#123;</div><div class="line">cnt = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">XMLBean</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>(name, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) &#123;</div><div class="line"><span class="keyword">this</span>.context += Vconst.SPACE;</div><div class="line">&#125;</div><div class="line">context += <span class="string">"&lt;"</span> + name + <span class="string">"&gt;"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addElement</span><span class="params">(XMLBean item)</span> </span>&#123;</div><div class="line">item.setCnt(<span class="keyword">this</span>.cnt + <span class="number">2</span>);</div><div class="line">childrens.add(item);</div><div class="line">isEnd = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addText</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer(context);</div><div class="line">buff.append(Vconst.LINE);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt + <span class="number">1</span>; i++) &#123;</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">&#125;</div><div class="line">buff.append(text);</div><div class="line">context = buff.toString();</div><div class="line">isEnd = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEndText</span><span class="params">(String text)</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (childrens != <span class="keyword">null</span> &amp;&amp; childrens.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">context += Vconst.LINE;</div><div class="line"><span class="keyword">for</span> (XMLBean i : childrens) &#123;</div><div class="line">context += i.toString();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">childrens.clear();</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer(context);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt + <span class="number">1</span>; i++) &#123;</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">&#125;</div><div class="line">buff.append(text);</div><div class="line">context = buff.toString();</div><div class="line">isEnd = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttribute</span><span class="params">(String Qname, String value)</span> </span>&#123;</div><div class="line">context = context.substring(<span class="number">0</span>, getSize() - <span class="number">1</span>);</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer(context);</div><div class="line">buff.append(Common.ConcatAttr(Qname, value));</div><div class="line">buff.append(<span class="string">" &gt;"</span>);</div><div class="line">context = buff.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> context.length();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCnt</span><span class="params">(<span class="keyword">int</span> cnt)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.cnt = cnt;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getTname</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> tname;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTname</span><span class="params">(String tname)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.tname = tname;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetProject + File.separator + Engine.targetXML.replace(<span class="string">"."</span>, File.separator) + File.separator</div><div class="line">+ clazz + <span class="string">"Mapper.xml"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer(context);</div><div class="line"><span class="keyword">if</span> (isEnd) &#123;</div><div class="line"><span class="keyword">return</span> context.substring(<span class="number">0</span>, getSize() - <span class="number">1</span>) + <span class="string">"/&gt;\n"</span>;</div><div class="line">&#125;</div><div class="line">buffer.append(Vconst.LINE);</div><div class="line"><span class="keyword">if</span> (childrens != <span class="keyword">null</span> &amp;&amp; childrens.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (XMLBean i : childrens) &#123;</div><div class="line">buffer.append(i.toString());</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) &#123;</div><div class="line">buffer.append(Vconst.SPACE);</div><div class="line">&#125;</div><div class="line">buffer.append(<span class="string">"&lt;/"</span>).append(name).append(<span class="string">"&gt;"</span>);</div><div class="line">buffer.append(Vconst.LINE);</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="配置工具类"><a href="#配置工具类" class="headerlink" title="配置工具类"></a>配置工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*读取配置文件</span></div><div class="line"><span class="comment">*初始化,如果没有自定义配置文件，默认全文检索默认配置文件</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.InputStreamReader;</div><div class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Engine</span> <span class="keyword">extends</span> <span class="title">Properties</span></span>&#123;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> isDefault = <span class="keyword">true</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> String DEFAULT_CONFIG = <span class="string">"vgenerator.properties"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetPackage;<span class="comment">//实体类包</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetProject;<span class="comment">//项目路径</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetMapper;<span class="comment">//mapper包</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetXML;<span class="comment">//xml包</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String [] objectName;<span class="comment">//实体名</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String [] tableName;<span class="comment">//表名</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String user;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String pass;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String name;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String url;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setConfigFile</span><span class="params">(String path)</span></span>&#123;</div><div class="line">DEFAULT_CONFIG = path;</div><div class="line">isDefault = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">Engine</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">// TODO Auto-generated constructor stub</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Engine <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">Engine engine = <span class="keyword">null</span>;</div><div class="line">String path = isDefault?Common.searchAbsolutePath(DEFAULT_CONFIG):DEFAULT_CONFIG;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">engine = <span class="keyword">new</span> Engine();</div><div class="line">InputStreamReader is = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(path), <span class="string">"UTF-8"</span>);</div><div class="line">engine.load(is);</div><div class="line"></div><div class="line">targetPackage = (String)engine.getProperty(<span class="string">"targetPackage"</span>);</div><div class="line">targetProject = (String)engine.getProperty(<span class="string">"targetProject"</span>);</div><div class="line">targetMapper  = (String)engine.getProperty(<span class="string">"targetMapper"</span>);</div><div class="line">targetXML     = (String)engine.getProperty(<span class="string">"targetXML"</span>);</div><div class="line">tableName     = ((String)engine.getProperty(<span class="string">"tableName"</span>)).split(<span class="string">","</span>);</div><div class="line">objectName    = ((String)engine.getProperty(<span class="string">"objectName"</span>)).split(<span class="string">","</span>);</div><div class="line"></div><div class="line">user  = (String)engine.getProperty(<span class="string">"user"</span>);</div><div class="line">pass      = (String)engine.getProperty(<span class="string">"pass"</span>);</div><div class="line">name          = (String)engine.getProperty(<span class="string">"name"</span>);</div><div class="line">url          = (String)engine.getProperty(<span class="string">"url"</span>);</div><div class="line"></div><div class="line">&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;<span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> engine;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/11/vgenerator1/#disqus_thread</comments>
    </item>
    
    <item>
      <title>自动生成构造方法、getter、setter</title>
      <link>http://vvxtoys.cc/2018/07/10/auto-getset/</link>
      <guid>http://vvxtoys.cc/2018/07/10/auto-getset/</guid>
      <pubDate>Tue, 10 Jul 2018 14:01:25 GMT</pubDate>
      <description>
      
        &lt;h4 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h4&gt;&lt;p&gt;​    一直很想知道IDE是如何自动去生成类的构造和getter、setter方法，大概是有个想法，获取当前的类，利用反射去获取属性名和类型，然后生成，所以我想自己试试。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>​    一直很想知道IDE是如何自动去生成类的构造和getter、setter方法，大概是有个想法，获取当前的类，利用反射去获取属性名和类型，然后生成，所以我想自己试试。</p><a id="more"></a><h4 id="写个模板类"><a href="#写个模板类" class="headerlink" title="写个模板类"></a>写个模板类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Templates</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_CLASS = <span class="string">"package &#123;0&#125;;\n\n&#123;1&#125;public class &#123;2&#125; &#123;\n\n&#123;3&#125;\n\n&#123;5&#125;\n\n&#123;4&#125;\n&#125;"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_GET   = <span class="string">"\tpublic &#123;0&#125; get&#123;1&#125; () &#123;\n\t\treturn &#123;2&#125;;\n\t&#125;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_SET   = <span class="string">"\tpublic void set&#123;0&#125;(&#123;1&#125; &#123;2&#125;) &#123;\n\t\tthis.&#123;2&#125;=&#123;2&#125;;\n\t&#125;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_ATTR1  = <span class="string">"\tprivate &#123;0&#125; &#123;1&#125;;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_ATTR2  = <span class="string">"\t\tthis.&#123;0&#125;=&#123;0&#125;;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_IMPORT = <span class="string">"import java.util.Date;\n\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_CONSTRUCT = <span class="string">"\tpublic &#123;0&#125;(&#123;1&#125;) &#123;\n\t\tsuper();\n&#123;2&#125;\n\t&#125;\n"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">format</span><span class="params">(String pattern, String ... arguments)</span></span>&#123;</div><div class="line">String format = pattern;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;arguments.length;i++)&#123;</div><div class="line">format = format.replace(<span class="string">"&#123;"</span>+i+<span class="string">"&#125;"</span>,arguments[i]);</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> format;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">loadTemplate</span><span class="params">(String clazz,String pack,String port,</span></span></div><div class="line"><span class="function"><span class="params">String attrs,String get_set,String construct)</span></span>&#123;</div><div class="line"><span class="keyword">return</span> format(T_CLASS, clazz,pack,port,attrs,get_set,construct);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="创建一个实体类"><a href="#创建一个实体类" class="headerlink" title="创建一个实体类"></a>创建一个实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.pojo;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="keyword">private</span> String sex;</div><div class="line"><span class="keyword">private</span> String school;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> common;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.BufferedReader;</div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileWriter;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStreamReader;</div><div class="line"><span class="keyword">import</span> java.io.PrintWriter;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Common</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Logger log = Logger.getLogger(Common.class);</div><div class="line"><span class="comment">//获得绝对路径</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">absolutePath</span><span class="params">(String pack, String name, String suffix)</span> </span>&#123;</div><div class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">String absolutePath = <span class="string">""</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">String packPath = pack.replace(<span class="string">"."</span>, <span class="string">"\\"</span>);</div><div class="line">File src = <span class="keyword">new</span> File(<span class="string">".\\src"</span>);</div><div class="line">File file = <span class="keyword">new</span> File(src.getCanonicalPath());</div><div class="line">File[] fs = file.listFiles();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fs.length; i++) &#123;</div><div class="line"><span class="keyword">if</span> (fs[i].isDirectory()) &#123;</div><div class="line"><span class="keyword">if</span> (fs[i].getAbsolutePath().endsWith(packPath)) &#123;</div><div class="line">absolutePath = fs[i].getAbsolutePath() + <span class="string">"\\"</span> + name + suffix;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">list.add(fs[i].getAbsolutePath());</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; Integer.MAX_VALUE; j++) &#123;</div><div class="line"><span class="keyword">if</span> (j&gt;<span class="number">0</span>&amp;&amp;j == list.size() - <span class="number">1</span>) &#123;</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line">File tmp = <span class="keyword">new</span> File(list.get(j));</div><div class="line">fs = tmp.listFiles();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; fs.length; k++) &#123;</div><div class="line"><span class="keyword">if</span> (fs[k].isDirectory()) &#123;</div><div class="line"><span class="keyword">if</span> (fs[k].getAbsolutePath().endsWith(packPath)) &#123;</div><div class="line">absolutePath = fs[k].getAbsolutePath() + <span class="string">"\\"</span> + name + suffix;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">list.add(fs[k].getAbsolutePath());</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">loadFile</span><span class="params">(String path)</span> </span>&#123;</div><div class="line">File file = <span class="keyword">new</span> File(path);</div><div class="line">String str = <span class="keyword">null</span>;</div><div class="line">BufferedReader reader = <span class="keyword">null</span>;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">String charset = <span class="string">"utf-8"</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">InputStreamReader is = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(file), charset);</div><div class="line">reader = <span class="keyword">new</span> BufferedReader(is);</div><div class="line"><span class="keyword">while</span> ((str = reader.readLine()) != <span class="keyword">null</span>) &#123;</div><div class="line">buffer.append(str);</div><div class="line">buffer.append(<span class="string">"\n"</span>);</div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">finally</span> &#123;</div><div class="line"><span class="keyword">if</span> (reader != <span class="keyword">null</span>) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">reader.close();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String filePath, String str, <span class="keyword">boolean</span> flg)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(filePath), flg);</div><div class="line">PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">pw.println(str);</div><div class="line">log.info(<span class="string">"写入成功。。。"</span>);</div><div class="line">pw.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String filePath, String str)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(filePath), <span class="keyword">true</span>);</div><div class="line">PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">pw.println(str);</div><div class="line">log.info(<span class="string">"写入成功。。。"</span>);</div><div class="line">pw.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//首字母大写</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">upInitials</span><span class="params">(String str)</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(String.valueOf(str.charAt(<span class="number">0</span>)).toUpperCase());</div><div class="line">buff.append(str.toCharArray(),<span class="number">1</span>,str.length()-<span class="number">1</span>);</div><div class="line"><span class="keyword">return</span> buff.toString();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="构建类"><a href="#构建类" class="headerlink" title="构建类"></a>构建类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> auto_get_set;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.Field;</div><div class="line"></div><div class="line"><span class="keyword">import</span> common.Common;</div><div class="line"><span class="keyword">import</span> common.Templates;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassGenerator</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String [] attrs;</div><div class="line"><span class="keyword">private</span> String [] types;</div><div class="line"><span class="keyword">private</span> String absolutePath;</div><div class="line"><span class="keyword">private</span> String context;</div><div class="line"><span class="keyword">private</span> String clazz;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassGenerator</span><span class="params">(Object obj)</span> </span>&#123;</div><div class="line">loadClass(obj);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadClass</span><span class="params">(Object obj)</span></span>&#123;</div><div class="line">Field [] fs = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">String claname = obj.getClass().getSimpleName();</div><div class="line">String suffix = <span class="string">".java"</span>;</div><div class="line">String pack   = obj.getClass().getPackage().getName();</div><div class="line">absolutePath = Common.absolutePath(pack, claname, suffix);</div><div class="line">context = Common.loadFile(absolutePath);</div><div class="line">clazz = claname;</div><div class="line">Class clazz = Class.forName(obj.getClass().getName());</div><div class="line">fs = clazz.getDeclaredFields();</div><div class="line">attrs = <span class="keyword">new</span> String[fs.length];</div><div class="line">types = <span class="keyword">new</span> String[fs.length];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fs.length;i++)&#123;</div><div class="line">attrs[i] = fs[i].getName();</div><div class="line">types[i] = fs[i].getType().getSimpleName();</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoGetSet</span><span class="params">()</span></span>&#123;</div><div class="line">String str = context.substring(<span class="number">0</span>,context.lastIndexOf(<span class="string">"&#125;"</span>));</div><div class="line">String get_set = <span class="string">""</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.length;i++)&#123;</div><div class="line">String g1 = Templates.format(Templates.T_GET, types[i],Common.upInitials(attrs[i]),attrs[i]);</div><div class="line">String s1 = Templates.format(Templates.T_SET, Common.upInitials(attrs[i]),types[i],attrs[i]);</div><div class="line">get_set+=g1+s1;</div><div class="line">&#125;</div><div class="line">str+=get_set;</div><div class="line">str+=<span class="string">"&#125;"</span>;</div><div class="line">context = str;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoConstruct</span><span class="params">()</span></span>&#123;</div><div class="line">String str = context.substring(<span class="number">0</span>,context.lastIndexOf(<span class="string">"&#125;"</span>));</div><div class="line">String c1 = Templates.format(Templates.T_CONSTRUCT, clazz,<span class="string">""</span>,<span class="string">""</span>);</div><div class="line">String params = <span class="string">""</span>;</div><div class="line">String field = <span class="string">""</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.length;i++)&#123;</div><div class="line">params+=types[i]+<span class="string">" "</span>+attrs[i]+<span class="string">","</span>;</div><div class="line">field+=Templates.format(Templates.T_ATTR2, attrs[i]);</div><div class="line">&#125;</div><div class="line">params = params.substring(<span class="number">0</span>,params.length()-<span class="number">1</span>);</div><div class="line">String c2 = Templates.format(Templates.T_CONSTRUCT, clazz,params,field);</div><div class="line">str +=c1+c2;</div><div class="line">str+=<span class="string">"&#125;"</span>;</div><div class="line">context = str;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateClass</span><span class="params">()</span></span>&#123;</div><div class="line">Common.writeFile(absolutePath, context,<span class="keyword">false</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">autoConstruct();</div><div class="line">autoGetSet();</div><div class="line">updateClass();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> auto_get_set;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.pojo.Student;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">ClassGenerator g = <span class="keyword">new</span> ClassGenerator(<span class="keyword">new</span> Student());</div><div class="line">g.run();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="构建之后的实体类"><a href="#构建之后的实体类" class="headerlink" title="构建之后的实体类"></a>构建之后的实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.pojo;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="keyword">private</span> String sex;</div><div class="line"><span class="keyword">private</span> String school;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id,String name,String sex,String school)</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line"><span class="keyword">this</span>.id=id;</div><div class="line"><span class="keyword">this</span>.name=name;</div><div class="line"><span class="keyword">this</span>.sex=sex;</div><div class="line"><span class="keyword">this</span>.school=school;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.id=id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> name;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name=name;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSex</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.sex=sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSchool</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> school;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSchool</span><span class="params">(String school)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.school=school;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h4><p>  写写停停大概也是花费了两天的时间，东西虽然很小，也还有bug，但是还是有点成就感的。我知道IDE肯定不可能用这么蠢得实现方式，但是以我现在的想法只能这样了，还是需要多学点东西，然后我再重构这些代码。</p>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/10/auto-getset/#disqus_thread</comments>
    </item>
    
    <item>
      <title>POI导入demo</title>
      <link>http://vvxtoys.cc/2018/07/10/poi-simpleDemo/</link>
      <guid>http://vvxtoys.cc/2018/07/10/poi-simpleDemo/</guid>
      <pubDate>Tue, 10 Jul 2018 14:01:07 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;使用上篇博文的导入方法，写一个简单的导入demo。其实有了工具类之后就没啥难度了，也就只简单的拿数据。先写个简单的，然后想办法实现动态读取吧，这样读取其实还是比较烦的，每次该模板都要改代码，说到底我还是比较懒的。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>使用上篇博文的导入方法，写一个简单的导入demo。其实有了工具类之后就没啥难度了，也就只简单的拿数据。先写个简单的，然后想办法实现动态读取吧，这样读取其实还是比较烦的，每次该模板都要改代码，说到底我还是比较懒的。</p><a id="more"></a><h3 id="excel文件"><a href="#excel文件" class="headerlink" title="excel文件"></a>excel文件</h3><p><img src="https://i.loli.net/2018/09/24/5ba8af0a9e5c1.png" alt=""></p><h3 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.poi;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String id;</div><div class="line"><span class="keyword">private</span> String stcode;</div><div class="line"><span class="keyword">private</span> String stname;</div><div class="line"><span class="keyword">private</span> String sex;</div><div class="line"><span class="keyword">private</span> String phone;</div><div class="line"><span class="keyword">private</span> String school;</div><div class="line"><span class="keyword">private</span> String address;</div><div class="line"><span class="keyword">private</span> String birthday;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> birthday;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(String birthday)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.birthday = birthday;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.id = id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getStcode</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> stcode;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStcode</span><span class="params">(String stcode)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.stcode = stcode;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getStname</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> stname;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStname</span><span class="params">(String stname)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.stname = stname;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.sex = sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPhone</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> phone;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPhone</span><span class="params">(String phone)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.phone = phone;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSchool</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> school;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSchool</span><span class="params">(String school)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.school = school;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> address;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.address = address;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String id, String stcode, String stname, String sex, String phone, String school, String address)</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line"><span class="keyword">this</span>.id = id;</div><div class="line"><span class="keyword">this</span>.stcode = stcode;</div><div class="line"><span class="keyword">this</span>.stname = stname;</div><div class="line"><span class="keyword">this</span>.sex = sex;</div><div class="line"><span class="keyword">this</span>.phone = phone;</div><div class="line"><span class="keyword">this</span>.school = school;</div><div class="line"><span class="keyword">this</span>.address = address;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="service"><a href="#service" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.poi;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.util.CommonTools;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelService</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> ImportExcelUtils utils = <span class="keyword">new</span> ImportExcelUtils();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getExcelParser</span><span class="params">(String path, String sheet, String start, String end)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">InputStream is = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(path)) &#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">new</span> FileNotFoundException(<span class="string">"file not found"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">is = <span class="keyword">new</span> FileInputStream(path);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (path.endsWith(ImportExcelUtils.EXCEL_2003)) &#123;</div><div class="line">HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook(is);</div><div class="line"><span class="keyword">return</span> importXls(start, end, workbook, sheet);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (path.endsWith(ImportExcelUtils.EXCEL_2007)) &#123;</div><div class="line">XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(is);</div><div class="line"><span class="keyword">return</span> importXlsx(start, end, workbook, sheet);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">is.close();</div><div class="line"><span class="keyword">return</span> <span class="keyword">new</span> Exception(<span class="string">"type error"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">importXls</span><span class="params">(String start, String end, HSSFWorkbook workbook, String sheet)</span> </span>&#123;</div><div class="line">Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">List&lt;Student&gt; sList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">HSSFSheet hssfSheet = <span class="keyword">null</span>;</div><div class="line"><span class="comment">// 如果传过来sheet页的名称,取当前sheet页,否则遍历所有sheet</span></div><div class="line"><span class="keyword">if</span> (!utils.isEmpty(sheet)) &#123;</div><div class="line">hssfSheet = workbook.getSheet(sheet);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; workbook.getNumberOfSheets(); i++) &#123;</div><div class="line">hssfSheet = workbook.getSheetAt(i);</div><div class="line"><span class="keyword">int</span> maxIndex = hssfSheet.getLastRowNum();<span class="comment">// 获取最大下标</span></div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> endIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(start)) &#123;</div><div class="line">start = String.valueOf(<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(end)) &#123;</div><div class="line">end = maxIndex + String.valueOf(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(start) &lt;= <span class="number">1</span>) &#123;</div><div class="line">startIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = Integer.parseInt(start) - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(end) &gt; maxIndex) &#123;</div><div class="line">endIndex = maxIndex + <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">endIndex = Integer.parseInt(end);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = startIndex; j &lt; endIndex; j++) &#123;</div><div class="line">Student student = <span class="keyword">new</span> Student();</div><div class="line">HSSFRow row = hssfSheet.getRow(j);</div><div class="line">                      <span class="comment">//空行</span></div><div class="line"><span class="keyword">if</span> (utils.isBlank(row)) &#123;</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line">HSSFCell c1 = row.getCell(<span class="number">0</span>);</div><div class="line">HSSFCell c2 = row.getCell(<span class="number">1</span>);</div><div class="line">HSSFCell c3 = row.getCell(<span class="number">2</span>);</div><div class="line">HSSFCell c4 = row.getCell(<span class="number">3</span>);</div><div class="line">HSSFCell c5 = row.getCell(<span class="number">4</span>);</div><div class="line">HSSFCell c6 = row.getCell(<span class="number">5</span>);</div><div class="line">HSSFCell c7 = row.getCell(<span class="number">6</span>);</div><div class="line">student.setId(CommonTools.get32UUID());<span class="comment">//获取uuid 这个方法就不列出了，很简单</span></div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c1))&#123;</div><div class="line">String stcode = utils.getValue(c1);</div><div class="line">student.setStcode(stcode);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c2))&#123;</div><div class="line">String stname = utils.getValue(c2);</div><div class="line">student.setStname(stname);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c3))&#123;</div><div class="line">String sex = utils.getValue(c3);</div><div class="line">student.setSex(sex);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c4))&#123;</div><div class="line">String phone = utils.getValue(c4);</div><div class="line">student.setPhone(phone);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c5))&#123;</div><div class="line">String birthday = utils.getValue(c5).replaceAll(<span class="string">"/"</span>, <span class="string">"-"</span>);</div><div class="line">student.setBirthday(birthday);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c6))&#123;</div><div class="line">String school = utils.getValue(c6);</div><div class="line">student.setSchool(school);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c7))&#123;</div><div class="line">String address = utils.getValue(c7);</div><div class="line">student.setAddress(address);</div><div class="line">&#125;</div><div class="line">sList.add(student);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">result.put(<span class="string">"sList"</span>, sList);</div><div class="line"><span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">importXlsx</span><span class="params">(String start, String end, XSSFWorkbook workbook, String sheet)</span> </span>&#123;</div><div class="line">Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">List&lt;Student&gt; sList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">XSSFSheet xssfSheet = <span class="keyword">null</span>;</div><div class="line"><span class="comment">// 如果传过来sheet页的名称,取当前sheet页,否则遍历所有sheet</span></div><div class="line"><span class="keyword">if</span> (!utils.isEmpty(sheet)) &#123;</div><div class="line">xssfSheet = workbook.getSheet(sheet);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; workbook.getNumberOfSheets(); i++) &#123;</div><div class="line">xssfSheet = workbook.getSheetAt(i);</div><div class="line"><span class="keyword">int</span> maxIndex = xssfSheet.getLastRowNum();<span class="comment">// 获取最大下标</span></div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> endIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(start)) &#123;</div><div class="line">start = String.valueOf(<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(end)) &#123;</div><div class="line">end = maxIndex + String.valueOf(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(start) &lt;= <span class="number">1</span>) &#123;</div><div class="line">startIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = Integer.parseInt(start) - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(end) &gt; maxIndex) &#123;</div><div class="line">endIndex = maxIndex + <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">endIndex = Integer.parseInt(end);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = startIndex; j &lt; endIndex; j++) &#123;</div><div class="line">Student student = <span class="keyword">new</span> Student();</div><div class="line">XSSFRow row = xssfSheet.getRow(j);</div><div class="line">XSSFCell c1 = row.getCell(<span class="number">0</span>);</div><div class="line">XSSFCell c2 = row.getCell(<span class="number">1</span>);</div><div class="line">XSSFCell c3 = row.getCell(<span class="number">2</span>);</div><div class="line">XSSFCell c4 = row.getCell(<span class="number">3</span>);</div><div class="line">XSSFCell c5 = row.getCell(<span class="number">4</span>);</div><div class="line">XSSFCell c6 = row.getCell(<span class="number">5</span>);</div><div class="line">XSSFCell c7 = row.getCell(<span class="number">6</span>);</div><div class="line"></div><div class="line">student.setId(CommonTools.get32UUID());<span class="comment">//uuid</span></div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c1))&#123;</div><div class="line">String stcode = utils.getValue(c1);</div><div class="line">student.setStcode(stcode);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c2))&#123;</div><div class="line">String stname = utils.getValue(c2);</div><div class="line">student.setStname(stname);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c3))&#123;</div><div class="line">String sex = utils.getValue(c3);</div><div class="line">student.setSex(sex);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c4))&#123;</div><div class="line">String phone = utils.getValue(c4);</div><div class="line">student.setPhone(phone);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c5))&#123;</div><div class="line">String birthday = utils.getValue(c5).replaceAll(<span class="string">"/"</span>, <span class="string">"-"</span>);</div><div class="line">student.setBirthday(birthday);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c6))&#123;</div><div class="line">String school = utils.getValue(c6);</div><div class="line">student.setSchool(school);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c7))&#123;</div><div class="line">String address = utils.getValue(c7);</div><div class="line">student.setAddress(address);</div><div class="line">&#125;</div><div class="line">sList.add(student);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">result.put(<span class="string">"sList"</span>, sList);</div><div class="line"><span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">String path = <span class="string">"D:\\Desktop\\2.xlsx"</span>; <span class="comment">//文件路径</span></div><div class="line">String start = <span class="string">"0"</span>; <span class="comment">//开始条数</span></div><div class="line">String end = <span class="string">"10"</span>;<span class="comment">//结束条数</span></div><div class="line">String sheet = <span class="keyword">null</span>;<span class="comment">//sheet页名称</span></div><div class="line">ExcelService service = <span class="keyword">new</span> ExcelService();</div><div class="line">Map&lt;String, Object&gt; result = (Map&lt;String, Object&gt;) service.getExcelParser(path, sheet, start, end);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/10/poi-simpleDemo/#disqus_thread</comments>
    </item>
    
    <item>
      <title>POI导入工具类</title>
      <link>http://vvxtoys.cc/2018/07/10/PoiExcel-import/</link>
      <guid>http://vvxtoys.cc/2018/07/10/PoiExcel-import/</guid>
      <pubDate>Tue, 10 Jul 2018 06:53:07 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;导入的通用方法，包括xls、xlsx的取值方法，非空判断方法，空行判断，处理了手机号读取和日期读取格式问题。这几个方法就可以完成简单读取了，有时间我在优化下。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>导入的通用方法，包括xls、xlsx的取值方法，非空判断方法，空行判断，处理了手机号读取和日期读取格式问题。这几个方法就可以完成简单读取了，有时间我在优化下。</p><a id="more"></a><h3 id="maven依赖"><a href="#maven依赖" class="headerlink" title="maven依赖"></a>maven依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!-- POI --&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">&lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</div><div class="line">&lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</div><div class="line">&lt;version&gt;3.9&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure><h3 id="导入工具类"><a href="#导入工具类" class="headerlink" title="导入工具类"></a>导入工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">package cc.vvxtoys.poi;</div><div class="line">import java.math.BigDecimal;</div><div class="line">import java.text.SimpleDateFormat;</div><div class="line"></div><div class="line">import org.apache.poi.hssf.usermodel.HSSFCell;</div><div class="line">import org.apache.poi.hssf.usermodel.HSSFDateUtil;</div><div class="line">import org.apache.poi.ss.usermodel.Cell;</div><div class="line">import org.apache.poi.ss.usermodel.Row;</div><div class="line">import org.apache.poi.xssf.usermodel.XSSFCell;</div><div class="line"></div><div class="line">public class ImportExcelUtils &#123;</div><div class="line">public static final String EXCEL_2003 = &quot;.xls&quot;;</div><div class="line">public static final String EXCEL_2007 = &quot;.xlsx&quot;;</div><div class="line"></div><div class="line">@SuppressWarnings(&quot;static-access&quot;)</div><div class="line">public  String getValue(XSSFCell cell) &#123;</div><div class="line">if (cell.getCellType() == cell.CELL_TYPE_BOOLEAN) &#123;</div><div class="line">return String.valueOf(cell.getBooleanCellValue()).trim();</div><div class="line">&#125; else if (cell.getCellType() == cell.CELL_TYPE_NUMERIC) &#123;</div><div class="line">if (HSSFDateUtil.isCellDateFormatted(cell)) &#123;</div><div class="line">SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line">return String.valueOf(sdf.format(HSSFDateUtil.getJavaDate(cell.getNumericCellValue()))).trim();</div><div class="line">&#125;</div><div class="line">BigDecimal bd = new BigDecimal(String.valueOf(cell.getNumericCellValue()).trim());</div><div class="line">return bd.toPlainString();</div><div class="line">&#125; else &#123;</div><div class="line">return String.valueOf(cell.getStringCellValue()).trim();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@SuppressWarnings(&quot;static-access&quot;)</div><div class="line">public  String getValue(HSSFCell cell) &#123;</div><div class="line">if (cell.getCellType() == cell.CELL_TYPE_BOOLEAN) &#123;</div><div class="line">return String.valueOf(cell.getBooleanCellValue()).trim();</div><div class="line">&#125; else if (cell.getCellType() == cell.CELL_TYPE_NUMERIC) &#123;</div><div class="line">if (HSSFDateUtil.isCellDateFormatted(cell)) &#123;</div><div class="line">SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line">return String.valueOf(sdf.format(HSSFDateUtil.getJavaDate(cell.getNumericCellValue()))).trim();</div><div class="line">&#125;</div><div class="line">BigDecimal bd = new BigDecimal(String.valueOf(cell.getNumericCellValue()).trim());</div><div class="line">return bd.toPlainString();</div><div class="line">&#125; else &#123;</div><div class="line">return String.valueOf(cell.getStringCellValue()).trim();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">//判断空行</div><div class="line">public  boolean isBlank(Row row)&#123;</div><div class="line">for(int i=0;i&lt;row.getLastCellNum();i++)&#123;</div><div class="line">Cell cell =  row.getCell(i);</div><div class="line">if(cell!=null&amp;&amp;cell.getCellType()!=cell.CELL_TYPE_BLANK)&#123;</div><div class="line">return false;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">return true;</div><div class="line">&#125;</div><div class="line">    //非空判断</div><div class="line">public boolean isEmpty(Object obj)&#123;</div><div class="line">if (obj instanceof HSSFCell) &#123;</div><div class="line">HSSFCell cell = (HSSFCell) obj;</div><div class="line">return getValue(cell) == null || &quot;&quot;.equals(getValue(cell));</div><div class="line">&#125;</div><div class="line">if (obj instanceof XSSFCell) &#123;</div><div class="line">XSSFCell cell = (XSSFCell) obj;</div><div class="line">return getValue(cell) == null || &quot;&quot;.equals(getValue(cell));</div><div class="line">&#125;</div><div class="line">return obj == null || obj.toString().trim().equals(&quot;&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/10/PoiExcel-import/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Java日期处理</title>
      <link>http://vvxtoys.cc/2018/07/10/DateUtil/</link>
      <guid>http://vvxtoys.cc/2018/07/10/DateUtil/</guid>
      <pubDate>Tue, 10 Jul 2018 06:09:51 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;在项目中经常会使用到日期处理的方法，花费了一点时间整理下我使用过的方法，整合成工具类，方便以后使用。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在项目中经常会使用到日期处理的方法，花费了一点时间整理下我使用过的方法，整合成工具类，方便以后使用。</p><a id="more"></a><h3 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div></pre></td><td class="code"><pre><div class="line">package cc.vvxtoys.util;</div><div class="line"></div><div class="line">import java.text.ParseException;</div><div class="line">import java.text.SimpleDateFormat;</div><div class="line">import java.util.Calendar;</div><div class="line">import java.util.Date;</div><div class="line">/**</div><div class="line"> * </div><div class="line"> * @author vvxtoys</div><div class="line"> * @date 2018年1月6日下午9:48:02</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class DateUtils &#123;</div><div class="line"></div><div class="line">private static  Calendar cal = Calendar.getInstance();</div><div class="line">private static String fm = &quot;&quot;;//format month</div><div class="line">private static String fd = &quot;&quot;;//format day</div><div class="line"></div><div class="line">/**</div><div class="line"> * @description 判断是否为闰年</div><div class="line"> */</div><div class="line">public static boolean isLeapYear(int year)&#123;</div><div class="line">return (year % 400 == 0) || (year % 4 == 0 &amp;&amp; year % 100 != 0);</div><div class="line">&#125;</div><div class="line">/**</div><div class="line"> * </div><div class="line"> * @description 获取月天数</div><div class="line"> */</div><div class="line">    public static String getMonthDays(int year,int month)&#123;</div><div class="line">    String [] days = &#123;&quot;31&quot;, null, &quot;31&quot;, &quot;30&quot;, &quot;31&quot;, &quot;30&quot;, &quot;31&quot;, &quot;31&quot;, &quot;30&quot;, &quot;31&quot;, &quot;30&quot;, &quot;31&quot;&#125;;</div><div class="line">    if(isLeapYear(year))&#123;</div><div class="line">    days[1]=&quot;29&quot;;</div><div class="line">    &#125;else&#123;</div><div class="line">    days[1]=&quot;28&quot;;</div><div class="line">    &#125;</div><div class="line">    return days[month-1];</div><div class="line">    &#125; </div><div class="line">    /**</div><div class="line">     * @description 获取时间在当前年为第几周</div><div class="line">     */</div><div class="line"> public static int getWeekOfYear(String date) throws ParseException &#123;</div><div class="line"> SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line"> cal.setFirstDayOfWeek(Calendar.MONDAY);</div><div class="line"> String firstDay = date.substring(0, 4) + &quot;-01-01&quot;;</div><div class="line"> cal.setTime(sdf.parse(firstDay));</div><div class="line"> int dayOfWeek = cal.get(Calendar.DAY_OF_WEEK);</div><div class="line"> if (dayOfWeek == 2) &#123;</div><div class="line"> cal.setTime(sdf.parse(date));</div><div class="line"> int num = cal.get(Calendar.WEEK_OF_YEAR);</div><div class="line"> return num;</div><div class="line"> &#125; else &#123;</div><div class="line"> cal.setTime(sdf.parse(date));</div><div class="line"> int num = cal.get(Calendar.WEEK_OF_YEAR) - 1;</div><div class="line"> return num;</div><div class="line"> &#125;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 天计算</div><div class="line">  */</div><div class="line"> public static String addDays(String date,int num)&#123;</div><div class="line"> try&#123;</div><div class="line"> cal.setTime(toDate(date));</div><div class="line"> cal.add(Calendar.DATE, num);</div><div class="line"> toFormatDate();</div><div class="line"> &#125;catch(Exception e)&#123;</div><div class="line"> e.printStackTrace();</div><div class="line"> &#125;</div><div class="line"> return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 星期</div><div class="line">  */</div><div class="line"> public static String addWeeks(String date,int num)&#123;</div><div class="line"> try &#123;</div><div class="line">cal.setTime(toDate(date));</div><div class="line">cal.add(Calendar.WEEK_OF_YEAR, num);</div><div class="line">toFormatDate();</div><div class="line">&#125; catch (ParseException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"> return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 月</div><div class="line">  */</div><div class="line"> public static String addMonths(String date,int num)&#123;</div><div class="line"> try &#123;</div><div class="line">cal.setTime(toDate(date));</div><div class="line">cal.add(Calendar.MONTH, num);</div><div class="line">toFormatDate();</div><div class="line">&#125; catch (ParseException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"> return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 季度</div><div class="line">  */</div><div class="line"> public static String addQuarters(String date,int num)&#123;</div><div class="line"> try &#123;</div><div class="line">cal.setTime(toDate(date));</div><div class="line">cal.add(Calendar.MONTH, num*3);</div><div class="line">toFormatDate();</div><div class="line">&#125; catch (ParseException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"> return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 年</div><div class="line">  */</div><div class="line"> public static String addYears(String date,int num)&#123;</div><div class="line"> try &#123;</div><div class="line">cal.setTime(toDate(date));</div><div class="line">cal.add(Calendar.YEAR, num);</div><div class="line">toFormatDate();</div><div class="line">&#125; catch (ParseException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"> return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 日期转换</div><div class="line">  */</div><div class="line"> public static Object translateDate(Object time, String pattern) &#123;</div><div class="line">Object date = new Object();</div><div class="line">if (isEmpty(pattern)) &#123;</div><div class="line">pattern = &quot;yyyy-MM-dd&quot;;</div><div class="line">&#125;</div><div class="line">if (isEmpty(time)) &#123;</div><div class="line">time = &quot;1970-1-1&quot;;</div><div class="line">&#125;</div><div class="line">SimpleDateFormat sdf = new SimpleDateFormat(pattern);</div><div class="line">try &#123;</div><div class="line">if (time instanceof String) &#123;</div><div class="line">date = sdf.parse((String) time);</div><div class="line">&#125; else if (time instanceof Date) &#123;</div><div class="line">date = sdf.format(time);</div><div class="line">&#125; else &#123;</div><div class="line">throw new Exception(&quot;转换失败&quot;);</div><div class="line">&#125;</div><div class="line">&#125; catch (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">return date;</div><div class="line">&#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 当前日期为本周第几天</div><div class="line">  */</div><div class="line"> public static int getDayOfWeek(String date)&#123;</div><div class="line"> try&#123;</div><div class="line"> cal.setTime(toDate(date));</div><div class="line"> cal.setFirstDayOfWeek(Calendar.MONDAY);</div><div class="line"> &#125;catch(ParseException e)&#123;</div><div class="line"> e.printStackTrace();</div><div class="line"> &#125;</div><div class="line"> return cal.get(Calendar.DAY_OF_WEEK)==1?7:cal.get(Calendar.DAY_OF_WEEK)-1;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 周一</div><div class="line">  */</div><div class="line"> public static String getStartDayOfThisWeek(String date)&#123;</div><div class="line">   return addDays(date, -(getDayOfWeek(date)-1));</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 周日</div><div class="line">  */</div><div class="line"> public static String getEndDayOfThisWeek(String date)&#123;</div><div class="line"> return addDays(date,(7-getDayOfWeek(date)));</div><div class="line"> &#125;</div><div class="line"> //获取当前时间</div><div class="line"> public static String getCurrentDate()&#123;</div><div class="line"> Date date = new Date();</div><div class="line"> SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line"> return sdf.format(date);</div><div class="line"> &#125;</div><div class="line"> //当前时间</div><div class="line"> public static String getCurrentDate(String pattern)&#123;</div><div class="line"> Date date = new Date();</div><div class="line"> if(isEmpty(pattern))&#123;</div><div class="line"> pattern = &quot;yyyy-MM-dd&quot;;</div><div class="line"> &#125;</div><div class="line"> SimpleDateFormat sdf = new SimpleDateFormat(pattern);</div><div class="line"> return sdf.format(date);</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 时间间隔  月 季度 年  *3 *12</div><div class="line">  */</div><div class="line"> public static int getSubDays(int num)&#123;</div><div class="line"> Date date = new Date();</div><div class="line"> cal.setTime(date);</div><div class="line"> cal.add(Calendar.MONTH, num);</div><div class="line"> long time = cal.getTimeInMillis() - date.getTime();</div><div class="line"> return (int) (time / (1000 * 60 * 60 * 24));</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 获取第几周开始时间</div><div class="line">  */</div><div class="line"> public static String getStartDayOfWeek(int year,int num)&#123;</div><div class="line"> cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);</div><div class="line">cal.set(Calendar.YEAR, year);</div><div class="line">cal.set(Calendar.WEEK_OF_YEAR, num);</div><div class="line">toFormatDate();</div><div class="line">return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 获取第几周结束时间</div><div class="line">  */</div><div class="line"> public static String getEndDayOfWeek(int year,int num)&#123;</div><div class="line"> cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);</div><div class="line">cal.set(Calendar.YEAR, year);</div><div class="line">cal.set(Calendar.WEEK_OF_YEAR, num);</div><div class="line">cal.add(Calendar.DAY_OF_WEEK, 6);</div><div class="line">toFormatDate();</div><div class="line">return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 获取第几月开始时间</div><div class="line">  */</div><div class="line"> public static String getStartDayOfMonth(int year,int num)&#123;</div><div class="line"> String month = num &lt; 10 ? &quot;0&quot; + num : String.valueOf(num);</div><div class="line">return year + &quot;-&quot; + month + &quot;-&quot; + &quot;01&quot;;</div><div class="line"> &#125;</div><div class="line"> /**</div><div class="line">  * </div><div class="line">  * @description 获取第几月结束时间</div><div class="line">  */</div><div class="line"> public static String getEndDayOfMonth(int year,int num)&#123;</div><div class="line"> cal.set(Calendar.YEAR, year);</div><div class="line">cal.set(Calendar.MONTH, num - 1);</div><div class="line">cal.set(Calendar.DATE, 1);</div><div class="line">cal.add(Calendar.MONTH, 1);</div><div class="line">cal.add(Calendar.DAY_OF_YEAR, -1);</div><div class="line">toFormatDate();</div><div class="line">return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> //获取第几季度开始时间</div><div class="line"> public static String getStartDayOfQuarter(int year,int num)&#123;</div><div class="line"> num = 3 * num - 2;</div><div class="line">String month = num &lt; 10 ? &quot;0&quot; + num : String.valueOf(num);</div><div class="line">return year + &quot;-&quot; + month + &quot;-&quot; + &quot;01&quot;;</div><div class="line"> &#125;</div><div class="line"> //获取第几季度结束时间</div><div class="line"> public static String getEndDayOfQuarter(int year,int num)&#123;</div><div class="line"> cal.set(Calendar.YEAR, year);</div><div class="line">cal.set(Calendar.MONTH, 3 * num - 1);</div><div class="line">cal.set(Calendar.DATE, 1);</div><div class="line">cal.add(Calendar.MONTH, 1);</div><div class="line">cal.add(Calendar.DAY_OF_YEAR, -1);</div><div class="line">toFormatDate();</div><div class="line">return cal.get(Calendar.YEAR) + &quot;-&quot;+fm+&quot;-&quot;+fd;</div><div class="line"> &#125;</div><div class="line"> //时间间隔</div><div class="line"> public static int intervalDay(String d1,String d2)&#123;</div><div class="line"> int num = 0;</div><div class="line"> try&#123;</div><div class="line"> long second = toDate(d2).getTime()-toDate(d1).getTime();</div><div class="line"> num=(int)(Math.abs(second)/(1000 * 60 * 60 * 24));</div><div class="line"> &#125;catch(ParseException e)&#123;</div><div class="line"> e.printStackTrace();</div><div class="line"> &#125;</div><div class="line"> return num;</div><div class="line"> &#125;</div><div class="line"> private static void toFormatDate()&#123;</div><div class="line"> int month = (cal.get(Calendar.MONTH) + 1);</div><div class="line"> fm = month&lt;10?&quot;0&quot;+month:String.valueOf(month);</div><div class="line"> int day = cal.get(Calendar.DAY_OF_MONTH);</div><div class="line"> fd = day&lt;10?&quot;0&quot;+day:String.valueOf(day);</div><div class="line"> &#125; </div><div class="line"> private static Date toDate(String date) throws ParseException&#123;</div><div class="line"> SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line"> return sdf.parse(date);</div><div class="line"> &#125;</div><div class="line"> private static boolean isEmpty(Object obj)&#123;</div><div class="line"> return obj==null||obj.toString().trim().equals(&quot;&quot;);</div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/10/DateUtil/#disqus_thread</comments>
    </item>
    
  </channel>
</rss>
