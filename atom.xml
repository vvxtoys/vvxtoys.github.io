<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>vvxtoys&#39;s Blog</title>
    <link>http://vvxtoys.cc/</link>
    <atom:link href="/atom.xml" rel="self" type="application/rss+xml"/>
    
    <description>向死而生</description>
    <pubDate>Sun, 25 Nov 2018 08:23:39 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>封装poi导出篇</title>
      <link>http://vvxtoys.cc/2018/11/25/excelhelper2/</link>
      <guid>http://vvxtoys.cc/2018/11/25/excelhelper2/</guid>
      <pubDate>Sun, 25 Nov 2018 07:06:45 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;  先写的导入，以为导出会很简单，没想到导出的东西也不少，基于常用的几种样式和校验写了一个简单的导出，包括时间，数字，文字长度，下拉框，提示框校验，基础样式包括字体，字体颜色，背景颜色等功能，可以使用rgb，基本上满足了我的需求。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>  先写的导入，以为导出会很简单，没想到导出的东西也不少，基于常用的几种样式和校验写了一个简单的导出，包括时间，数字，文字长度，下拉框，提示框校验，基础样式包括字体，字体颜色，背景颜色等功能，可以使用rgb，基本上满足了我的需求。</p><a id="more"></a><h3 id="基础校验类"><a href="#基础校验类" class="headerlink" title="基础校验类"></a>基础校验类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.vhelper.excelhelper.exporter;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.DVConstraint;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFDataValidation;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.DataValidation;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.DataValidationConstraint;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.DataValidationConstraint.ValidationType;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.DateUtil;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddressList;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFDataValidation;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFDataValidationConstraint;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFDataValidationHelper;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月8日下午5:30:02</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></div><div class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseValidation</span> <span class="keyword">implements</span> <span class="title">Validation</span></span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> version;  <span class="comment">//版本</span></div><div class="line"><span class="keyword">private</span> Sheet sheet;</div><div class="line"><span class="keyword">private</span> ValidationConfig config;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">BaseValidation</span><span class="params">(ValidationConfig config)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.config = config;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> DataValidation <span class="title">createPrompt</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">return</span> xlsPrompt();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">return</span> xlsxPrompt();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> HSSFDataValidation <span class="title">xlsPrompt</span><span class="params">()</span></span>&#123;</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">DVConstraint dv = DVConstraint.createCustomFormulaConstraint(<span class="string">"BB1"</span>);</div><div class="line">HSSFDataValidation dataValidation = <span class="keyword">new</span> HSSFDataValidation(addressList, dv);</div><div class="line">dataValidation.setSuppressDropDownArrow(<span class="keyword">false</span>);</div><div class="line">dataValidation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line">dataValidation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> dataValidation;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> XSSFDataValidation <span class="title">xlsxPrompt</span><span class="params">()</span></span>&#123;</div><div class="line">XSSFDataValidationHelper help = <span class="keyword">new</span> XSSFDataValidationHelper((XSSFSheet)sheet);</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">XSSFDataValidationConstraint dv = (XSSFDataValidationConstraint)help.createCustomConstraint(<span class="string">"BB1"</span>);</div><div class="line">XSSFDataValidation validation = (XSSFDataValidation)help.createValidation(dv, addressList);</div><div class="line">validation.setSuppressDropDownArrow(<span class="keyword">false</span>);</div><div class="line">validation.createPromptBox(<span class="string">"输入提示"</span>,config.getPromptText());</div><div class="line">validation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> validation;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> DataValidation <span class="title">createDropDownBox</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">return</span> xlsDropDownBox();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">return</span> xlsxDropDownBox();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> HSSFDataValidation <span class="title">xlsDropDownBox</span><span class="params">()</span></span>&#123;</div><div class="line">CellRangeAddressList regions = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol()); </div><div class="line">DVConstraint constraint = DVConstraint.createExplicitListConstraint(config.getTextlist());      </div><div class="line">HSSFDataValidation datavalidation = <span class="keyword">new</span> HSSFDataValidation(regions,constraint);</div><div class="line">datavalidation.setSuppressDropDownArrow(<span class="keyword">false</span>);</div><div class="line">datavalidation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line">datavalidation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> datavalidation;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> XSSFDataValidation <span class="title">xlsxDropDownBox</span><span class="params">()</span></span>&#123;</div><div class="line">XSSFDataValidationHelper help = <span class="keyword">new</span> XSSFDataValidationHelper((XSSFSheet)sheet);</div><div class="line">XSSFDataValidationConstraint dvConstraint= (XSSFDataValidationConstraint) help.createExplicitListConstraint(config.getTextlist());</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">XSSFDataValidation validation = (XSSFDataValidation) help.createValidation(</div><div class="line">dvConstraint, addressList);</div><div class="line">validation.setSuppressDropDownArrow(<span class="keyword">true</span>);</div><div class="line">validation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line">validation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> validation;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> DataValidation <span class="title">createValidateTime</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">return</span> xlsValidateTime();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">return</span> xlsxValidateTime();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> HSSFDataValidation <span class="title">xlsValidateTime</span><span class="params">()</span></span>&#123;</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">DVConstraint dvConstraint = DVConstraint.createDateConstraint(DVConstraint.OperatorType.BETWEEN, config.getStartDate(),</div><div class="line">config.getEndDate(), config.getPattern());</div><div class="line">HSSFDataValidation dataValidation = <span class="keyword">new</span> HSSFDataValidation(addressList, dvConstraint);</div><div class="line">dataValidation.setSuppressDropDownArrow(<span class="keyword">false</span>);</div><div class="line">dataValidation.createPromptBox(<span class="string">"输入提示"</span>,config.getPromptText());</div><div class="line">dataValidation.createErrorBox(<span class="string">"日期格式错误提示"</span>, config.getErrorText());</div><div class="line">dataValidation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> dataValidation;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> XSSFDataValidation <span class="title">xlsxValidateTime</span><span class="params">()</span></span>&#123;</div><div class="line">XSSFDataValidation validation = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(config.getPattern());</div><div class="line">XSSFDataValidationHelper help = <span class="keyword">new</span> XSSFDataValidationHelper((XSSFSheet)sheet);</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">XSSFDataValidationConstraint dvConstraint=(XSSFDataValidationConstraint)</div><div class="line">help.createDateConstraint(DataValidationConstraint.OperatorType.BETWEEN, </div><div class="line"><span class="string">""</span>+DateUtil.getExcelDate(sdf.parse(config.getStartDate())), </div><div class="line"><span class="string">""</span>+DateUtil.getExcelDate(sdf.parse(config.getEndDate())), <span class="string">""</span>);</div><div class="line"></div><div class="line">validation = (XSSFDataValidation) help.createValidation(</div><div class="line">dvConstraint, addressList);</div><div class="line"></div><div class="line">validation.createPromptBox(<span class="string">"输入提示"</span>,config.getPromptText());</div><div class="line">validation.createErrorBox(<span class="string">"日期格式错误提示"</span>,config.getErrorText());</div><div class="line">validation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line">validation.setShowErrorBox(<span class="keyword">true</span>);</div><div class="line">validation.setErrorStyle(<span class="number">0</span>);</div><div class="line">sheet.addValidationData(validation);</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> validation;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> DataValidation <span class="title">createTextLength</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">return</span> xlsTextLength();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">return</span> xlsxTextLength();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> HSSFDataValidation <span class="title">xlsTextLength</span><span class="params">()</span></span>&#123;</div><div class="line">DVConstraint constraint = DVConstraint.createNumericConstraint(  </div><div class="line">            DVConstraint.ValidationType.TEXT_LENGTH,  </div><div class="line">            DVConstraint.OperatorType.BETWEEN, String.valueOf(config.getMinLen()), String.valueOf(config.getMaxLen()));  </div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">HSSFDataValidation dataValidation = <span class="keyword">new</span> HSSFDataValidation(addressList, constraint);</div><div class="line">dataValidation.setSuppressDropDownArrow(<span class="keyword">false</span>);</div><div class="line">dataValidation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line"><span class="comment">// 设置输入错误提示信息</span></div><div class="line">dataValidation.createErrorBox(<span class="string">"格式错误"</span>,config.getErrorText());</div><div class="line">dataValidation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> dataValidation;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> XSSFDataValidation <span class="title">xlsxTextLength</span><span class="params">()</span></span>&#123;</div><div class="line">XSSFDataValidationHelper help = <span class="keyword">new</span> XSSFDataValidationHelper((XSSFSheet)sheet);</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">XSSFDataValidationConstraint dvConstraint=(XSSFDataValidationConstraint)</div><div class="line">help.createNumericConstraint(ValidationType.TEXT_LENGTH, DataValidationConstraint.OperatorType.BETWEEN, String.valueOf(config.getMinLen()), String.valueOf(config.getMaxLen()));</div><div class="line">XSSFDataValidation validation = (XSSFDataValidation) help.createValidation(</div><div class="line">                dvConstraint, addressList);</div><div class="line">validation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line">validation.createErrorBox(<span class="string">"格式错误提示"</span>, config.getErrorText());</div><div class="line">validation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line">validation.setShowErrorBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> validation;</div><div class="line">&#125;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> DataValidation <span class="title">createValidateNumber</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">return</span> xlsValidateNumber();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">return</span> xlsxValidateNumber();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> HSSFDataValidation <span class="title">xlsValidateNumber</span><span class="params">()</span></span>&#123;</div><div class="line">DVConstraint constraint = DVConstraint.createNumericConstraint(  </div><div class="line">            DVConstraint.ValidationType.DECIMAL,  </div><div class="line">            DVConstraint.OperatorType.BETWEEN, String.valueOf(config.getMin()), String.valueOf(config.getMax()));  </div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">HSSFDataValidation dataValidation = <span class="keyword">new</span> HSSFDataValidation(addressList, constraint);</div><div class="line">dataValidation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line">dataValidation.createErrorBox(<span class="string">"格式错误"</span>, config.getErrorText());</div><div class="line">dataValidation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line">dataValidation.setShowErrorBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> dataValidation;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> XSSFDataValidation <span class="title">xlsxValidateNumber</span><span class="params">()</span></span>&#123;</div><div class="line">XSSFDataValidationHelper help = <span class="keyword">new</span> XSSFDataValidationHelper((XSSFSheet)sheet);</div><div class="line">CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(config.getStartRow(), config.getEndRow(),</div><div class="line">config.getStartCol(), config.getEndCol());</div><div class="line">XSSFDataValidationConstraint dvConstraint=(XSSFDataValidationConstraint)</div><div class="line">help.createNumericConstraint(ValidationType.DECIMAL, DataValidationConstraint.OperatorType.BETWEEN, String.valueOf(config.getMin()), String.valueOf(config.getMax()));</div><div class="line">XSSFDataValidation validation = (XSSFDataValidation) help.createValidation(</div><div class="line">                dvConstraint, addressList);</div><div class="line">validation.createPromptBox(<span class="string">"输入提示"</span>, config.getPromptText());</div><div class="line">validation.createErrorBox(<span class="string">"格式错误"</span>, config.getErrorText());</div><div class="line">validation.setShowPromptBox(<span class="keyword">true</span>);</div><div class="line">validation.setShowErrorBox(<span class="keyword">true</span>);</div><div class="line"><span class="keyword">return</span> validation;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorValidation</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span> &amp;&amp; config.getEndRow() == <span class="number">0</span>)&#123;</div><div class="line">config.setEndRow(<span class="number">65535</span>);</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(version == <span class="number">1</span> &amp;&amp; config.getEndRow() == <span class="number">0</span>)&#123;</div><div class="line">config.setEndRow(<span class="number">1048575</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(config.getCustomize())&#123;</div><div class="line">addValidation(config.getDataValidation());</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">switch</span> (config.getEv()) &#123;</div><div class="line"><span class="keyword">case</span> PROMPT:</div><div class="line">addValidation(createPrompt());</div><div class="line"><span class="keyword">break</span>;</div><div class="line"><span class="keyword">case</span> DROPDOWN:</div><div class="line">addValidation(createDropDownBox());</div><div class="line"><span class="keyword">break</span>;</div><div class="line"><span class="keyword">case</span> DATE:</div><div class="line">addValidation(createValidateTime());</div><div class="line"><span class="keyword">break</span>;</div><div class="line"><span class="keyword">case</span> LENGTH:</div><div class="line">addValidation(createTextLength());</div><div class="line"><span class="keyword">break</span>;</div><div class="line"><span class="keyword">case</span> NUMBER:</div><div class="line">addValidation(createValidateNumber());</div><div class="line"><span class="keyword">break</span>;</div><div class="line"><span class="keyword">default</span>:</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSheet</span><span class="params">(Sheet sheet)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(sheet <span class="keyword">instanceof</span> HSSFSheet)&#123;</div><div class="line"><span class="keyword">this</span>.version = <span class="number">0</span>;</div><div class="line"><span class="keyword">this</span>.sheet = (HSSFSheet)sheet;</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(sheet <span class="keyword">instanceof</span> XSSFSheet)&#123;</div><div class="line"><span class="keyword">this</span>.version = <span class="number">1</span>;</div><div class="line"><span class="keyword">this</span>.sheet = (XSSFSheet)sheet;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addValidation</span><span class="params">(DataValidation dataValidation)</span></span>&#123;</div><div class="line">sheet.addValidationData(dataValidation);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="基础样式类"><a href="#基础样式类" class="headerlink" title="基础样式类"></a>基础样式类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.vhelper.excelhelper.exporter;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCellStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFDataFormat;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFFont;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFPalette;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor.HSSFColorPredefined;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.BorderStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.FillPatternType;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.HorizontalAlignment;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.DefaultIndexedColorMap;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCellStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFColor;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFDataFormat;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFFont;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseStyle</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> version;</div><div class="line"><span class="keyword">private</span> Workbook workbook;</div><div class="line"><span class="keyword">private</span> StyleConfig sconfig;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">BaseStyle</span><span class="params">(Workbook workbook,StyleConfig config)</span> </span>&#123;</div><div class="line"><span class="keyword">if</span>(workbook <span class="keyword">instanceof</span> HSSFWorkbook)&#123;</div><div class="line"><span class="keyword">this</span>.version = <span class="number">0</span>;</div><div class="line"><span class="keyword">this</span>.workbook = workbook;</div><div class="line"><span class="keyword">this</span>.sconfig = config;</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(workbook <span class="keyword">instanceof</span> XSSFWorkbook)&#123;</div><div class="line">version = <span class="number">1</span>;</div><div class="line"><span class="keyword">this</span>.workbook = workbook;</div><div class="line"><span class="keyword">this</span>.sconfig = config;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月13日下午3:38:58</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 调用优先级 rgb index</span></div><div class="line"><span class="comment"> * <span class="doctag">@return</span></span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> CellStyle <span class="title">generatorStyle</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(sconfig.isOuter())&#123;</div><div class="line"><span class="keyword">return</span> sconfig.getCellStyle();</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line">HSSFCellStyle style = ((HSSFWorkbook)workbook).createCellStyle();</div><div class="line">Object bgColor = sconfig.getBackground();</div><div class="line"><span class="keyword">if</span>(bgColor <span class="keyword">instanceof</span> <span class="keyword">byte</span>[])&#123;</div><div class="line"><span class="keyword">byte</span>[] bs = (<span class="keyword">byte</span>[])bgColor;</div><div class="line">style.setFillForegroundColor(HSSFColorPredefined.WHITE.getIndex());</div><div class="line">HSSFPalette palette = ((HSSFWorkbook) workbook).getCustomPalette();</div><div class="line">palette.setColorAtIndex(HSSFColorPredefined.WHITE.getIndex(), bs[<span class="number">0</span>], bs[<span class="number">1</span>], bs[<span class="number">2</span>]);</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">short</span> bgIndex = (<span class="keyword">short</span>)bgColor;</div><div class="line"><span class="keyword">if</span>(bgIndex == -<span class="number">1</span>)&#123;</div><div class="line">style.setFillForegroundColor(HSSFColorPredefined.GREY_40_PERCENT.getIndex());</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">style.setFillForegroundColor(bgIndex);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</div><div class="line">style.setBorderBottom(BorderStyle.THIN);</div><div class="line">style.setBorderLeft(BorderStyle.THIN);</div><div class="line">style.setBorderRight(BorderStyle.THIN);</div><div class="line">style.setBorderTop(BorderStyle.THIN);</div><div class="line">style.setAlignment(HorizontalAlignment.CENTER);</div><div class="line">HSSFDataFormat format = ((HSSFWorkbook)workbook).createDataFormat();</div><div class="line">style.setDataFormat(format.getFormat(<span class="string">"@"</span>));</div><div class="line">style.setWrapText(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">HSSFFont font = ((HSSFWorkbook)workbook).createFont();</div><div class="line">Object fColor = sconfig.getFontColor();</div><div class="line"><span class="keyword">if</span>(fColor <span class="keyword">instanceof</span> <span class="keyword">byte</span>[])&#123;</div><div class="line"><span class="keyword">byte</span>[] frgb = (<span class="keyword">byte</span>[])fColor;</div><div class="line">font.setColor(HSSFColorPredefined.BLACK.getIndex());</div><div class="line">style.setFillForegroundColor(HSSFColorPredefined.BLACK.getIndex());</div><div class="line">HSSFPalette palette1 = ((HSSFWorkbook) workbook).getCustomPalette();</div><div class="line">palette1.setColorAtIndex(HSSFColorPredefined.BLACK.getIndex(), frgb[<span class="number">0</span>], frgb[<span class="number">1</span>], frgb[<span class="number">2</span>]);</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">short</span> fIndex = (<span class="keyword">short</span>)fColor;</div><div class="line"><span class="keyword">if</span>(fIndex == -<span class="number">1</span>)&#123;</div><div class="line">font.setColor(HSSFColorPredefined.BLACK.getIndex());</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">font.setColor(fIndex);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">font.setFontHeightInPoints(sconfig.getHeight());</div><div class="line">font.setFontName(sconfig.getFontName());</div><div class="line">font.setBold(sconfig.getBlob());</div><div class="line"></div><div class="line">style.setFont(font);</div><div class="line"></div><div class="line"><span class="keyword">return</span> style;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">XSSFCellStyle style = ((XSSFWorkbook)workbook).createCellStyle();</div><div class="line">Object bgColor = sconfig.getBackground();</div><div class="line"><span class="keyword">if</span>(bgColor <span class="keyword">instanceof</span> <span class="keyword">byte</span>[])&#123;</div><div class="line"><span class="keyword">byte</span>[] rgb = (<span class="keyword">byte</span>[])bgColor;</div><div class="line">XSSFColor color = <span class="keyword">new</span> XSSFColor(rgb, <span class="keyword">new</span> DefaultIndexedColorMap());</div><div class="line">style.setFillForegroundColor(color);</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">short</span> bgIndex = (<span class="keyword">short</span>)bgColor;</div><div class="line"><span class="keyword">if</span>(bgIndex == -<span class="number">1</span>)&#123;</div><div class="line">style.setFillForegroundColor(HSSFColorPredefined.GREY_40_PERCENT.getIndex());</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">style.setFillForegroundColor(bgIndex);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</div><div class="line">style.setBorderBottom(BorderStyle.THIN);</div><div class="line">style.setBorderLeft(BorderStyle.THIN);</div><div class="line">style.setBorderRight(BorderStyle.THIN);</div><div class="line">style.setBorderTop(BorderStyle.THIN);</div><div class="line">style.setAlignment(HorizontalAlignment.CENTER);</div><div class="line">style.setWrapText(<span class="keyword">true</span>);</div><div class="line">XSSFDataFormat format = ((XSSFWorkbook)workbook).createDataFormat();</div><div class="line">style.setDataFormat(format.getFormat(<span class="string">"@"</span>));</div><div class="line"></div><div class="line">XSSFFont font = ((XSSFWorkbook)workbook).createFont();</div><div class="line">Object fColor = sconfig.getFontColor();</div><div class="line"><span class="keyword">if</span>(fColor <span class="keyword">instanceof</span> <span class="keyword">byte</span>[])&#123;</div><div class="line"><span class="keyword">byte</span>[] frgb = (<span class="keyword">byte</span>[])fColor;</div><div class="line">XSSFColor color1 = <span class="keyword">new</span> XSSFColor(frgb,<span class="keyword">new</span> DefaultIndexedColorMap());</div><div class="line">style.setFillForegroundColor(color1);</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">short</span> fIndex = (<span class="keyword">short</span>)fColor;</div><div class="line"><span class="keyword">if</span>(fIndex == -<span class="number">1</span>)&#123;</div><div class="line">font.setColor(HSSFColorPredefined.BLACK.getIndex());</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">font.setColor(fIndex);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">font.setFontHeightInPoints(sconfig.getHeight());</div><div class="line">font.setFontName(sconfig.getFontName());</div><div class="line">font.setBold(sconfig.getBlob());</div><div class="line">style.setFont(font);</div><div class="line"></div><div class="line"><span class="keyword">return</span> style;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> CellStyle <span class="title">getDefaultStyle</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(version == <span class="number">0</span>)&#123;</div><div class="line">HSSFCellStyle style = ((HSSFWorkbook)workbook).createCellStyle();</div><div class="line">style.setBorderBottom(BorderStyle.THIN);</div><div class="line">style.setBorderLeft(BorderStyle.THIN);</div><div class="line">style.setBorderRight(BorderStyle.THIN);</div><div class="line">style.setBorderTop(BorderStyle.THIN);</div><div class="line">style.setAlignment(HorizontalAlignment.CENTER);</div><div class="line">HSSFDataFormat format = ((HSSFWorkbook)workbook).createDataFormat();</div><div class="line">style.setDataFormat(format.getFormat(<span class="string">"@"</span>));</div><div class="line">style.setWrapText(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">HSSFFont font = ((HSSFWorkbook)workbook).createFont();</div><div class="line">font.setFontHeightInPoints(sconfig.getHeight());</div><div class="line">font.setFontName(sconfig.getFontName());</div><div class="line">font.setBold(sconfig.getBlob());</div><div class="line"></div><div class="line">style.setFont(font);</div><div class="line"></div><div class="line"><span class="keyword">return</span> style;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">XSSFCellStyle style = ((XSSFWorkbook)workbook).createCellStyle();</div><div class="line">style.setBorderBottom(BorderStyle.THIN);</div><div class="line">style.setBorderLeft(BorderStyle.THIN);</div><div class="line">style.setBorderRight(BorderStyle.THIN);</div><div class="line">style.setBorderTop(BorderStyle.THIN);</div><div class="line">style.setAlignment(HorizontalAlignment.CENTER);</div><div class="line">style.setWrapText(<span class="keyword">true</span>);</div><div class="line">XSSFDataFormat format = ((XSSFWorkbook)workbook).createDataFormat();</div><div class="line">style.setDataFormat(format.getFormat(<span class="string">"@"</span>));</div><div class="line"></div><div class="line">XSSFFont font = ((XSSFWorkbook)workbook).createFont();</div><div class="line">font.setFontHeightInPoints(sconfig.getHeight());</div><div class="line">font.setFontName(sconfig.getFontName());</div><div class="line">font.setBold(sconfig.getBlob());</div><div class="line">style.setFont(font);</div><div class="line"></div><div class="line"><span class="keyword">return</span> style;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>  导出代码量比较大，贴出来两个比较核心的类，完整项目地址为：<a href="https://gitee.com/vvxtoys/vhelper" target="_blank" rel="external">https://gitee.com/vvxtoys/vhelper</a></p>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/11/25/excelhelper2/#disqus_thread</comments>
    </item>
    
    <item>
      <title>封装poi导入篇</title>
      <link>http://vvxtoys.cc/2018/11/25/excelhelper1/</link>
      <guid>http://vvxtoys.cc/2018/11/25/excelhelper1/</guid>
      <pubDate>Sun, 25 Nov 2018 07:06:34 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;  有封装的想法好久了，项目中有不少地方需要使用导入功能，导入虽说不能，但是每次都要为了特定类写一个特定方法，很麻烦，我很讨厌一直写这种东西了，正好趁着这次机会就写一个可以解决这种问题的小项目。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>  有封装的想法好久了，项目中有不少地方需要使用导入功能，导入虽说不能，但是每次都要为了特定类写一个特定方法，很麻烦，我很讨厌一直写这种东西了，正好趁着这次机会就写一个可以解决这种问题的小项目。</p><a id="more"></a><h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> &lt;dependency&gt;</div><div class="line">&lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</div><div class="line">&lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</div><div class="line">&lt;version&gt;4.0.0&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">&lt;dependency&gt;</div></pre></td></tr></table></figure><h3 id="基础工具类"><a href="#基础工具类" class="headerlink" title="基础工具类"></a>基础工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.vhelper.excelhelper.util;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.math.BigDecimal;</div><div class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFDateUtil;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellType;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Row;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoaderUtil</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getValue</span><span class="params">(Cell cell)</span> </span>&#123;</div><div class="line"><span class="keyword">switch</span> (cell.getCellType()) &#123;</div><div class="line"><span class="keyword">case</span> BOOLEAN:</div><div class="line"><span class="keyword">return</span> String.valueOf(cell.getBooleanCellValue()).trim();</div><div class="line"><span class="keyword">case</span> NUMERIC:</div><div class="line"><span class="keyword">if</span>(HSSFDateUtil.isCellDateFormatted(cell))&#123;</div><div class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line"><span class="keyword">return</span> String.valueOf(sdf.format(HSSFDateUtil.getJavaDate(cell.getNumericCellValue()))).trim();</div><div class="line">&#125;</div><div class="line">BigDecimal bd = <span class="keyword">new</span> BigDecimal(String.valueOf(cell.getNumericCellValue()).trim());</div><div class="line"><span class="keyword">return</span> bd.toPlainString();</div><div class="line"><span class="keyword">default</span>:</div><div class="line"><span class="keyword">return</span> String.valueOf(cell.getStringCellValue()).trim();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 空行</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isBlank</span><span class="params">(Row row)</span> </span>&#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; row.getLastCellNum(); i++) &#123;</div><div class="line">Cell cell = row.getCell(i);</div><div class="line"><span class="keyword">if</span> (cell != <span class="keyword">null</span> &amp;&amp; cell.getCellType() != CellType.BLANK) &#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">(Object obj)</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Cell) &#123;</div><div class="line">Cell cell = (Cell) obj;</div><div class="line"><span class="keyword">return</span> getValue(cell) == <span class="keyword">null</span> || <span class="string">""</span>.equals(getValue(cell));</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> obj == <span class="keyword">null</span> || obj.toString().trim().equals(<span class="string">""</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="实体"><a href="#实体" class="headerlink" title="实体"></a>实体</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.vhelper.excelhelper.loader;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.Array;</div><div class="line"><span class="keyword">import</span> java.util.stream.BaseStream;</div><div class="line"><span class="keyword">import</span> java.util.stream.IntStream;</div><div class="line"><span class="keyword">import</span> java.util.stream.Stream;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span> 2018年10月30日上午11:34:23</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></div><div class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelLoader</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> version;<span class="comment">//excel版本</span></div><div class="line"><span class="keyword">private</span> Class&lt;T&gt; clazz;<span class="comment">//解析类型 javaben或者map</span></div><div class="line"><span class="keyword">private</span> String path;<span class="comment">//路径</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> startRow;<span class="comment">//解析开始条数</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> endRow;<span class="comment">//解析结束条数</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] indexs;<span class="comment">//对应列下标</span></div><div class="line"><span class="keyword">private</span> String[] colums;<span class="comment">//列名</span></div><div class="line"><span class="keyword">private</span> String sheetName;  <span class="comment">//工作表名</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> sheetIndex;  <span class="comment">//工作表下标</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> sheetMaxIndex;<span class="comment">//最大工作表下标</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> version;</div><div class="line"><span class="keyword">private</span> Class&lt;T&gt; clazz;</div><div class="line"><span class="keyword">private</span> String path;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> startRow;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> endRow;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] indexs;</div><div class="line"><span class="keyword">private</span> String[] colums;</div><div class="line"><span class="keyword">private</span> String sheetName;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> sheetIndex= -<span class="number">1</span>;<span class="comment">//默认值</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> sheetMaxIndex;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(String path)</span></span>&#123;</div><div class="line">verifyPath(path);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(Class&lt;T&gt; clazz, String path)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">verifyPath(path);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verifyPath</span><span class="params">(String path)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.path = path;</div><div class="line"><span class="keyword">if</span>(path.endsWith(<span class="string">".xlsx"</span>))&#123;</div><div class="line"><span class="keyword">this</span>.version = <span class="number">1</span>;</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">".xls"</span>))&#123;</div><div class="line"><span class="keyword">this</span>.version = <span class="number">0</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"path is unavailable!"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setStartRow</span><span class="params">(<span class="keyword">int</span> startRow)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.startRow = startRow;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setEndRow</span><span class="params">(<span class="keyword">int</span> endRow)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.endRow = endRow;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setIndexs</span><span class="params">(<span class="keyword">int</span>[] indexs)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.indexs = indexs;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setColums</span><span class="params">(String[] colums)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.colums = colums;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setSheetName</span><span class="params">(String sheetName)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.sheetName = sheetName;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setSheetIndex</span><span class="params">(<span class="keyword">int</span> sheetIndex)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.sheetIndex = sheetIndex;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Builder&lt;T&gt; <span class="title">setSheetMaxIndex</span><span class="params">(<span class="keyword">int</span> sheetMaxIndex)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.sheetMaxIndex = sheetMaxIndex;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> ExcelLoader&lt;T&gt; <span class="title">builder</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span>(endRow == <span class="number">0</span>)&#123;</div><div class="line">endRow = version == <span class="number">0</span>?<span class="number">65535</span>:<span class="number">1048575</span>;<span class="comment">//对应xls、xlsx</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="keyword">new</span> ExcelLoader&lt;T&gt;(<span class="keyword">this</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">ExcelLoader</span><span class="params">(Builder&lt;T&gt; builder)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = builder.clazz;</div><div class="line"><span class="keyword">this</span>.path = builder.path;</div><div class="line"><span class="keyword">this</span>.version = builder.version;</div><div class="line"><span class="keyword">this</span>.colums = builder.colums;</div><div class="line"><span class="keyword">this</span>.indexs = builder.indexs;</div><div class="line"><span class="keyword">this</span>.sheetName = builder.sheetName;</div><div class="line"><span class="keyword">this</span>.startRow = builder.startRow;</div><div class="line"><span class="keyword">this</span>.endRow = builder.endRow;</div><div class="line"><span class="keyword">this</span>.sheetMaxIndex = builder.sheetMaxIndex;</div><div class="line"><span class="keyword">this</span>.sheetIndex = builder.sheetIndex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorColums</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</div><div class="line">colums = <span class="keyword">new</span> String[len];</div><div class="line"><span class="comment">//1.8</span></div><div class="line">IntStream.range(<span class="number">0</span>,len).forEach(i -&gt; Array.set(colums, i, <span class="string">"C"</span>+i));</div><div class="line"><span class="comment">//1.7</span></div><div class="line"><span class="comment">//for(int i=0;i&lt;len;i++)&#123;</span></div><div class="line"><span class="comment">//colums[i] = "C"+i;</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorIndexs</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</div><div class="line"><span class="comment">//1.8</span></div><div class="line">indexs = IntStream.range(<span class="number">0</span>, len).toArray();</div><div class="line"><span class="comment">//1.7</span></div><div class="line"><span class="comment">//indexs = new int[len];</span></div><div class="line"><span class="comment">//for(int i=0;i&lt;len;i++)&#123;</span></div><div class="line"><span class="comment">//indexs[i] = i;</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.indexs == <span class="keyword">null</span>) &#123;</div><div class="line">generatorIndexs(len);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.colums == <span class="keyword">null</span>)&#123;</div><div class="line">generatorColums(len);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPath</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>.path;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> version;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStartRow</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> startRow;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getEndRow</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> endRow;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] getIndexs() &#123;</div><div class="line"><span class="keyword">return</span> indexs;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> String[] getColums() &#123;</div><div class="line"><span class="keyword">return</span> colums;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSheetName</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sheetName;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSheetIndex</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sheetIndex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSheetMaxIndex</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sheetMaxIndex;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Class&lt;T&gt; <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">parserType</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.clazz == <span class="keyword">null</span>)&#123;</div><div class="line"><span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//转换为map</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//转换为javabean</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="处理类"><a href="#处理类" class="headerlink" title="处理类"></a>处理类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.vhelper.excelhelper.loader;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vhelper.common.utils.BeanUtil;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vhelper.excelhelper.util.LoaderUtil;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Loader</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> ExcelLoader&lt;T&gt; el;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Loader</span><span class="params">(ExcelLoader&lt;T&gt; el)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.el = el;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> List&lt;?&gt; parsingExcel() &#123;</div><div class="line"><span class="keyword">if</span> (el.getVersion() == <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">return</span> parsingExcelByXls();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">return</span> parsingExcelByXlsx();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span> 2018年11月1日上午10:26:01</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 解析优先级 </span></div><div class="line"><span class="comment"> * 1.sheetName sheet页名 </span></div><div class="line"><span class="comment"> * 2.index sheet下标 </span></div><div class="line"><span class="comment"> * 3.maxindex sheet最大下标</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">private</span> List&lt;?&gt; parsingExcelByXls() &#123;</div><div class="line">List&lt;T&gt; list = <span class="keyword">new</span> ArrayList&lt;T&gt;();<span class="comment">// bean list</span></div><div class="line">List&lt;Map&lt;String, Object&gt;&gt; resultList = <span class="keyword">new</span> ArrayList&lt;&gt;();<span class="comment">// map list</span></div><div class="line">HSSFWorkbook workbook = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line"><span class="keyword">int</span> maxIndex = el.getSheetMaxIndex();<span class="comment">// sheet页最大下标</span></div><div class="line"><span class="keyword">int</span> index = el.getSheetIndex();<span class="comment">// sheet页下标</span></div><div class="line">InputStream is = <span class="keyword">new</span> FileInputStream(el.getPath());</div><div class="line">workbook = <span class="keyword">new</span> HSSFWorkbook(is);</div><div class="line">HSSFSheet sheet = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">int</span> len = <span class="number">0</span>;<span class="comment">// 自动生成数组参数</span></div><div class="line"><span class="keyword">int</span> sheetMaxNumber = workbook.getNumberOfSheets();<span class="comment">// sheet个数</span></div><div class="line"><span class="keyword">if</span> (el.getSheetName() != <span class="keyword">null</span>) &#123;</div><div class="line">sheet = workbook.getSheet(el.getSheetName());</div><div class="line">maxIndex = <span class="number">1</span>;<span class="comment">// 不用遍历所有sheet页</span></div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</div><div class="line"><span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; sheetMaxNumber) &#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"index is out of bounds"</span>);</div><div class="line">&#125;</div><div class="line">sheet = workbook.getSheetAt(index);</div><div class="line">maxIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">if</span> (maxIndex &lt; <span class="number">1</span>) &#123;</div><div class="line">maxIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (maxIndex &gt; sheetMaxNumber) &#123;</div><div class="line">maxIndex = sheetMaxNumber;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (el.getColums() == <span class="keyword">null</span> || el.getIndexs() == <span class="keyword">null</span>) &#123;</div><div class="line"><span class="keyword">int</span> startRow = el.getStartRow();</div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (startRow &lt;= <span class="number">0</span>) &#123;</div><div class="line">startIndex = <span class="number">0</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = startRow - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (sheet == <span class="keyword">null</span>) &#123;</div><div class="line">len = workbook.getSheetAt(<span class="number">0</span>).getRow(startIndex).getPhysicalNumberOfCells();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">len = sheet.getRow(startIndex).getPhysicalNumberOfCells();</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"start column is blank"</span>);</div><div class="line">&#125;</div><div class="line">el.generator(len);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; maxIndex; s++) &#123;</div><div class="line"><span class="keyword">if</span> (sheet == <span class="keyword">null</span>) &#123;</div><div class="line">sheet = workbook.getSheetAt(s);</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> sheetMaxRow = sheet.getLastRowNum();<span class="comment">// 行数</span></div><div class="line"><span class="keyword">int</span> startRow = el.getStartRow();</div><div class="line"><span class="keyword">int</span> endRow = el.getEndRow();</div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> endIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (startRow &lt;= <span class="number">0</span>) &#123;</div><div class="line">startIndex = <span class="number">0</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = startRow - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (endRow &gt; sheetMaxRow) &#123;</div><div class="line">endIndex = sheetMaxRow + <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">endIndex = endRow;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> rowNum = startIndex; rowNum &lt; endIndex; rowNum++) &#123;</div><div class="line">HSSFRow row = sheet.getRow(rowNum);</div><div class="line"><span class="keyword">if</span> (LoaderUtil.isBlank(row)) &#123;<span class="comment">// 空行</span></div><div class="line"><span class="keyword">continue</span>;</div><div class="line">&#125;</div><div class="line">Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; el.getColums().length; i++) &#123;</div><div class="line">HSSFCell cell = row.getCell(el.getIndexs()[i]);</div><div class="line"><span class="keyword">if</span> (!LoaderUtil.isEmpty(cell)) &#123;</div><div class="line">result.put(el.getColums()[i], LoaderUtil.getValue(cell));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">resultList.add(result);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (el.parserType() == <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">return</span> resultList;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">Class&lt;T&gt; clazz = el.getClazz();</div><div class="line"><span class="keyword">for</span> (Map&lt;String, Object&gt; m : resultList) &#123;</div><div class="line">list.add(BeanUtil.mapToBean(m, clazz));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="comment">//finally &#123;</span></div><div class="line"><span class="comment">//if (workbook != null) &#123;</span></div><div class="line"><span class="comment">//try &#123;</span></div><div class="line"><span class="comment">//workbook.close();</span></div><div class="line"><span class="comment">//&#125; catch (IOException e) &#123;</span></div><div class="line"><span class="comment">//e.printStackTrace();</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">return</span> list;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> List&lt;?&gt; parsingExcelByXlsx() &#123;</div><div class="line">List&lt;T&gt; list = <span class="keyword">new</span> ArrayList&lt;T&gt;();<span class="comment">// bean list</span></div><div class="line">List&lt;Map&lt;String, Object&gt;&gt; resultList = <span class="keyword">new</span> ArrayList&lt;&gt;();<span class="comment">// map list</span></div><div class="line">XSSFWorkbook workbook = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line"><span class="keyword">int</span> maxIndex = el.getSheetMaxIndex();<span class="comment">// sheet页最大下标</span></div><div class="line"><span class="keyword">int</span> index = el.getSheetIndex();<span class="comment">// sheet页下标</span></div><div class="line">InputStream is = <span class="keyword">new</span> FileInputStream(el.getPath());</div><div class="line">workbook = <span class="keyword">new</span> XSSFWorkbook(is);</div><div class="line">XSSFSheet sheet = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">int</span> len = <span class="number">0</span>;<span class="comment">// 自动生成数组参数</span></div><div class="line"><span class="keyword">int</span> sheetMaxNumber = workbook.getNumberOfSheets();<span class="comment">// sheet个数</span></div><div class="line"><span class="keyword">if</span> (el.getSheetName() != <span class="keyword">null</span>) &#123;</div><div class="line">sheet = workbook.getSheet(el.getSheetName());</div><div class="line">maxIndex = <span class="number">1</span>;<span class="comment">// 不用遍历所有sheet页</span></div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</div><div class="line"><span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; sheetMaxNumber) &#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"index is out of bounds"</span>);</div><div class="line">&#125;</div><div class="line">sheet = workbook.getSheetAt(index);</div><div class="line">maxIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">if</span> (maxIndex &lt; <span class="number">1</span>) &#123;</div><div class="line">maxIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (maxIndex &gt; sheetMaxNumber) &#123;</div><div class="line">maxIndex = sheetMaxNumber;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (el.getColums() == <span class="keyword">null</span> || el.getIndexs() == <span class="keyword">null</span>) &#123;</div><div class="line"><span class="keyword">int</span> startRow = el.getStartRow();</div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (startRow &lt;= <span class="number">0</span>) &#123;</div><div class="line">startIndex = <span class="number">0</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = startRow - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (sheet == <span class="keyword">null</span>) &#123;</div><div class="line">len = workbook.getSheetAt(<span class="number">0</span>).getRow(startIndex).getPhysicalNumberOfCells();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">len = sheet.getRow(startIndex).getPhysicalNumberOfCells();</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"start column is blank"</span>);</div><div class="line">&#125;</div><div class="line">el.generator(len);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; maxIndex; s++) &#123;</div><div class="line"><span class="keyword">if</span> (sheet == <span class="keyword">null</span>) &#123;</div><div class="line">sheet = workbook.getSheetAt(s);</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> sheetMaxRow = sheet.getLastRowNum();<span class="comment">// 行数</span></div><div class="line"><span class="keyword">int</span> startRow = el.getStartRow();</div><div class="line"><span class="keyword">int</span> endRow = el.getEndRow();</div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> endIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (startRow &lt;= <span class="number">0</span>) &#123;</div><div class="line">startIndex = <span class="number">0</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = startRow - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (endRow &gt; sheetMaxRow) &#123;</div><div class="line">endIndex = sheetMaxRow + <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">endIndex = endRow;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> rowNum = startIndex; rowNum &lt; endIndex; rowNum++) &#123;</div><div class="line">XSSFRow row = sheet.getRow(rowNum);</div><div class="line"><span class="keyword">if</span> (LoaderUtil.isBlank(row)) &#123;<span class="comment">// 空行</span></div><div class="line"><span class="keyword">continue</span>;</div><div class="line">&#125;</div><div class="line">Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; el.getColums().length; i++) &#123;</div><div class="line">XSSFCell cell = row.getCell(el.getIndexs()[i]);</div><div class="line"><span class="keyword">if</span> (!LoaderUtil.isEmpty(cell)) &#123;</div><div class="line">result.put(el.getColums()[i], LoaderUtil.getValue(cell));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">resultList.add(result);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (el.parserType() == <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">return</span> resultList;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">Class&lt;T&gt; clazz = el.getClazz();</div><div class="line"><span class="keyword">for</span> (Map&lt;String, Object&gt; m : resultList) &#123;</div><div class="line">list.add(BeanUtil.mapToBean(m, clazz));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">finally</span> &#123;</div><div class="line"><span class="keyword">if</span> (workbook != <span class="keyword">null</span>) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">workbook.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> list;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="beanUtil"><a href="#beanUtil" class="headerlink" title="beanUtil"></a>beanUtil</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public static &lt;T&gt; T mapToBean(Map&lt;String, Object&gt; map, Class&lt;T&gt; clazz) &#123;</div><div class="line">if (map == null) &#123;</div><div class="line">return null;</div><div class="line">&#125;</div><div class="line">T obj = null;</div><div class="line">try&#123;</div><div class="line">obj = clazz.newInstance();</div><div class="line">BeanUtils.populate(obj, map);</div><div class="line">&#125;catch (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">return obj;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="调用类"><a href="#调用类" class="headerlink" title="调用类"></a>调用类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.vhelper.excelhelper;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vhelper.excelhelper.loader.ExcelLoader;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vhelper.excelhelper.loader.Loader;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vhelper.excelhelper.loader.ExcelLoader.Builder;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelLoaderHelper</span></span>&#123;</div><div class="line"></div><div class="line">Builder&lt;?&gt; builder;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ExcelLoaderHelper</span><span class="params">(String path)</span> </span>&#123;</div><div class="line">builder = <span class="keyword">new</span> Builder&lt;&gt;(path);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ExcelLoaderHelper</span><span class="params">(String path,Class&lt;?&gt; clazz)</span> </span>&#123;</div><div class="line">builder = <span class="keyword">new</span> Builder&lt;&gt;(clazz, path);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:06:18</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 设置起始行</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> startRow </span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStartRow</span><span class="params">(<span class="keyword">int</span> startRow)</span></span>&#123;</div><div class="line">builder.setStartRow(startRow);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:07:02</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 设置结束行</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> endRow </span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEndRow</span><span class="params">(<span class="keyword">int</span> endRow)</span></span>&#123;</div><div class="line">builder.setEndRow(endRow);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:07:40</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 指定列下标</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> indexs</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIndexs</span><span class="params">(<span class="keyword">int</span>[] indexs)</span></span>&#123;</div><div class="line">builder.setIndexs(indexs);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:08:08</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 设置列名</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> colums</span></div><div class="line"><span class="comment"> * <span class="doctag">@return</span></span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColums</span><span class="params">(String[] colums)</span></span>&#123;</div><div class="line">builder.setColums(colums);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:09:08</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 根据sheet名读取</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> sheetName</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSheetName</span><span class="params">(String sheetName)</span></span>&#123;</div><div class="line">builder.setSheetName(sheetName);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:09:25</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 读取指定下标sheet</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> sheetIndex</span></div><div class="line"><span class="comment"> * <span class="doctag">@return</span></span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSheetIndex</span><span class="params">(<span class="keyword">int</span> sheetIndex)</span></span>&#123;</div><div class="line">builder.setSheetIndex(sheetIndex);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span>   2018年11月2日上午10:10:34</span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 设置可读取最大sheet页</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> sheetMaxIndex</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSheetMaxIndex</span><span class="params">(<span class="keyword">int</span> sheetMaxIndex)</span></span>&#123;</div><div class="line">builder.setSheetMaxIndex(sheetMaxIndex);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"rawtypes"</span>)</div><div class="line"><span class="keyword">public</span> List&lt;?&gt; loadExcelToMap()&#123;</div><div class="line">ExcelLoader&lt;?&gt; el = builder.builder();</div><div class="line">Loader loader = <span class="keyword">new</span> Loader&lt;&gt;(el);</div><div class="line"><span class="keyword">return</span> loader.parsingExcel();</div><div class="line">&#125;</div><div class="line"><span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"rawtypes"</span>&#125;)</div><div class="line"><span class="keyword">public</span> List&lt;?&gt; loadExcelToBean()&#123;</div><div class="line">ExcelLoader&lt;?&gt; el = builder.builder();</div><div class="line"><span class="keyword">if</span>(el.getClazz() == <span class="keyword">null</span>)&#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"cannot be cast to NULL"</span>);</div><div class="line">&#125;</div><div class="line">Loader loader = <span class="keyword">new</span> Loader&lt;&gt;(el);</div><div class="line"><span class="keyword">return</span> loader.parsingExcel();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/11/25/excelhelper1/#disqus_thread</comments>
    </item>
    
    <item>
      <title>vim常用命令</title>
      <link>http://vvxtoys.cc/2018/11/25/vim/</link>
      <guid>http://vvxtoys.cc/2018/11/25/vim/</guid>
      <pubDate>Sun, 25 Nov 2018 07:06:07 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;​    自从用vscode代替eclipse，也就开始使用vim键盘布局了，刚开始也是不太习惯，不过现在越来越顺手了，也是上网搜了不少vim快捷命令，整理下来，防止以后忘记了。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>​    自从用vscode代替eclipse，也就开始使用vim键盘布局了，刚开始也是不太习惯，不过现在越来越顺手了，也是上网搜了不少vim快捷命令，整理下来，防止以后忘记了。</p><a id="more"></a><h4 id="ZZ"><a href="#ZZ" class="headerlink" title="ZZ"></a>ZZ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">保存退出</div></pre></td></tr></table></figure><h4 id="name"><a href="#name" class="headerlink" title="/{name}"></a>/{name}</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">向下检索，高亮显示 n向下 N向上</div></pre></td></tr></table></figure><h4 id="name-1"><a href="#name-1" class="headerlink" title="?{name}"></a>?{name}</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">向上检索，高亮显示 n向上 N向下</div></pre></td></tr></table></figure><h4 id="noh"><a href="#noh" class="headerlink" title="noh"></a>noh</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">取消高亮显示</div></pre></td></tr></table></figure><h4 id="x"><a href="#x" class="headerlink" title="x"></a>x</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">删除光标后字符</div></pre></td></tr></table></figure><h4 id="X"><a href="#X" class="headerlink" title="X"></a>X</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">删除光标前的字符</div></pre></td></tr></table></figure><h4 id="D"><a href="#D" class="headerlink" title="D"></a>D</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">删除光标后本行字符</div></pre></td></tr></table></figure><h4 id="dd"><a href="#dd" class="headerlink" title="dd"></a>dd</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">删除一行</div></pre></td></tr></table></figure><h4 id=""><a href="#" class="headerlink" title="$:"></a>$:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">移动到末行</div></pre></td></tr></table></figure><h4 id="number"><a href="#number" class="headerlink" title=":{number}"></a>:{number}</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">移动到指定行</div></pre></td></tr></table></figure><h4 id="yw-vwp"><a href="#yw-vwp" class="headerlink" title="yw vwp"></a>yw vwp</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">替换单词</div></pre></td></tr></table></figure><h4 id="a-i"><a href="#a-i" class="headerlink" title="a i"></a>a i</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">光标前插入</div></pre></td></tr></table></figure><h4 id="I"><a href="#I" class="headerlink" title="I"></a>I</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">行首插入</div></pre></td></tr></table></figure><h4 id="A"><a href="#A" class="headerlink" title="A"></a>A</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">行尾插入</div></pre></td></tr></table></figure><h4 id="o"><a href="#o" class="headerlink" title="o"></a>o</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">当前行后插入空行</div></pre></td></tr></table></figure><h4 id="O"><a href="#O" class="headerlink" title="O"></a>O</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">当前行前插入空行</div></pre></td></tr></table></figure><h4 id="p-小p"><a href="#p-小p" class="headerlink" title="p 小p"></a>p 小p</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">粘贴光标前</div></pre></td></tr></table></figure><h4 id="P"><a href="#P" class="headerlink" title="P"></a>P</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">粘贴到光标后</div></pre></td></tr></table></figure><h4 id="w-w"><a href="#w-w" class="headerlink" title=":w :w!"></a>:w :w!</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">保存 !表示强制</div></pre></td></tr></table></figure><h4 id="q-q"><a href="#q-q" class="headerlink" title=":q :q!"></a>:q :q!</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">退出</div></pre></td></tr></table></figure><h4 id="1-10-s-a-A"><a href="#1-10-s-a-A" class="headerlink" title="1,10/s/a/A"></a>1,10/s/a/A</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1到10行之间 把a替换为A</div></pre></td></tr></table></figure><h4 id="n-dd"><a href="#n-dd" class="headerlink" title="{n}dd"></a>{n}dd</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">4dd 删除当前行和下面3行</div></pre></td></tr></table></figure><h4 id="e"><a href="#e" class="headerlink" title="e"></a>e</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">新建文件</div></pre></td></tr></table></figure><h4 id="f"><a href="#f" class="headerlink" title="f"></a>f</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">状态信息</div></pre></td></tr></table></figure><h4 id="hjkl"><a href="#hjkl" class="headerlink" title="hjkl"></a>hjkl</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">浏览文件</div></pre></td></tr></table></figure><h4 id="u"><a href="#u" class="headerlink" title="u"></a>u</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">撤销</div><div class="line">如果在选中状态下，u转为小写,U转为大写</div></pre></td></tr></table></figure><h4 id="v-V"><a href="#v-V" class="headerlink" title="v V"></a>v V</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">选择</div></pre></td></tr></table></figure><h4 id="gg-G"><a href="#gg-G" class="headerlink" title="gg G"></a>gg G</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gg 移动到文首</div><div class="line">G 移动到文末</div></pre></td></tr></table></figure><h4 id="CTRL-r"><a href="#CTRL-r" class="headerlink" title="CTRL r"></a>CTRL r</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">重做</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/11/25/vim/#disqus_thread</comments>
    </item>
    
    <item>
      <title>使用gitblit搭建git服务器</title>
      <link>http://vvxtoys.cc/2018/11/25/gitblit/</link>
      <guid>http://vvxtoys.cc/2018/11/25/gitblit/</guid>
      <pubDate>Sun, 25 Nov 2018 05:24:00 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;  一直在学习新技术，我想都整理到博客上。公司还在坚持用svn，之前学过git都快要忘记了，此篇博客记录搭建基于gitblit的git服务器。当然直接使用linux也可以，不过我不是很熟悉，考虑到我的主语言是Java，也就用gitblit搭建了一个。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>  一直在学习新技术，我想都整理到博客上。公司还在坚持用svn，之前学过git都快要忘记了，此篇博客记录搭建基于gitblit的git服务器。当然直接使用linux也可以，不过我不是很熟悉，考虑到我的主语言是Java，也就用gitblit搭建了一个。</p><a id="more"></a><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Windows server 2016</div><div class="line"></div><div class="line">Centos 7</div><div class="line"></div><div class="line">jdk8</div><div class="line"></div><div class="line">gitblit1.8</div></pre></td></tr></table></figure><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">官网:http://www.gitblit.com/</div></pre></td></tr></table></figure><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><h4 id="解压文件"><a href="#解压文件" class="headerlink" title="解压文件"></a>解压文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gitblit-1.8.0.zip</div></pre></td></tr></table></figure><h4 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">/data/defaults.properties</div><div class="line">修改属性</div><div class="line">git.repositoriesFolder = $&#123;baseFolder&#125;/git -&gt; &#123;资源库地址&#125;</div><div class="line">server.httpPort = <span class="number">0</span> -&gt; &#123;自定义端口号&#125;</div><div class="line">server.httpsBindInterface =  -&gt; &#123;localhost&#125;</div></pre></td></tr></table></figure><h4 id="注册服务"><a href="#注册服务" class="headerlink" title="注册服务"></a>注册服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">/installService.cmd</div><div class="line">在SET ARCH=amd64下添加</div><div class="line">SET CD=&#123;gitblit解压目录&#125;</div><div class="line">修改</div><div class="line">--StartParams = &quot;&quot; </div><div class="line">管理员身份运行此文件然后启动服务</div></pre></td></tr></table></figure><h4 id="开放端口"><a href="#开放端口" class="headerlink" title="开放端口"></a>开放端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">关闭防火墙或者建立端口开放规则</div></pre></td></tr></table></figure><h4 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">登陆 ip:配置的端口号</div><div class="line">初始账户密码 admin admin</div></pre></td></tr></table></figure><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -zxvf gitblit-1.8.0.tar.gz</div></pre></td></tr></table></figure><h4 id="修改配置文件-1"><a href="#修改配置文件-1" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">需要修改的项同window</div></pre></td></tr></table></figure><h4 id="开放端口-1"><a href="#开放端口-1" class="headerlink" title="开放端口"></a>开放端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//开放端口</div><div class="line">firewall-cmd --zone=public --add-port=&#123;端口号&#125;/tcp --permanent </div><div class="line">//重新加载</div><div class="line">firewall-cmd --reload</div><div class="line">//重启防火墙</div><div class="line">systemctl restart firewalld.service</div></pre></td></tr></table></figure><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1.回到上级目录</div><div class="line">2，修改gitblit.sh</div><div class="line">修改为 </div><div class="line">nohup java -jar gitblit.jar --baseFolder data &gt;&#123;log地址&#125; &amp;</div><div class="line">3.bash gitblit.sh</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/11/25/gitblit/#disqus_thread</comments>
    </item>
    
    <item>
      <title>使用nexus3.x搭建maven私服</title>
      <link>http://vvxtoys.cc/2018/09/19/%E4%BD%BF%E7%94%A8nexus3.x%E6%90%AD%E5%BB%BAmaven%E7%A7%81%E6%9C%8D/</link>
      <guid>http://vvxtoys.cc/2018/09/19/%E4%BD%BF%E7%94%A8nexus3.x%E6%90%AD%E5%BB%BAmaven%E7%A7%81%E6%9C%8D/</guid>
      <pubDate>Wed, 19 Sep 2018 12:20:49 GMT</pubDate>
      <description>
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;  好久之前就想搭建maven仓库了，一直拖到了现在，也就是懒得动，现在终于是要付诸行动了。网上查了不少资料，好多博客都是关于2.x的搭建，我下载的是最新版的nexus，好多教程已经不能使用，以此记录我的踩坑搭建之路。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>  好久之前就想搭建maven仓库了，一直拖到了现在，也就是懒得动，现在终于是要付诸行动了。网上查了不少资料，好多博客都是关于2.x的搭建，我下载的是最新版的nexus，好多教程已经不能使用，以此记录我的踩坑搭建之路。</p>  <a id="more"></a><h2 id="安装环境和需要的软件"><a href="#安装环境和需要的软件" class="headerlink" title="安装环境和需要的软件"></a>安装环境和需要的软件</h2><ul><li>Centos 7</li><li>Java 1.8 </li><li>nexus OSS 3.13</li></ul><h2 id="Java安装"><a href="#Java安装" class="headerlink" title="Java安装"></a>Java安装</h2><ul><li>卸载openjdk</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1.rpm -qa|grep java 查找</div><div class="line">2.rpm -e --nodeps xxxx 卸载openjdk</div></pre></td></tr></table></figure><ul><li>下载jdk</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate --no-cookies --header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; &quot;http://download.oracle.com/otn-pub/java/jdk/8u181-b13/96a7b8442fe848ef90c96a2fad6ed6d1/jdk-8u181-linux-x64.tar.gz&quot;</div></pre></td></tr></table></figure><ul><li>安装</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">1.mkdir /usr/java 在/usr下建立Java文件夹</div><div class="line">2.mv jdk-8u181-linux-x64.tar.gz /usr/java/jdk-8u181-linux-x64.tar.gz</div><div class="line">3.tar -xzvf jdk-8u181-linux-x64.tar.gz 解压</div><div class="line">4.mv jdk1.8.0_181/ jdk1.8</div><div class="line">5.vim /etc/profile</div><div class="line">6.设置环境变量</div><div class="line">JAVA_HOME=/usr/java/jdk1.8</div><div class="line">JRE_HOME=/usr/java/jdk1.8/jre</div><div class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</div><div class="line">CLASSPARH=,:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</div><div class="line">export JAVA_HOME JRE_HOME PATH CLASSPATH</div><div class="line">分隔符是冒号不是分号</div><div class="line">7.source /etc/profile 使环境变量生效</div><div class="line">8.java -version 查看Java版本</div></pre></td></tr></table></figure><h2 id="Nexus安装"><a href="#Nexus安装" class="headerlink" title="Nexus安装"></a>Nexus安装</h2><ul><li>创建文件夹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir /usr/software/nexus</div></pre></td></tr></table></figure><ul><li>下载安装文件 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/software/nexus</div><div class="line">wget &quot;https://sonatype-download.global.ssl.fastly.net/repository/repositoryManager/3/nexus-3.13.0-01-unix.tar.gz&quot;</div></pre></td></tr></table></figure><ul><li>解压</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -xzvf nexus-3.13.0-01-unix.tar.gz</div></pre></td></tr></table></figure><p>解压后</p><p><img src="https://i.loli.net/2018/09/19/5ba24aee0fc0e.png" alt=""></p><ul><li>修改配置文件 也可以不改</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd nexus-3.13.0-01/etc</div><div class="line">vim nexus-default.properties</div></pre></td></tr></table></figure><p>默认端口8081,我修改为5743</p><p><img src="https://i.loli.net/2018/09/19/5ba24cf8db310.png" alt=""></p><ul><li>开放端口 root用户</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">1.查看防火墙状态</div><div class="line">firewall-cmd --state</div><div class="line">2.如果关闭开启防火墙</div><div class="line">systemctl start firewalld.service</div><div class="line">3.开放5743端口(以自己的配置为准)</div><div class="line">firewall-cmd --zone=public --add-port=5743/tcp --permanent </div><div class="line">4.重新加载</div><div class="line">firewall-cmd --reload</div><div class="line">5.重启防火墙</div><div class="line">systemctl restart firewalld.service</div></pre></td></tr></table></figure><ul><li><p>启动nexus</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cd nexus-3.13.0-01/bin</div><div class="line">./nexus start</div><div class="line">常用命令</div><div class="line">./nexus restart</div><div class="line">./nexus stop</div></pre></td></tr></table></figure></li><li><p>本地访问 ip:端口号 默认账户admin 密码 admin123</p><p><img src="https://i.loli.net/2018/09/19/5ba250721ef32.png" alt=""></p></li></ul><ul><li><p>选择Repositories  创建三方私有库<br><img src="https://i.loli.net/2018/09/19/5ba2517e0be97.png" alt=""></p></li><li><p>我创建了两个maven hosted仓库<br><img src="https://i.loli.net/2018/09/19/5ba252b4a63a9.png" alt="5.png"></p></li><li><p>将这两个仓库加入到maven-public中</p><p>点击maven-public</p><p><img src="https://i.loli.net/2018/09/19/5ba254898e0de.png" alt=""></p><p>到这里线上就配置完成了</p></li></ul><h2 id="配置Maven"><a href="#配置Maven" class="headerlink" title="配置Maven"></a>配置Maven</h2><ul><li>找到setting.xml 在mirrors中添加mirror</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span></span></div><div class="line">&lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>central repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>在servers中添加server</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- id与pom.xml中的distributionManagement下repository的id对应 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>在profiles中添加profile</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">releases</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>激活profile</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activeProfiles</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--profile下的id--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">activeProfile</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">activeProfile</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">activeProfiles</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="上传jar-发布项目"><a href="#上传jar-发布项目" class="headerlink" title="上传jar 发布项目"></a>上传jar 发布项目</h2><ul><li>网页上传jar  upload</li></ul><p><img src="https://i.loli.net/2018/09/19/5ba2621c14d0b.png" alt=""></p><ul><li><p>maven deploy</p><ul><li>pom.xml 添加 distributionManagement</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">repository</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd-releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">name</span>&gt;</span>3rd-snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://ip:端口/repository/3rd-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></div></pre></td></tr></table></figure><p>id要和setting.xml中的server id一致</p><ul><li>运行maven deploy</li></ul><p><img src="https://i.loli.net/2018/09/19/5ba2634c00802.png" alt=""></p></li><li><p>查看线上</p></li></ul><p><img src="https://i.loli.net/2018/09/19/5ba263e5c1765.png" alt=""><br>发布成功,以后可以直接在别的项目中使用</p><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1.window注册服务</div><div class="line">nexus.exe /install</div><div class="line">2.window运行</div><div class="line">nexus.exe /run</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/09/19/%E4%BD%BF%E7%94%A8nexus3.x%E6%90%AD%E5%BB%BAmaven%E7%A7%81%E6%9C%8D/#disqus_thread</comments>
    </item>
    
    <item>
      <title>逆向工程vgenerator(三)</title>
      <link>http://vvxtoys.cc/2018/07/11/vgenerator3/</link>
      <guid>http://vvxtoys.cc/2018/07/11/vgenerator3/</guid>
      <pubDate>Wed, 11 Jul 2018 06:00:26 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;该项目的最后一篇博文，最终构建，写入文件，整体项目流程将在本片文章中写出。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>该项目的最后一篇博文，最终构建，写入文件，整体项目流程将在本片文章中写出。</p><a id="more"></a><h3 id="jdbcType"><a href="#jdbcType" class="headerlink" title="jdbcType"></a>jdbcType</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*mysql单位 -&gt; jdbcType</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> JdbcType &#123;</div><div class="line"></div><div class="line">DATE(<span class="string">",date,year,"</span>),</div><div class="line">LONGVARCHAR(<span class="string">",longtext,text,mediumtext,"</span>),</div><div class="line">INTEGER(<span class="string">",int,mediumint,"</span>),</div><div class="line">REAL(<span class="string">",float,"</span>),</div><div class="line">OTHER(<span class="string">",point,multipoint,multilinestring,multipolygon,polygon,geometrycollection,linestring,"</span>),</div><div class="line">TINYINT(<span class="string">",tinyint,"</span>),</div><div class="line">BIGINT(<span class="string">",bigint,"</span>),</div><div class="line">TIMESTAMP(<span class="string">",datetime,timestamp,"</span>),</div><div class="line">VARCHAR(<span class="string">",varchar,tinytext,"</span>),</div><div class="line">BINARY(<span class="string">",tinyblob,binary,geometry,"</span>),</div><div class="line">CHAR(<span class="string">",enum,char,set,"</span>),</div><div class="line">DOUBLE(<span class="string">",double,"</span>),</div><div class="line">BIT(<span class="string">",bit,"</span>),</div><div class="line">SMALLINT(<span class="string">",smallint,"</span>),</div><div class="line">LONGVARBINARY(<span class="string">",mediumblob,blob,longblob,"</span>),</div><div class="line">DECIMAL(<span class="string">",decimal,"</span>),</div><div class="line">VARBINARY(<span class="string">",varbinary,"</span>),</div><div class="line">TIME(<span class="string">",time,"</span>);</div><div class="line"></div><div class="line"><span class="keyword">private</span> String type;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">JdbcType</span><span class="params">(String type)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.type = type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJdbcType</span><span class="params">(String dbtype)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(dbtype.indexOf(<span class="string">"("</span>)!=-<span class="number">1</span>)&#123;</div><div class="line">dbtype = dbtype.substring(<span class="number">0</span>,dbtype.indexOf(<span class="string">"("</span>));</div><div class="line">&#125;</div><div class="line">dbtype = <span class="string">","</span>+dbtype+<span class="string">","</span>;</div><div class="line"><span class="keyword">for</span>(JdbcType jdbc:JdbcType.values())&#123;</div><div class="line"><span class="keyword">if</span>(jdbc.getType().indexOf(dbtype)!=-<span class="number">1</span>)&#123;</div><div class="line"><span class="keyword">return</span> jdbc.name();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="string">"OTHER"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="生成xml"><a href="#生成xml" class="headerlink" title="生成xml"></a>生成xml</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*添加xml节点</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.vgenerator;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.MapperFactory;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlGenerator</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> XMLBean xml;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> k_size;<span class="comment">//主键数</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> c_size;<span class="comment">//去除主键列数</span></div><div class="line"><span class="keyword">private</span> String column;</div><div class="line"><span class="keyword">private</span> String endText = <span class="string">""</span>;<span class="comment">//最后一行  where id  = ""</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; keys;   <span class="comment">//主键   name = jdbctype</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; columns;<span class="comment">//列      name = jdbctype</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">SqlGenerator</span><span class="params">(XMLBean xml)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.xml = xml;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorSql</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(k_size&gt;<span class="number">0</span>)&#123;</div><div class="line">generator1();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">generator2();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generator1</span><span class="params">()</span></span>&#123;</div><div class="line">addResultMap();</div><div class="line">addSql();</div><div class="line">addInsert1();</div><div class="line">addInsert2();</div><div class="line">addSelect();</div><div class="line">addDelete();</div><div class="line">addUpdate1();</div><div class="line">addUpdate2();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generator2</span><span class="params">()</span></span>&#123;</div><div class="line">addResultMap();</div><div class="line">addSql();</div><div class="line">addInsert1();</div><div class="line">addInsert2();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addResultMap</span><span class="params">()</span></span>&#123;</div><div class="line">column  = <span class="string">""</span>;</div><div class="line"><span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">XMLBean resultMap = <span class="keyword">new</span> XMLBean(<span class="string">"resultMap"</span>);</div><div class="line">xml.addElement(resultMap);</div><div class="line">resultMap.init();</div><div class="line">resultMap.addAttribute(<span class="string">"id"</span>, <span class="string">"BaseResultMap"</span>);</div><div class="line">resultMap.addAttribute(<span class="string">"type"</span>, xml.getPojo());</div><div class="line"><span class="keyword">if</span>(k_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:keys.keySet())&#123;</div><div class="line">XMLBean id = <span class="keyword">new</span> XMLBean(<span class="string">"id"</span>);</div><div class="line">resultMap.addElement(id);</div><div class="line">id.init();</div><div class="line">id.addAttribute(<span class="string">"column"</span>, key);</div><div class="line">id.addAttribute(<span class="string">"property"</span>, key);</div><div class="line">id.addAttribute(<span class="string">"jdbcType"</span>, keys.get(key));</div><div class="line"><span class="keyword">if</span>(count&gt;<span class="number">10</span>)&#123;</div><div class="line">column+=<span class="string">"\n"</span>;</div><div class="line">count=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">column+=<span class="string">","</span>+key;</div><div class="line">            count++;</div><div class="line">            setEndText(key, keys.get(key));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean result = <span class="keyword">new</span> XMLBean(<span class="string">"result"</span>);</div><div class="line">resultMap.addElement(result);</div><div class="line">result.init();</div><div class="line">result.addAttribute(<span class="string">"column"</span>, key);</div><div class="line">result.addAttribute(<span class="string">"property"</span>, key);</div><div class="line">result.addAttribute(<span class="string">"jdbcType"</span>, columns.get(key));</div><div class="line"><span class="keyword">if</span>(count&gt;<span class="number">10</span>)&#123;</div><div class="line">column+=<span class="string">"\n"</span>;</div><div class="line">count=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">column+=<span class="string">","</span>+key;</div><div class="line">            count++;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addSql</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean sql = <span class="keyword">new</span> XMLBean(<span class="string">"sql"</span>);</div><div class="line">xml.addElement(sql);</div><div class="line">sql.init();</div><div class="line">sql.addAttribute(<span class="string">"id"</span>, <span class="string">"Base_Column_List"</span>);</div><div class="line">sql.addText(column.substring(<span class="number">1</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addSelect</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean select = <span class="keyword">new</span> XMLBean(<span class="string">"select"</span>);</div><div class="line">xml.addElement(select);</div><div class="line">select.init();</div><div class="line">select.addAttribute(<span class="string">"id"</span>, Vconst.select);</div><div class="line">select.addAttribute(<span class="string">"resultMap"</span>, <span class="string">"BaseResultMap"</span>);</div><div class="line"><span class="keyword">if</span>(k_size==<span class="number">1</span>)&#123;</div><div class="line">String prefix = <span class="string">"java.lang."</span>;</div><div class="line">String type = MapperFactory.ktypes.get(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span>(type.equalsIgnoreCase(<span class="string">"date"</span>))&#123;</div><div class="line">type = <span class="string">"java.util.Date"</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">type = prefix+type;</div><div class="line">&#125;</div><div class="line">select.addAttribute(<span class="string">"parameterType"</span>, type);</div><div class="line">&#125;</div><div class="line">select.addText(<span class="string">"select"</span>);</div><div class="line">XMLBean include = <span class="keyword">new</span> XMLBean(<span class="string">"include"</span>);</div><div class="line">select.addElement(include);</div><div class="line">include.init();</div><div class="line">include.addAttribute(<span class="string">"refid"</span>, <span class="string">"Base_Column_List"</span>);</div><div class="line">select.addEndText(<span class="string">"from "</span>+xml.getTname());</div><div class="line">select.addText(getEndText());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addDelete</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean delete = <span class="keyword">new</span> XMLBean(<span class="string">"delete"</span>);</div><div class="line">xml.addElement(delete);</div><div class="line">delete.init();</div><div class="line">delete.addAttribute(<span class="string">"id"</span>, Vconst.delete);</div><div class="line"><span class="keyword">if</span>(k_size==<span class="number">1</span>)&#123;</div><div class="line">String prefix = <span class="string">"java.lang."</span>;</div><div class="line">String type = MapperFactory.ktypes.get(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span>(type.equalsIgnoreCase(<span class="string">"date"</span>))&#123;</div><div class="line">type = <span class="string">"java.util.Date"</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">type = prefix+type;</div><div class="line">&#125;</div><div class="line">delete.addAttribute(<span class="string">"parameterType"</span>, type);</div><div class="line">&#125;</div><div class="line">delete.addText(<span class="string">"delete from "</span>+xml.getTname());</div><div class="line">delete.addText(getEndText());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addInsert1</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean insert = <span class="keyword">new</span> XMLBean(<span class="string">"insert"</span>);</div><div class="line">xml.addElement(insert);</div><div class="line">insert.init();</div><div class="line">insert.addAttribute(<span class="string">"id"</span>, Vconst.insert);</div><div class="line">insert.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line">String attr = <span class="keyword">null</span>;</div><div class="line">String jdbc = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">int</span> count1 = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> count2 = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span>(k_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:keys.keySet())&#123;</div><div class="line"><span class="keyword">if</span>(attr==<span class="keyword">null</span>)&#123;</div><div class="line">attr = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">attr+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(jdbc==<span class="keyword">null</span>)&#123;</div><div class="line">jdbc = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">jdbc+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(count1&gt;<span class="number">10</span>)&#123;</div><div class="line">attr+=<span class="string">"\n"</span>;</div><div class="line">count1=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(count2&gt;<span class="number">3</span>)&#123;</div><div class="line">jdbc+=<span class="string">"\n"</span>;</div><div class="line">count2=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">count1++;</div><div class="line">count2++;</div><div class="line">attr+=key;</div><div class="line">jdbc+=<span class="string">"#&#123;"</span>+key+<span class="string">","</span>+<span class="string">"jdbcType="</span>+keys.get(key)+<span class="string">"&#125;"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line"><span class="keyword">if</span>(attr==<span class="keyword">null</span>)&#123;</div><div class="line">attr = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">attr+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(jdbc==<span class="keyword">null</span>)&#123;</div><div class="line">jdbc = <span class="string">"("</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">jdbc+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(count1&gt;<span class="number">10</span>)&#123;</div><div class="line">attr+=<span class="string">"\n"</span>;</div><div class="line">count1=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(count2&gt;<span class="number">3</span>)&#123;</div><div class="line">jdbc+=<span class="string">"\n"</span>;</div><div class="line">count2=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">count1++;</div><div class="line">count2++;</div><div class="line">attr+=key;</div><div class="line">jdbc+=<span class="string">"#&#123;"</span>+key+<span class="string">","</span>+<span class="string">"jdbcType="</span>+columns.get(key)+<span class="string">"&#125;"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">attr+=<span class="string">")"</span>;</div><div class="line">jdbc+=<span class="string">")"</span>;</div><div class="line">insert.addText(<span class="string">"insert into "</span>+xml.getTname());</div><div class="line">insert.addText(attr);</div><div class="line">insert.addText(<span class="string">"values"</span>);</div><div class="line">insert.addText(jdbc);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addInsert2</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean insert = <span class="keyword">new</span> XMLBean(<span class="string">"insert"</span>);</div><div class="line">xml.addElement(insert);</div><div class="line">insert.init();</div><div class="line">insert.addAttribute(<span class="string">"id"</span>, Vconst.insert1);</div><div class="line">insert.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line"></div><div class="line">insert.addText(<span class="string">"insert into "</span>+xml.getTname());</div><div class="line">XMLBean trim = <span class="keyword">new</span> XMLBean(<span class="string">"trim"</span>);</div><div class="line">insert.addElement(trim);</div><div class="line">trim.init();</div><div class="line">trim.addAttribute(<span class="string">"prefix"</span>, <span class="string">"("</span>);</div><div class="line">trim.addAttribute(<span class="string">"suffix"</span>, <span class="string">")"</span>);</div><div class="line">trim.addAttribute(<span class="string">"suffixOverrides"</span>, <span class="string">","</span>);</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean test = <span class="keyword">new</span> XMLBean(<span class="string">"if"</span>);</div><div class="line">trim.addElement(test);</div><div class="line">test.init();</div><div class="line">test.addAttribute(<span class="string">"test"</span>, key+<span class="string">" != null"</span>);</div><div class="line">test.addText(key+<span class="string">","</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">XMLBean trim1 = <span class="keyword">new</span> XMLBean(<span class="string">"trim"</span>);</div><div class="line">insert.addElement(trim1);</div><div class="line">trim1.init();</div><div class="line">trim1.addAttribute(<span class="string">"prefix"</span>, <span class="string">"values ("</span>);</div><div class="line">trim1.addAttribute(<span class="string">"suffix"</span>, <span class="string">")"</span>);</div><div class="line">trim1.addAttribute(<span class="string">"suffixOverrides"</span>, <span class="string">","</span>);</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean test = <span class="keyword">new</span> XMLBean(<span class="string">"if"</span>);</div><div class="line">trim1.addElement(test);</div><div class="line">test.init();</div><div class="line">test.addAttribute(<span class="string">"test"</span>, key+<span class="string">" != null"</span>);</div><div class="line">test.addText(<span class="string">"#&#123;"</span>+key+<span class="string">",jdbcType="</span>+columns.get(key)+<span class="string">"&#125;,"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">insert.addEndText(getEndText());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUpdate1</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean update = <span class="keyword">new</span> XMLBean(<span class="string">"update"</span>);</div><div class="line">xml.addElement(update);</div><div class="line">update.init();</div><div class="line">update.addAttribute(<span class="string">"id"</span>, Vconst.update);</div><div class="line">update.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line"></div><div class="line">update.addText(<span class="string">"update "</span>+xml.getTname());</div><div class="line">String content = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line"><span class="keyword">if</span>(content==<span class="keyword">null</span>)&#123;</div><div class="line">content = <span class="string">"set "</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">content+=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line">content+=key+<span class="string">" = "</span>+<span class="string">"#&#123;"</span>+key+<span class="string">",jdbcType="</span>+columns.get(key)+<span class="string">"&#125;\n"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">update.addText(content);</div><div class="line">update.addText(getEndText());</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUpdate2</span><span class="params">()</span></span>&#123;</div><div class="line">XMLBean update = <span class="keyword">new</span> XMLBean(<span class="string">"update"</span>);</div><div class="line">xml.addElement(update);</div><div class="line">update.init();</div><div class="line">update.addAttribute(<span class="string">"id"</span>, Vconst.update1);</div><div class="line">update.addAttribute(<span class="string">"parameterType"</span>, xml.getPojo());</div><div class="line"></div><div class="line">update.addText(<span class="string">"update "</span>+xml.getTname());</div><div class="line">XMLBean set = <span class="keyword">new</span> XMLBean(<span class="string">"set"</span>);</div><div class="line">update.addElement(set);</div><div class="line">set.init();</div><div class="line"><span class="keyword">if</span>(c_size&gt;<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">for</span>(String key:columns.keySet())&#123;</div><div class="line">XMLBean test = <span class="keyword">new</span> XMLBean(<span class="string">"if"</span>);</div><div class="line">set.addElement(test);</div><div class="line">test.init();</div><div class="line">test.addAttribute(<span class="string">"test"</span>, key+<span class="string">" != null"</span>);</div><div class="line">test.addText(key+<span class="string">" = #&#123;"</span>+key+<span class="string">",jdbcType="</span>+columns.get(key)+<span class="string">"&#125;,"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">update.addEndText(getEndText());</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setEndText</span><span class="params">(String key,String value)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(!<span class="string">""</span>.equals(endText))&#123;</div><div class="line">endText +=<span class="string">","</span>;</div><div class="line">&#125;</div><div class="line">endText+=key+<span class="string">" = "</span>+<span class="string">"#&#123;"</span>+key+<span class="string">","</span>+<span class="string">"jdbcType="</span>+value+<span class="string">"&#125;"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getEndText</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="string">"where "</span>+endText;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setK_size</span><span class="params">(<span class="keyword">int</span> k_size)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.k_size = k_size;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC_size</span><span class="params">(<span class="keyword">int</span> c_size)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.c_size = c_size;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="write类"><a href="#write类" class="headerlink" title="write类"></a>write类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*写入项目</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.vgenerator;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.ClassBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.MapperBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VgeneratorWrite</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;ClassBean&gt; clazzs = <span class="keyword">new</span> ArrayList&lt;ClassBean&gt;();</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;MapperBean&gt; mappers = <span class="keyword">new</span> ArrayList&lt;MapperBean&gt;();</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;XMLBean&gt; xmls = <span class="keyword">new</span> ArrayList&lt;XMLBean&gt;();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorFile</span><span class="params">()</span> </span>&#123;</div><div class="line">generatorClazz();</div><div class="line">generatorMapper();</div><div class="line">generatorXML();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorClazz</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (clazzs.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (ClassBean bean : clazzs) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">File file = <span class="keyword">new</span> File(bean.getFileName());</div><div class="line">File fileParent = file.getParentFile(); </div><div class="line"><span class="keyword">if</span>(!fileParent.exists())&#123; </div><div class="line">fileParent.mkdirs(); </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(file.exists())&#123;</div><div class="line">file.delete();</div><div class="line">&#125;</div><div class="line">file.createNewFile();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">Common.writeFile(bean.getFileName(), bean.getContext());</div><div class="line">System.out.println(<span class="string">"generator "</span>+bean.getFileName()+<span class="string">" done"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorMapper</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (mappers.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (MapperBean bean : mappers) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">File file = <span class="keyword">new</span> File(bean.getFileName());</div><div class="line">File fileParent = file.getParentFile(); </div><div class="line"><span class="keyword">if</span>(!fileParent.exists())&#123; </div><div class="line">fileParent.mkdirs(); </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(file.exists())&#123;</div><div class="line">file.delete();</div><div class="line">&#125;</div><div class="line">file.createNewFile();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">Common.writeFile(bean.getFileName(), bean.getContext());</div><div class="line">System.out.println(<span class="string">"generator "</span>+bean.getFileName()+<span class="string">" done"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generatorXML</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (xmls.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (XMLBean bean : xmls) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">File file = <span class="keyword">new</span> File(bean.getFileName());</div><div class="line">File fileParent = file.getParentFile(); </div><div class="line"><span class="keyword">if</span>(!fileParent.exists())&#123; </div><div class="line">fileParent.mkdirs(); </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(file.exists())&#123;</div><div class="line">file.delete();</div><div class="line">&#125;</div><div class="line">file.createNewFile();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">Common.writeFile(bean.getFileName(), bean.toString());</div><div class="line">System.out.println(<span class="string">"generator "</span>+bean.getFileName()+<span class="string">" done"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="generator类"><a href="#generator类" class="headerlink" title="generator类"></a>generator类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*调用该类实现构建</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.vgenerator;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.VgeneratorFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vgenerator</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> VgeneratorFactory factory;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vgenerator</span><span class="params">()</span> </span>&#123;</div><div class="line">factory = <span class="keyword">new</span> VgeneratorFactory();</div><div class="line">&#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vgenerator</span><span class="params">(String configpath)</span></span>&#123;</div><div class="line">    </div><div class="line">    Engine.setConfigFile(configpath);</div><div class="line">    factory = <span class="keyword">new</span> VgeneratorFactory();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">help</span><span class="params">()</span></span>&#123;</div><div class="line">    System.out.println(<span class="string">"url :数据库url"</span>);</div><div class="line">    System.out.println(<span class="string">"name:服务名称"</span>);</div><div class="line">    System.out.println(<span class="string">"user:用户名"</span>);</div><div class="line">    System.out.println(<span class="string">"pass:密码"</span>);</div><div class="line">    System.out.println(<span class="string">"targetProject:生成相对路径"</span>);</div><div class="line">    System.out.println(<span class="string">"targetPackage:实体类包名"</span>);</div><div class="line">    System.out.println(<span class="string">"targetMapper : mapper包名"</span>);</div><div class="line">    System.out.println(<span class="string">"targetXML    : xml包名"</span>);</div><div class="line">    System.out.println(<span class="string">"tableName    : 表名"</span>);</div><div class="line">    System.out.println(<span class="string">"objectName   : 实体名"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span></span>&#123;</div><div class="line">factory.runProperties();</div><div class="line">factory.close();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generatorAllFromDB</span><span class="params">()</span></span>&#123;</div><div class="line">factory.runDB();</div><div class="line">factory.close();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="generator工厂"><a href="#generator工厂" class="headerlink" title="generator工厂"></a>generator工厂</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.BaseBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.ClassBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.DBtype;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.JdbcType;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.MapperBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.DB;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.SqlGenerator;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VgeneratorFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> VgeneratorWrite write = <span class="keyword">new</span> VgeneratorWrite();</div><div class="line"><span class="keyword">private</span> Engine engine = Engine.getInstance();</div><div class="line"><span class="keyword">private</span> ClassFactory  cF;</div><div class="line"><span class="keyword">private</span> MapperFactory mF;</div><div class="line"><span class="keyword">private</span> XMLFactory    xF;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runProperties</span><span class="params">()</span></span>&#123;</div><div class="line">DB db = DB.getInstance();</div><div class="line">String [] tableNames = Engine.tableName;</div><div class="line">String [] objectNames = Engine.objectName;</div><div class="line"><span class="keyword">if</span>(tableNames.length!=objectNames.length)&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tableNames.length;i++)&#123;</div><div class="line">startOperator(tableNames[i], Common.upInitials(tableNames[i]),db);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tableNames.length;i++)&#123;</div><div class="line">startOperator(tableNames[i], objectNames[i],db);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runDB</span><span class="params">()</span></span>&#123;</div><div class="line">DB db = DB.getInstance();</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">List&lt;String&gt; list = db.getTables();</div><div class="line"><span class="keyword">for</span>(String s:list)&#123;</div><div class="line">startOperator(s, Common.upInitials(s), db);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startOperator</span><span class="params">(String tname,String oname,DB db)</span></span>&#123;</div><div class="line"></div><div class="line">SqlGenerator.keys = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">SqlGenerator.columns = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line"></div><div class="line">ClassBean  bean = <span class="keyword">new</span> ClassBean(oname);</div><div class="line">MapperBean mbean = <span class="keyword">new</span> MapperBean(oname);</div><div class="line">XMLBean    xbean = <span class="keyword">new</span> XMLBean(Vconst.DEFAULT_XML_ROOT,tname,oname);</div><div class="line"></div><div class="line">List&lt;String&gt; ps = db.getPrimaryKey(tname);</div><div class="line"><span class="keyword">if</span>(ps==<span class="keyword">null</span>||ps.size()==<span class="number">0</span>)&#123;</div><div class="line">mbean.setPrimary(<span class="keyword">false</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">cF = <span class="keyword">new</span> ClassFactory(bean);</div><div class="line">mF = <span class="keyword">new</span> MapperFactory(mbean);</div><div class="line">xF = <span class="keyword">new</span> XMLFactory();</div><div class="line"></div><div class="line"><span class="keyword">int</span> k_size = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> c_size = <span class="number">0</span>;</div><div class="line">List&lt;String&gt; kname = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">List&lt;String&gt; ktype = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line"><span class="keyword">boolean</span> flag = <span class="keyword">false</span>;<span class="comment">//是否存在时间格式</span></div><div class="line">Map&lt;String,String&gt; cs = db.getColumns(tname);</div><div class="line"><span class="keyword">for</span>(Map.Entry&lt;String, String&gt; m:cs.entrySet())&#123;</div><div class="line">String name = m.getKey();</div><div class="line">String type = m.getValue();</div><div class="line"></div><div class="line"><span class="keyword">if</span>(mbean.isPrimary()&amp;&amp;ps.contains(name))&#123;</div><div class="line">kname.add(name);</div><div class="line">ktype.add(DBtype.getModelType(type));</div><div class="line">SqlGenerator.keys.put(name, JdbcType.getJdbcType(type));</div><div class="line">k_size++;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">SqlGenerator.columns.put(name, JdbcType.getJdbcType(type));</div><div class="line">c_size++;</div><div class="line">&#125;</div><div class="line">cF.addAttribute(DBtype.getModelType(type), name);</div><div class="line"><span class="keyword">if</span>(type.equalsIgnoreCase(<span class="string">"date"</span>))&#123;</div><div class="line">flag = <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">bean.setDependency(flag);</div><div class="line">cF.autoAddMethod();</div><div class="line">cF.addConstructor();</div><div class="line">cF.loadClass();</div><div class="line"></div><div class="line">MapperFactory.knames = kname;</div><div class="line">MapperFactory.ktypes = ktype;</div><div class="line">mF.loadMapper();</div><div class="line"></div><div class="line">xF.createDoc(xbean,k_size,c_size);</div><div class="line"></div><div class="line">write.generatorFile();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</div><div class="line">engine.clear();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="流程分析"><a href="#流程分析" class="headerlink" title="流程分析"></a>流程分析</h3><ul><li><p>实例化Vgenerator g</p><ul><li>实例化 VgeneratorFactory<ul><li>实例化 VgeneratorWrite</li><li>实例化 Engine<ul><li>读取配置文件,加载文件保存到静态属性</li><li>无参默认使用vgenerator.properties</li><li>有参方法设置自定义配置文件,该方法会设置Engine的isDefault属性</li></ul></li></ul></li></ul></li><li><p>调用g.help</p><ul><li>输出配置文件注释</li></ul></li><li><p>调用g.generator() 读取配置文件中的表(支持多表,英文逗号隔开)，生成对应的文件</p><ul><li>factory.runProperties()<ul><li>DB实例化</li><li>获得表名和实体类名<ul><li>开始构建 startOperator()<ul><li>获得主键和所有列,获得列名和类型，保存到SqlGenerator和MapperFactory</li><li>判断是否存在Date类型 设置classBean的dependency属性</li><li>ClassFactory 生成类文本保存到 classbean的context<ul><li>VgeneratorWrite 保存classbean</li></ul></li><li>MapperFactory根据主键生成mapper文本保存到mapperbean的context<ul><li>VgeneratorWrite 保存mapperbean</li></ul></li><li>xmlFactory创建文本<ul><li>SqlGenerator根据主键生成对应xml文本保存到xmlbean<ul><li>VgeneratorWrite 保存xmlbean</li></ul></li></ul></li><li>VgeneratorWrite  generatorFile生成文件</li></ul></li></ul></li></ul></li><li>factory.clear() 结束</li></ul></li><li><p>调用g.generatorAllFromDB() 构建该数据库所有表,除了需要获取所有表，其他流程都一样。</p></li></ul><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>第一个自己写的小项目，虽然有瑕疵，但是感觉还是蛮充实的。下一步需要加强技术了，看看编程思想和设计模式。</p>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/11/vgenerator3/#disqus_thread</comments>
    </item>
    
    <item>
      <title>逆向工程vgenerator(二)</title>
      <link>http://vvxtoys.cc/2018/07/11/vgenerator2/</link>
      <guid>http://vvxtoys.cc/2018/07/11/vgenerator2/</guid>
      <pubDate>Wed, 11 Jul 2018 06:00:11 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;接上篇，这一篇主要的工具类和工厂类，包括数据库方法、通用方法，三个工厂。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>接上篇，这一篇主要的工具类和工厂类，包括数据库方法、通用方法，三个工厂。</p><a id="more"></a><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*默认xml开头 </span></div><div class="line"><span class="comment">*文档分隔</span></div><div class="line"><span class="comment">*默认方法名</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.utils;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vconst</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_XML_ROOT     = <span class="string">"mapper"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_XML_PUBLICID = <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_XML_SYSTEMID = <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String [] ROOTELEMENT = <span class="keyword">new</span> String[<span class="number">1</span>];<span class="comment">//根标签</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SPACE = <span class="string">" "</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String LINE = <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAB  = <span class="string">"\t"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TTAB = <span class="string">"\t\t"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String END  = <span class="string">";"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SPLIT    = <span class="string">"\n\n"</span>;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String insert= <span class="string">"insert"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String insert1              = <span class="string">"insertSelective"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String select= <span class="string">"selectByPrimaryKey"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String delete= <span class="string">"deleteByPrimaryKey"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String update= <span class="string">"updateByPrimaryKey"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String update1= <span class="string">"updateByPrimaryKeySelective"</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="公用"><a href="#公用" class="headerlink" title="公用"></a>公用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.utils;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileWriter;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.PrintWriter;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.LinkedList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.XMLFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Common</span> </span>&#123;</div><div class="line"><span class="comment">//查找文件</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">searchAbsolutePath</span><span class="params">(String filename)</span> </span>&#123;</div><div class="line">String absolutePath = <span class="string">""</span>;</div><div class="line">LinkedList&lt;File&gt; list = <span class="keyword">new</span> LinkedList&lt;File&gt;();</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">File src = <span class="keyword">new</span> File(<span class="string">".\\src"</span>);</div><div class="line">File file = <span class="keyword">new</span> File(src.getCanonicalPath());</div><div class="line">File [] files = file.listFiles();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;files.length;i++)&#123;</div><div class="line">list.add(files[i]);</div><div class="line"><span class="keyword">if</span>(files[i].getAbsolutePath().endsWith(filename))&#123;</div><div class="line">absolutePath = files[i].getAbsolutePath();</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">while</span>(!list.isEmpty())&#123;</div><div class="line">File tmp = list.removeFirst();</div><div class="line"></div><div class="line"><span class="keyword">if</span>(tmp.isDirectory())&#123;</div><div class="line">File [] fs = tmp.listFiles();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;fs.length;j++)&#123;</div><div class="line">File f = fs[j];</div><div class="line"><span class="keyword">if</span>(f==<span class="keyword">null</span>)&#123;</div><div class="line"><span class="keyword">continue</span>;</div><div class="line">&#125;</div><div class="line">list.add(fs[j]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(tmp.getAbsolutePath().endsWith(filename))&#123;</div><div class="line">absolutePath = tmp.getAbsolutePath();</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line"><span class="comment">//首字母大写</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">upInitials</span><span class="params">(String str)</span></span>&#123;</div><div class="line"><span class="keyword">return</span> str.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase()+str.substring(<span class="number">1</span>); </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String filePath, String str)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(filePath), <span class="keyword">true</span>);</div><div class="line">PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">pw.println(str);</div><div class="line">pw.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//xml拼接属性</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">ConcatAttr</span><span class="params">(String name,String value)</span></span>&#123;</div><div class="line">String template = <span class="string">" "</span>+name+<span class="string">"="</span>+<span class="string">"\""</span>+value+<span class="string">"\""</span>;</div><div class="line"><span class="keyword">return</span> template;</div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*mysql数据库连接 </span></div><div class="line"><span class="comment">*获取所有表</span></div><div class="line"><span class="comment">*获取所有列</span></div><div class="line"><span class="comment">*获取主键</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.sql.Connection;</div><div class="line"><span class="keyword">import</span> java.sql.DatabaseMetaData;</div><div class="line"><span class="keyword">import</span> java.sql.DriverManager;</div><div class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</div><div class="line"><span class="keyword">import</span> java.sql.ResultSet;</div><div class="line"><span class="keyword">import</span> java.sql.SQLException;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.factory.XMLFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DB</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String url;</div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="keyword">private</span> String user;</div><div class="line"><span class="keyword">private</span> String pass;</div><div class="line"></div><div class="line"><span class="keyword">public</span> Connection conn = <span class="keyword">null</span>;  </div><div class="line"><span class="keyword">public</span> PreparedStatement pst = <span class="keyword">null</span>;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_URL = <span class="string">"jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=utf8"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_NAME = <span class="string">"com.mysql.jdbc.Driver"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_USER    = <span class="string">"root"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PASS= <span class="string">"root"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">DB</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DB <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">DB db = <span class="keyword">new</span> DB();</div><div class="line">db.setName(Engine.name);</div><div class="line">db.setPass(Engine.pass);</div><div class="line">db.setUrl(Engine.url);</div><div class="line">db.setUser(Engine.user);</div><div class="line">db.Connection();</div><div class="line"></div><div class="line"><span class="keyword">return</span> db;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Connection</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">Class.forName(name);</div><div class="line">conn=DriverManager.getConnection(url,user,pass);</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getTables</span><span class="params">()</span></span>&#123;</div><div class="line">List&lt;String&gt; tables = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">  <span class="keyword">try</span>&#123;</div><div class="line">  <span class="keyword">if</span>(conn!=<span class="keyword">null</span>)&#123;</div><div class="line">  DatabaseMetaData dbmd = conn.getMetaData();</div><div class="line">  ResultSet res = dbmd.getTables(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">new</span> String[]&#123;<span class="string">"TABLE"</span>&#125;);</div><div class="line">  <span class="keyword">while</span> (res.next()) &#123;</div><div class="line"> tables.add(res.getString(<span class="number">3</span>));</div><div class="line">&#125;</div><div class="line">  &#125;</div><div class="line">  &#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line"></div><div class="line">  &#125;  </div><div class="line">  <span class="keyword">return</span> tables;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Map&lt;String,String&gt; <span class="title">getColumns</span><span class="params">(String tablename)</span></span>&#123;</div><div class="line">Map&lt;String,String&gt; result = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">String sql = <span class="string">"desc "</span>+tablename;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">pst = conn.prepareStatement(sql);</div><div class="line">PreparedStatement pst = <span class="keyword">this</span>.pst;</div><div class="line">ResultSet res = pst.executeQuery();</div><div class="line"><span class="keyword">while</span>(res.next())&#123;</div><div class="line">String name = res.getString(<span class="number">1</span>);</div><div class="line">String type = res.getString(<span class="number">2</span>);</div><div class="line">result.put(name, type);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getPrimaryKey</span><span class="params">(String tableName)</span></span>&#123;</div><div class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">DatabaseMetaData dmd = conn.getMetaData();</div><div class="line">ResultSet result = dmd.getPrimaryKeys(<span class="string">""</span>, <span class="string">""</span>, tableName);</div><div class="line"><span class="keyword">while</span>(result.next())&#123;</div><div class="line">list.add(result.getString(<span class="number">4</span>));</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> list;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;  </div><div class="line"><span class="keyword">this</span>.conn.close();  </div><div class="line"><span class="keyword">this</span>.pst.close();  </div><div class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;  </div><div class="line">e.printStackTrace();  </div><div class="line">&#125; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.url = url==<span class="keyword">null</span>||<span class="string">""</span>.equals(url)?DEFAULT_URL:url;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name==<span class="keyword">null</span>||<span class="string">""</span>.equals(name)?DEFAULT_NAME:name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(String user)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.user = user==<span class="keyword">null</span>||<span class="string">""</span>.equals(user)?DEFAULT_USER:user;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPass</span><span class="params">(String pass)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.pass = pass==<span class="keyword">null</span>||<span class="string">""</span>.equals(pass)?DEFAULT_PASS:pass;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="配置文件-vgenerator-properties"><a href="#配置文件-vgenerator-properties" class="headerlink" title="配置文件 vgenerator.properties"></a>配置文件 vgenerator.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">targetPackage=cc.vvxtoys.pojo</div><div class="line">targetProject=src/main/java</div><div class="line">objectName=Record</div><div class="line">tableName=record</div><div class="line">targetMapper=cc.vvxtoys.mapper</div><div class="line">targetXML=cc.vvxtoys.mapper</div><div class="line"></div><div class="line"></div><div class="line">user=root</div><div class="line">url=jdbc\:mysql\://127.0.0.1\:3306/test?useUnicode\=true&amp;characterEncoding\=utf8</div><div class="line">name=com.mysql.jdbc.Driver</div><div class="line">pass=root</div></pre></td></tr></table></figure><h3 id="基本的流程"><a href="#基本的流程" class="headerlink" title="基本的流程"></a>基本的流程</h3><ul><li>初始化配置</li><li>初始化db</li><li>读取对应表的列</li><li>把列单位转换为java单位</li><li>开始构建</li></ul><h3 id="转换单位"><a href="#转换单位" class="headerlink" title="转换单位"></a>转换单位</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*这个类是我用一个笨方法得到的，创建了一个所有类型的表，然后用mybatis-generator构建出来</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> DBtype &#123;</div><div class="line"></div><div class="line">Date(<span class="string">",date,datetime,timestamp,year,time,"</span>),</div><div class="line">String(<span class="string">",longtext,text,varchar,enum,char,mediumtext,tinytext,set,"</span>),</div><div class="line">Double(<span class="string">",double,"</span>),</div><div class="line">Integer(<span class="string">",int,mediumint,"</span>),</div><div class="line">Short(<span class="string">",smallint,"</span>),</div><div class="line">Byte(<span class="string">",tinyint,"</span>),</div><div class="line">ByteArray(<span class="string">",tinyblob,mediumblob,binary,blob,longblob,varbinary,geometry,"</span>),</div><div class="line">Object(<span class="string">",point,multipoint,multilinestring,multipolygon,polygon,geometrycollection,linestring,"</span>),</div><div class="line">Long(<span class="string">",bigint,decimal,"</span>),</div><div class="line">Boolean(<span class="string">",bit,"</span>),</div><div class="line">Float(<span class="string">",float,"</span>);</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> String type;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">DBtype</span><span class="params">(String type)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.type = type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> type;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getModelType</span><span class="params">(String dbtype)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(dbtype.indexOf(<span class="string">"("</span>)!=-<span class="number">1</span>)&#123;</div><div class="line">dbtype = dbtype.substring(<span class="number">0</span>,dbtype.indexOf(<span class="string">"("</span>));</div><div class="line">&#125;</div><div class="line">dbtype = <span class="string">","</span>+dbtype+<span class="string">","</span>;</div><div class="line"><span class="keyword">for</span>(DBtype db:DBtype.values())&#123;</div><div class="line"><span class="keyword">if</span>(db.getType().indexOf(dbtype)!=-<span class="number">1</span>)&#123;</div><div class="line">String model = db.name();</div><div class="line"><span class="keyword">if</span>(model.equals(<span class="string">"ByteArray"</span>))&#123;</div><div class="line">model = <span class="string">"byte[]"</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> model;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="string">"String"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="创建classFactory"><a href="#创建classFactory" class="headerlink" title="创建classFactory"></a>创建classFactory</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*该类实现拼接java</span></div><div class="line"><span class="comment">*生成属性、方法、构造,放进context</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.ClassBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> ClassBean bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span>  List&lt;String&gt; attrs;</div><div class="line"><span class="keyword">public</span>  List&lt;String&gt; types;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassFactory</span><span class="params">(ClassBean bean)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.bean = bean;</div><div class="line">attrs = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">types = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttribute</span><span class="params">(String declare,String type,String name)</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(Vconst.TAB);</div><div class="line">buff.append(declare);</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">buff.append(type);</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">buff.append(name);</div><div class="line">buff.append(Vconst.END);</div><div class="line">buff.append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setAttributes(bean.getAttributes()+buff.toString());</div><div class="line"></div><div class="line">attrs.add(name);</div><div class="line">types.add(type);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttribute</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">addAttribute(<span class="string">"private"</span>, type, name);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttributes</span><span class="params">(String declare,String [] type,String [] name)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(type.length!=name.length)&#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Attribute not available"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;type.length;i++)&#123;</div><div class="line">addAttribute(declare, type[i], name[i]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttributes</span><span class="params">(String [] type,String [] name)</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(type.length!=name.length)&#123;</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Attribute not available"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;type.length;i++)&#123;</div><div class="line">addAttribute(type[i], name[i]);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addGetMethod</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(type).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"get"</span>);</div><div class="line">buffer.append(Common.upInitials(name)).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"("</span>);</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"return"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(name);</div><div class="line">buffer.append(Vconst.END);</div><div class="line">buffer.append(Vconst.LINE).append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setMethods(bean.getMethods()+buffer.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addSetMethod</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"void"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"set"</span>);</div><div class="line">buffer.append(Common.upInitials(name)).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"("</span>);</div><div class="line">buffer.append(type).append(Vconst.SPACE);</div><div class="line">buffer.append(name);</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"this."</span>).append(name).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"="</span>).append(Vconst.SPACE).append(name);</div><div class="line">buffer.append(Vconst.END);</div><div class="line">buffer.append(Vconst.LINE).append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setMethods(bean.getMethods()+buffer.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMethod</span><span class="params">(String type,String name)</span></span>&#123;</div><div class="line">addGetMethod(type, name);</div><div class="line">addSetMethod(type, name);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoAddMethod</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.size();i++)&#123;</div><div class="line">addMethod(types.get(i),attrs.get(i));</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addConstructor</span><span class="params">()</span></span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(bean.getClazz()).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"()"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"super();"</span>).append(Vconst.LINE).append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(bean.getClazz()).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"("</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.size();i++)&#123;</div><div class="line"><span class="keyword">if</span>(i&gt;<span class="number">0</span>)&#123;</div><div class="line">buffer.append(<span class="string">","</span>);</div><div class="line">&#125;</div><div class="line">buffer.append(types.get(i)).append(Vconst.SPACE).append(attrs.get(i));</div><div class="line">&#125;</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"super();"</span>).append(Vconst.LINE);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;attrs.size();j++)&#123;</div><div class="line">buffer.append(Vconst.TTAB);</div><div class="line">buffer.append(<span class="string">"this."</span>).append(attrs.get(j));</div><div class="line">buffer.append(Vconst.SPACE).append(<span class="string">"="</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(attrs.get(j)).append(Vconst.END).append(Vconst.LINE);</div><div class="line">&#125;</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"&#125;"</span>).append(Vconst.LINE);</div><div class="line"></div><div class="line">bean.setConstructors(bean.getConstructors()+buffer.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadClass</span><span class="params">(String declare)</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(<span class="string">"package"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getPackages()).append(Vconst.END);</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line"><span class="keyword">if</span>(bean.isDependency())&#123;</div><div class="line">buff.append(<span class="string">"import"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"java.util.Date"</span>).append(Vconst.END);</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">&#125;</div><div class="line">buff.append(declare).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"class"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getClazz()).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"&#123;"</span>).append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(bean.getAttributes());</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(bean.getConstructors());</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(bean.getMethods());</div><div class="line">buff.append(Vconst.LINE).append(Vconst.LINE);</div><div class="line">buff.append(<span class="string">"&#125;"</span>);</div><div class="line"></div><div class="line">bean.setContext(buff.toString());</div><div class="line"></div><div class="line">VgeneratorWrite.clazzs.add(bean);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadClass</span><span class="params">()</span></span>&#123;</div><div class="line">loadClass(<span class="string">"public"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="生成Mapper"><a href="#生成Mapper" class="headerlink" title="生成Mapper"></a>生成Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*根据主键来生成相对的方法</span></div><div class="line"><span class="comment">*没有主键只会生成insert方法</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.MapperBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> MapperBean bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; knames;<span class="comment">//主键</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; ktypes;<span class="comment">//主键类型</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MapperFactory</span><span class="params">(MapperBean bean)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.bean = bean;</div><div class="line">knames = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">ktypes = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addKeyMethod</span><span class="params">(String method,String type)</span> </span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(type).append(Vconst.SPACE);</div><div class="line">buffer.append(method).append(<span class="string">"("</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; knames.size(); i++) &#123;</div><div class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</div><div class="line">buffer.append(<span class="string">","</span>);</div><div class="line">&#125;</div><div class="line">buffer.append(ktypes.get(i)).append(Vconst.SPACE).append(knames.get(i));</div><div class="line">&#125;</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.END).append(Vconst.SPLIT);</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addMethod</span><span class="params">(String method)</span> </span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">buffer.append(Vconst.TAB);</div><div class="line">buffer.append(<span class="string">"int"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(method).append(<span class="string">"("</span>);</div><div class="line">buffer.append(bean.getClazz()).append(Vconst.SPACE).append(<span class="string">"record"</span>);</div><div class="line">buffer.append(<span class="string">")"</span>).append(Vconst.END).append(Vconst.SPLIT);</div><div class="line"></div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addInsertMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"insert"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addInsertSelectiveMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"insertSelective"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addUpdateMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"updateByPrimaryKeySelective"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addUpdateSelectiveMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addMethod(<span class="string">"updateByPrimaryKey"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addSelectMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addKeyMethod(<span class="string">"selectByPrimaryKey"</span>,bean.getClazz());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">addDeleteMethod</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> addKeyMethod(<span class="string">"deleteByPrimaryKey"</span>,<span class="string">"int"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadMapper</span><span class="params">()</span> </span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(<span class="string">"package"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getPackages()).append(Vconst.END);</div><div class="line">buff.append(Vconst.SPLIT);</div><div class="line">buff.append(<span class="string">"import"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getPojo()).append(Vconst.END);</div><div class="line">buff.append(Vconst.SPLIT);</div><div class="line">buff.append(<span class="string">"public"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"interface"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(bean.getClazz()).append(<span class="string">"Mapper"</span>).append(Vconst.SPACE);</div><div class="line">buff.append(<span class="string">"&#123;"</span>).append(Vconst.LINE);</div><div class="line"><span class="keyword">if</span> (bean.isPrimary()) &#123;</div><div class="line">buff.append(addDeleteMethod());</div><div class="line">buff.append(addUpdateMethod());</div><div class="line">buff.append(addUpdateSelectiveMethod());</div><div class="line">buff.append(addSelectMethod());</div><div class="line">&#125;</div><div class="line">buff.append(addInsertMethod());</div><div class="line">buff.append(addInsertSelectiveMethod());</div><div class="line">buff.append(<span class="string">"&#125;"</span>);</div><div class="line"></div><div class="line">bean.setContext(buff.toString());</div><div class="line">VgeneratorWrite.mappers.add(bean);<span class="comment">//保存到写入类</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="xml工厂类"><a href="#xml工厂类" class="headerlink" title="xml工厂类"></a>xml工厂类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.factory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.bean.XMLBean;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.SqlGenerator;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.vgenerator.VgeneratorWrite;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLFactory</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">double</span> version    = <span class="number">1.0</span>;</div><div class="line"><span class="keyword">private</span> String encoding   = <span class="string">"UTF-8"</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> headDeclare = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="comment">//xml声明</span></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">docStart</span><span class="params">()</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(<span class="string">"&lt;?xml version=\""</span>);</div><div class="line">buff.append(version);</div><div class="line">buff.append(<span class="string">"\" encoding=\""</span>+encoding+<span class="string">"\""</span>);</div><div class="line">buff.append(<span class="string">" ?&gt;"</span>).append(Vconst.LINE);</div><div class="line"><span class="keyword">return</span> buff.toString();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addDoctype</span><span class="params">(String name, String publicId, String systemId)</span></span>&#123;</div><div class="line">Vconst.ROOTELEMENT[<span class="number">0</span>] = name;<span class="comment">//设置根节点</span></div><div class="line">publicId = <span class="string">"\""</span>+publicId+<span class="string">"\""</span>;</div><div class="line">systemId = <span class="string">"\""</span>+systemId+<span class="string">"\""</span>;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer(headDeclare?docStart():<span class="string">""</span>);</div><div class="line">buffer.append(<span class="string">"&lt;!DOCTYPE"</span>).append(Vconst.SPACE);</div><div class="line">buffer.append(name).append(Vconst.SPACE);</div><div class="line">buffer.append(<span class="string">"PUBLIC "</span>).append(publicId).append(Vconst.SPACE);</div><div class="line">buffer.append(systemId).append(<span class="string">" &gt;"</span>);</div><div class="line">buffer.append(Vconst.LINE);</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createDoc</span><span class="params">(XMLBean bean,<span class="keyword">int</span> k_size,<span class="keyword">int</span> c_size)</span></span>&#123;</div><div class="line">bean.init();</div><div class="line">String doctype = addDoctype(Vconst.DEFAULT_XML_ROOT, Vconst.DEFAULT_XML_PUBLICID, Vconst.DEFAULT_XML_SYSTEMID);</div><div class="line">bean.addAttribute(<span class="string">"namespace"</span>, bean.getMapper());</div><div class="line">bean.setContext(doctype+bean.getContext());</div><div class="line">SqlGenerator sql = <span class="keyword">new</span> SqlGenerator(bean);<span class="comment">//生成sql</span></div><div class="line">sql.setK_size(k_size);</div><div class="line">sql.setC_size(c_size);</div><div class="line">sql.generatorSql();</div><div class="line">VgeneratorWrite.xmls.add(bean);<span class="comment">//保存xml文本</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVersion</span><span class="params">(Double version)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.version = version;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEncoding</span><span class="params">(String encoding)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.encoding = encoding;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeadDeclare</span><span class="params">(<span class="keyword">boolean</span> headDeclare)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.headDeclare = headDeclare;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/11/vgenerator2/#disqus_thread</comments>
    </item>
    
    <item>
      <title>逆向工程vgenerator(一)</title>
      <link>http://vvxtoys.cc/2018/07/11/vgenerator1/</link>
      <guid>http://vvxtoys.cc/2018/07/11/vgenerator1/</guid>
      <pubDate>Wed, 11 Jul 2018 05:59:47 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;想要自己实现一个mybatis-generator类似的轮子，目前只实现MySQL部分的方法。利用下班时间，写了一个小项目，实现了这个功能。我准备分成三篇博客来写这个东西。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>想要自己实现一个mybatis-generator类似的轮子，目前只实现MySQL部分的方法。利用下班时间，写了一个小项目，实现了这个功能。我准备分成三篇博客来写这个东西。</p><a id="more"></a><h3 id="基类"><a href="#基类" class="headerlink" title="基类"></a>基类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*基类</span></div><div class="line"><span class="comment">*通用方法和属性</span></div><div class="line"><span class="comment">*getMapper 获取mapper 例如：cc.vvxtoys.mapper.StudentMapper</span></div><div class="line"><span class="comment">*getPojo   获取实体   例如：cc.vvxtoys.pojo.Student</span></div><div class="line"><span class="comment">*getFileName 生成地址</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseBean</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">protected</span> String clazz =<span class="string">""</span>;<span class="comment">//实体类名</span></div><div class="line"><span class="keyword">protected</span> String context =  <span class="string">""</span>;<span class="comment">//bean内容</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getClazz</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> clazz==<span class="keyword">null</span>?<span class="string">""</span>:clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClazz</span><span class="params">(String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getContext</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> context==<span class="keyword">null</span>?<span class="string">""</span>:context;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContext</span><span class="params">(String context)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.context = context;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMapper</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetMapper+<span class="string">"."</span>+clazz+<span class="string">"Mapper"</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPojo</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetPackage+<span class="string">"."</span>+clazz;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Bean"><a href="#Bean" class="headerlink" title="Bean"></a>Bean</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*ClassBean</span></div><div class="line"><span class="comment">*dependency 生成实体是否存在Date类型 存在的话导入java.util.Date</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassBean</span> <span class="keyword">extends</span> <span class="title">BaseBean</span></span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String attributes = <span class="string">""</span>;<span class="comment">//属性</span></div><div class="line"><span class="keyword">private</span> String methods= <span class="string">""</span>;<span class="comment">//方法</span></div><div class="line"><span class="keyword">private</span> String constructors = <span class="string">""</span>;<span class="comment">//构造</span></div><div class="line"><span class="keyword">private</span> String packages= Engine.targetPackage;</div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> dependency= <span class="keyword">false</span>;<span class="comment">//依赖</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassBean</span><span class="params">(String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getAttributes</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> attributes;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAttributes</span><span class="params">(String attributes)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.attributes = attributes;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMethods</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> methods;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMethods</span><span class="params">(String methods)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.methods = methods;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getConstructors</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> constructors;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConstructors</span><span class="params">(String constructors)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.constructors = constructors;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPackages</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> packages;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isDependency</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> dependency;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDependency</span><span class="params">(<span class="keyword">boolean</span> dependency)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.dependency = dependency;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetProject+File.separator+Engine.targetPackage.replace(<span class="string">"."</span>, File.separator)+File.separator+clazz+<span class="string">".java"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*MapperBean</span></div><div class="line"><span class="comment">*primary 主键 一般来说建表是有的，默认为true</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperBean</span> <span class="keyword">extends</span> <span class="title">BaseBean</span></span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String packages = Engine.targetMapper;</div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> primary = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MapperBean</span><span class="params">(String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPrimary</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> primary;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPackages</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> packages;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrimary</span><span class="params">(<span class="keyword">boolean</span> primary)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.primary = primary;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetProject + File.separator + Engine.targetMapper.replace(<span class="string">"."</span>, File.separator)</div><div class="line">+ File.separator + clazz + <span class="string">"Mapper.java"</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*XmlBean</span></div><div class="line"><span class="comment">*这个类其实我是不想写的，原定计划使用dom4j来实现，但是最终使用dom4j换行没有达到我想要的</span></div><div class="line"><span class="comment">*效果，所以我就自己写了一个简单的xml方法，可以满足我现在的需求了。</span></div><div class="line"><span class="comment">*方法就不写注释了，感觉应该能看懂</span></div><div class="line"><span class="comment">*<span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.bean;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Vconst;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.config.Engine;</div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLBean</span> <span class="keyword">extends</span> <span class="title">BaseBean</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String name;<span class="comment">//节点名</span></div><div class="line"><span class="keyword">private</span> List&lt;XMLBean&gt; childrens = <span class="keyword">new</span> ArrayList&lt;XMLBean&gt;();<span class="comment">//子节点</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> cnt;<span class="comment">//用来判断空格</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> isEnd = <span class="keyword">true</span>;<span class="comment">//是否关闭节点</span></div><div class="line"><span class="keyword">private</span> String tname;<span class="comment">//表名</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">XMLBean</span><span class="params">(String name, String tname, String clazz)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name;</div><div class="line"><span class="keyword">this</span>.tname = tname;</div><div class="line"><span class="keyword">this</span>.clazz = clazz;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (name.equals(Vconst.ROOTELEMENT[<span class="number">0</span>])) &#123;</div><div class="line">cnt = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">XMLBean</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>(name, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) &#123;</div><div class="line"><span class="keyword">this</span>.context += Vconst.SPACE;</div><div class="line">&#125;</div><div class="line">context += <span class="string">"&lt;"</span> + name + <span class="string">"&gt;"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addElement</span><span class="params">(XMLBean item)</span> </span>&#123;</div><div class="line">item.setCnt(<span class="keyword">this</span>.cnt + <span class="number">2</span>);</div><div class="line">childrens.add(item);</div><div class="line">isEnd = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addText</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer(context);</div><div class="line">buff.append(Vconst.LINE);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt + <span class="number">1</span>; i++) &#123;</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">&#125;</div><div class="line">buff.append(text);</div><div class="line">context = buff.toString();</div><div class="line">isEnd = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEndText</span><span class="params">(String text)</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (childrens != <span class="keyword">null</span> &amp;&amp; childrens.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">context += Vconst.LINE;</div><div class="line"><span class="keyword">for</span> (XMLBean i : childrens) &#123;</div><div class="line">context += i.toString();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">childrens.clear();</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer(context);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt + <span class="number">1</span>; i++) &#123;</div><div class="line">buff.append(Vconst.SPACE);</div><div class="line">&#125;</div><div class="line">buff.append(text);</div><div class="line">context = buff.toString();</div><div class="line">isEnd = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAttribute</span><span class="params">(String Qname, String value)</span> </span>&#123;</div><div class="line">context = context.substring(<span class="number">0</span>, getSize() - <span class="number">1</span>);</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer(context);</div><div class="line">buff.append(Common.ConcatAttr(Qname, value));</div><div class="line">buff.append(<span class="string">" &gt;"</span>);</div><div class="line">context = buff.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> context.length();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCnt</span><span class="params">(<span class="keyword">int</span> cnt)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.cnt = cnt;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getTname</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> tname;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTname</span><span class="params">(String tname)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.tname = tname;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> Engine.targetProject + File.separator + Engine.targetXML.replace(<span class="string">"."</span>, File.separator) + File.separator</div><div class="line">+ clazz + <span class="string">"Mapper.xml"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer(context);</div><div class="line"><span class="keyword">if</span> (isEnd) &#123;</div><div class="line"><span class="keyword">return</span> context.substring(<span class="number">0</span>, getSize() - <span class="number">1</span>) + <span class="string">"/&gt;\n"</span>;</div><div class="line">&#125;</div><div class="line">buffer.append(Vconst.LINE);</div><div class="line"><span class="keyword">if</span> (childrens != <span class="keyword">null</span> &amp;&amp; childrens.size() &gt; <span class="number">0</span>) &#123;</div><div class="line"><span class="keyword">for</span> (XMLBean i : childrens) &#123;</div><div class="line">buffer.append(i.toString());</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) &#123;</div><div class="line">buffer.append(Vconst.SPACE);</div><div class="line">&#125;</div><div class="line">buffer.append(<span class="string">"&lt;/"</span>).append(name).append(<span class="string">"&gt;"</span>);</div><div class="line">buffer.append(Vconst.LINE);</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="配置工具类"><a href="#配置工具类" class="headerlink" title="配置工具类"></a>配置工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*读取配置文件</span></div><div class="line"><span class="comment">*初始化,如果没有自定义配置文件，默认全文检索默认配置文件</span></div><div class="line"><span class="comment">*author vvxtoys</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">package</span> cc.vvxtoys.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.InputStreamReader;</div><div class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.utils.Common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Engine</span> <span class="keyword">extends</span> <span class="title">Properties</span></span>&#123;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> isDefault = <span class="keyword">true</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> String DEFAULT_CONFIG = <span class="string">"vgenerator.properties"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetPackage;<span class="comment">//实体类包</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetProject;<span class="comment">//项目路径</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetMapper;<span class="comment">//mapper包</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String targetXML;<span class="comment">//xml包</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String [] objectName;<span class="comment">//实体名</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String [] tableName;<span class="comment">//表名</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String user;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String pass;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String name;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> String url;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setConfigFile</span><span class="params">(String path)</span></span>&#123;</div><div class="line">DEFAULT_CONFIG = path;</div><div class="line">isDefault = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">Engine</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">// TODO Auto-generated constructor stub</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Engine <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">Engine engine = <span class="keyword">null</span>;</div><div class="line">String path = isDefault?Common.searchAbsolutePath(DEFAULT_CONFIG):DEFAULT_CONFIG;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">engine = <span class="keyword">new</span> Engine();</div><div class="line">InputStreamReader is = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(path), <span class="string">"UTF-8"</span>);</div><div class="line">engine.load(is);</div><div class="line"></div><div class="line">targetPackage = (String)engine.getProperty(<span class="string">"targetPackage"</span>);</div><div class="line">targetProject = (String)engine.getProperty(<span class="string">"targetProject"</span>);</div><div class="line">targetMapper  = (String)engine.getProperty(<span class="string">"targetMapper"</span>);</div><div class="line">targetXML     = (String)engine.getProperty(<span class="string">"targetXML"</span>);</div><div class="line">tableName     = ((String)engine.getProperty(<span class="string">"tableName"</span>)).split(<span class="string">","</span>);</div><div class="line">objectName    = ((String)engine.getProperty(<span class="string">"objectName"</span>)).split(<span class="string">","</span>);</div><div class="line"></div><div class="line">user  = (String)engine.getProperty(<span class="string">"user"</span>);</div><div class="line">pass      = (String)engine.getProperty(<span class="string">"pass"</span>);</div><div class="line">name          = (String)engine.getProperty(<span class="string">"name"</span>);</div><div class="line">url          = (String)engine.getProperty(<span class="string">"url"</span>);</div><div class="line"></div><div class="line">&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;<span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> engine;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/11/vgenerator1/#disqus_thread</comments>
    </item>
    
    <item>
      <title>自动生成构造方法、getter、setter</title>
      <link>http://vvxtoys.cc/2018/07/10/auto-getset/</link>
      <guid>http://vvxtoys.cc/2018/07/10/auto-getset/</guid>
      <pubDate>Tue, 10 Jul 2018 14:01:25 GMT</pubDate>
      <description>
      
        &lt;h4 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h4&gt;&lt;p&gt;​    一直很想知道IDE是如何自动去生成类的构造和getter、setter方法，大概是有个想法，获取当前的类，利用反射去获取属性名和类型，然后生成，所以我想自己试试。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>​    一直很想知道IDE是如何自动去生成类的构造和getter、setter方法，大概是有个想法，获取当前的类，利用反射去获取属性名和类型，然后生成，所以我想自己试试。</p><a id="more"></a><h4 id="写个模板类"><a href="#写个模板类" class="headerlink" title="写个模板类"></a>写个模板类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> common;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Templates</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_CLASS = <span class="string">"package &#123;0&#125;;\n\n&#123;1&#125;public class &#123;2&#125; &#123;\n\n&#123;3&#125;\n\n&#123;5&#125;\n\n&#123;4&#125;\n&#125;"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_GET   = <span class="string">"\tpublic &#123;0&#125; get&#123;1&#125; () &#123;\n\t\treturn &#123;2&#125;;\n\t&#125;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_SET   = <span class="string">"\tpublic void set&#123;0&#125;(&#123;1&#125; &#123;2&#125;) &#123;\n\t\tthis.&#123;2&#125;=&#123;2&#125;;\n\t&#125;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_ATTR1  = <span class="string">"\tprivate &#123;0&#125; &#123;1&#125;;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_ATTR2  = <span class="string">"\t\tthis.&#123;0&#125;=&#123;0&#125;;\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_IMPORT = <span class="string">"import java.util.Date;\n\n"</span>;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String T_CONSTRUCT = <span class="string">"\tpublic &#123;0&#125;(&#123;1&#125;) &#123;\n\t\tsuper();\n&#123;2&#125;\n\t&#125;\n"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">format</span><span class="params">(String pattern, String ... arguments)</span></span>&#123;</div><div class="line">String format = pattern;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;arguments.length;i++)&#123;</div><div class="line">format = format.replace(<span class="string">"&#123;"</span>+i+<span class="string">"&#125;"</span>,arguments[i]);</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> format;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">loadTemplate</span><span class="params">(String clazz,String pack,String port,</span></span></div><div class="line"><span class="function"><span class="params">String attrs,String get_set,String construct)</span></span>&#123;</div><div class="line"><span class="keyword">return</span> format(T_CLASS, clazz,pack,port,attrs,get_set,construct);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="创建一个实体类"><a href="#创建一个实体类" class="headerlink" title="创建一个实体类"></a>创建一个实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.pojo;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="keyword">private</span> String sex;</div><div class="line"><span class="keyword">private</span> String school;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> common;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.BufferedReader;</div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileWriter;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStreamReader;</div><div class="line"><span class="keyword">import</span> java.io.PrintWriter;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Common</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Logger log = Logger.getLogger(Common.class);</div><div class="line"><span class="comment">//获得绝对路径</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">absolutePath</span><span class="params">(String pack, String name, String suffix)</span> </span>&#123;</div><div class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">String absolutePath = <span class="string">""</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">String packPath = pack.replace(<span class="string">"."</span>, <span class="string">"\\"</span>);</div><div class="line">File src = <span class="keyword">new</span> File(<span class="string">".\\src"</span>);</div><div class="line">File file = <span class="keyword">new</span> File(src.getCanonicalPath());</div><div class="line">File[] fs = file.listFiles();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fs.length; i++) &#123;</div><div class="line"><span class="keyword">if</span> (fs[i].isDirectory()) &#123;</div><div class="line"><span class="keyword">if</span> (fs[i].getAbsolutePath().endsWith(packPath)) &#123;</div><div class="line">absolutePath = fs[i].getAbsolutePath() + <span class="string">"\\"</span> + name + suffix;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">list.add(fs[i].getAbsolutePath());</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; Integer.MAX_VALUE; j++) &#123;</div><div class="line"><span class="keyword">if</span> (j&gt;<span class="number">0</span>&amp;&amp;j == list.size() - <span class="number">1</span>) &#123;</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line">File tmp = <span class="keyword">new</span> File(list.get(j));</div><div class="line">fs = tmp.listFiles();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; fs.length; k++) &#123;</div><div class="line"><span class="keyword">if</span> (fs[k].isDirectory()) &#123;</div><div class="line"><span class="keyword">if</span> (fs[k].getAbsolutePath().endsWith(packPath)) &#123;</div><div class="line">absolutePath = fs[k].getAbsolutePath() + <span class="string">"\\"</span> + name + suffix;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line">list.add(fs[k].getAbsolutePath());</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> absolutePath;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">loadFile</span><span class="params">(String path)</span> </span>&#123;</div><div class="line">File file = <span class="keyword">new</span> File(path);</div><div class="line">String str = <span class="keyword">null</span>;</div><div class="line">BufferedReader reader = <span class="keyword">null</span>;</div><div class="line">StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">String charset = <span class="string">"utf-8"</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">InputStreamReader is = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(file), charset);</div><div class="line">reader = <span class="keyword">new</span> BufferedReader(is);</div><div class="line"><span class="keyword">while</span> ((str = reader.readLine()) != <span class="keyword">null</span>) &#123;</div><div class="line">buffer.append(str);</div><div class="line">buffer.append(<span class="string">"\n"</span>);</div><div class="line">&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">finally</span> &#123;</div><div class="line"><span class="keyword">if</span> (reader != <span class="keyword">null</span>) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">reader.close();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> buffer.toString();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String filePath, String str, <span class="keyword">boolean</span> flg)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(filePath), flg);</div><div class="line">PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">pw.println(str);</div><div class="line">log.info(<span class="string">"写入成功。。。"</span>);</div><div class="line">pw.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(String filePath, String str)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(filePath), <span class="keyword">true</span>);</div><div class="line">PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">pw.println(str);</div><div class="line">log.info(<span class="string">"写入成功。。。"</span>);</div><div class="line">pw.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//首字母大写</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">upInitials</span><span class="params">(String str)</span></span>&#123;</div><div class="line">StringBuffer buff = <span class="keyword">new</span> StringBuffer();</div><div class="line">buff.append(String.valueOf(str.charAt(<span class="number">0</span>)).toUpperCase());</div><div class="line">buff.append(str.toCharArray(),<span class="number">1</span>,str.length()-<span class="number">1</span>);</div><div class="line"><span class="keyword">return</span> buff.toString();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="构建类"><a href="#构建类" class="headerlink" title="构建类"></a>构建类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> auto_get_set;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.Field;</div><div class="line"></div><div class="line"><span class="keyword">import</span> common.Common;</div><div class="line"><span class="keyword">import</span> common.Templates;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> vvxtoys</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassGenerator</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String [] attrs;</div><div class="line"><span class="keyword">private</span> String [] types;</div><div class="line"><span class="keyword">private</span> String absolutePath;</div><div class="line"><span class="keyword">private</span> String context;</div><div class="line"><span class="keyword">private</span> String clazz;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassGenerator</span><span class="params">(Object obj)</span> </span>&#123;</div><div class="line">loadClass(obj);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadClass</span><span class="params">(Object obj)</span></span>&#123;</div><div class="line">Field [] fs = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">String claname = obj.getClass().getSimpleName();</div><div class="line">String suffix = <span class="string">".java"</span>;</div><div class="line">String pack   = obj.getClass().getPackage().getName();</div><div class="line">absolutePath = Common.absolutePath(pack, claname, suffix);</div><div class="line">context = Common.loadFile(absolutePath);</div><div class="line">clazz = claname;</div><div class="line">Class clazz = Class.forName(obj.getClass().getName());</div><div class="line">fs = clazz.getDeclaredFields();</div><div class="line">attrs = <span class="keyword">new</span> String[fs.length];</div><div class="line">types = <span class="keyword">new</span> String[fs.length];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fs.length;i++)&#123;</div><div class="line">attrs[i] = fs[i].getName();</div><div class="line">types[i] = fs[i].getType().getSimpleName();</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoGetSet</span><span class="params">()</span></span>&#123;</div><div class="line">String str = context.substring(<span class="number">0</span>,context.lastIndexOf(<span class="string">"&#125;"</span>));</div><div class="line">String get_set = <span class="string">""</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.length;i++)&#123;</div><div class="line">String g1 = Templates.format(Templates.T_GET, types[i],Common.upInitials(attrs[i]),attrs[i]);</div><div class="line">String s1 = Templates.format(Templates.T_SET, Common.upInitials(attrs[i]),types[i],attrs[i]);</div><div class="line">get_set+=g1+s1;</div><div class="line">&#125;</div><div class="line">str+=get_set;</div><div class="line">str+=<span class="string">"&#125;"</span>;</div><div class="line">context = str;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoConstruct</span><span class="params">()</span></span>&#123;</div><div class="line">String str = context.substring(<span class="number">0</span>,context.lastIndexOf(<span class="string">"&#125;"</span>));</div><div class="line">String c1 = Templates.format(Templates.T_CONSTRUCT, clazz,<span class="string">""</span>,<span class="string">""</span>);</div><div class="line">String params = <span class="string">""</span>;</div><div class="line">String field = <span class="string">""</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;attrs.length;i++)&#123;</div><div class="line">params+=types[i]+<span class="string">" "</span>+attrs[i]+<span class="string">","</span>;</div><div class="line">field+=Templates.format(Templates.T_ATTR2, attrs[i]);</div><div class="line">&#125;</div><div class="line">params = params.substring(<span class="number">0</span>,params.length()-<span class="number">1</span>);</div><div class="line">String c2 = Templates.format(Templates.T_CONSTRUCT, clazz,params,field);</div><div class="line">str +=c1+c2;</div><div class="line">str+=<span class="string">"&#125;"</span>;</div><div class="line">context = str;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateClass</span><span class="params">()</span></span>&#123;</div><div class="line">Common.writeFile(absolutePath, context,<span class="keyword">false</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">autoConstruct();</div><div class="line">autoGetSet();</div><div class="line">updateClass();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> auto_get_set;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.pojo.Student;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">ClassGenerator g = <span class="keyword">new</span> ClassGenerator(<span class="keyword">new</span> Student());</div><div class="line">g.run();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="构建之后的实体类"><a href="#构建之后的实体类" class="headerlink" title="构建之后的实体类"></a>构建之后的实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.pojo;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="keyword">private</span> String sex;</div><div class="line"><span class="keyword">private</span> String school;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id,String name,String sex,String school)</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line"><span class="keyword">this</span>.id=id;</div><div class="line"><span class="keyword">this</span>.name=name;</div><div class="line"><span class="keyword">this</span>.sex=sex;</div><div class="line"><span class="keyword">this</span>.school=school;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.id=id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> name;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name=name;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSex</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.sex=sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSchool</span> <span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> school;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSchool</span><span class="params">(String school)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.school=school;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h4><p>  写写停停大概也是花费了两天的时间，东西虽然很小，也还有bug，但是还是有点成就感的。我知道IDE肯定不可能用这么蠢得实现方式，但是以我现在的想法只能这样了，还是需要多学点东西，然后我再重构这些代码。</p>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/10/auto-getset/#disqus_thread</comments>
    </item>
    
    <item>
      <title>POI导入demo</title>
      <link>http://vvxtoys.cc/2018/07/10/poi-simpleDemo/</link>
      <guid>http://vvxtoys.cc/2018/07/10/poi-simpleDemo/</guid>
      <pubDate>Tue, 10 Jul 2018 14:01:07 GMT</pubDate>
      <description>
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;使用上篇博文的导入方法，写一个简单的导入demo。其实有了工具类之后就没啥难度了，也就只简单的拿数据。先写个简单的，然后想办法实现动态读取吧，这样读取其实还是比较烦的，每次该模板都要改代码，说到底我还是比较懒的。&lt;/p&gt;
      
      </description>
      
      <content:encoded><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>使用上篇博文的导入方法，写一个简单的导入demo。其实有了工具类之后就没啥难度了，也就只简单的拿数据。先写个简单的，然后想办法实现动态读取吧，这样读取其实还是比较烦的，每次该模板都要改代码，说到底我还是比较懒的。</p><a id="more"></a><h3 id="excel文件"><a href="#excel文件" class="headerlink" title="excel文件"></a>excel文件</h3><p><img src="https://i.loli.net/2018/09/24/5ba8af0a9e5c1.png" alt=""></p><h3 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.poi;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String id;</div><div class="line"><span class="keyword">private</span> String stcode;</div><div class="line"><span class="keyword">private</span> String stname;</div><div class="line"><span class="keyword">private</span> String sex;</div><div class="line"><span class="keyword">private</span> String phone;</div><div class="line"><span class="keyword">private</span> String school;</div><div class="line"><span class="keyword">private</span> String address;</div><div class="line"><span class="keyword">private</span> String birthday;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> birthday;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(String birthday)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.birthday = birthday;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.id = id;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getStcode</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> stcode;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStcode</span><span class="params">(String stcode)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.stcode = stcode;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getStname</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> stname;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStname</span><span class="params">(String stname)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.stname = stname;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.sex = sex;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPhone</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> phone;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPhone</span><span class="params">(String phone)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.phone = phone;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSchool</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> school;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSchool</span><span class="params">(String school)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.school = school;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> address;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.address = address;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String id, String stcode, String stname, String sex, String phone, String school, String address)</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line"><span class="keyword">this</span>.id = id;</div><div class="line"><span class="keyword">this</span>.stcode = stcode;</div><div class="line"><span class="keyword">this</span>.stname = stname;</div><div class="line"><span class="keyword">this</span>.sex = sex;</div><div class="line"><span class="keyword">this</span>.phone = phone;</div><div class="line"><span class="keyword">this</span>.school = school;</div><div class="line"><span class="keyword">this</span>.address = address;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">super</span>();</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="service"><a href="#service" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cc.vvxtoys.poi;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cc.vvxtoys.util.CommonTools;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelService</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> ImportExcelUtils utils = <span class="keyword">new</span> ImportExcelUtils();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getExcelParser</span><span class="params">(String path, String sheet, String start, String end)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">InputStream is = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(path)) &#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">new</span> FileNotFoundException(<span class="string">"file not found"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">is = <span class="keyword">new</span> FileInputStream(path);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (path.endsWith(ImportExcelUtils.EXCEL_2003)) &#123;</div><div class="line">HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook(is);</div><div class="line"><span class="keyword">return</span> importXls(start, end, workbook, sheet);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (path.endsWith(ImportExcelUtils.EXCEL_2007)) &#123;</div><div class="line">XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(is);</div><div class="line"><span class="keyword">return</span> importXlsx(start, end, workbook, sheet);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">is.close();</div><div class="line"><span class="keyword">return</span> <span class="keyword">new</span> Exception(<span class="string">"type error"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">importXls</span><span class="params">(String start, String end, HSSFWorkbook workbook, String sheet)</span> </span>&#123;</div><div class="line">Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">List&lt;Student&gt; sList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">HSSFSheet hssfSheet = <span class="keyword">null</span>;</div><div class="line"><span class="comment">// 如果传过来sheet页的名称,取当前sheet页,否则遍历所有sheet</span></div><div class="line"><span class="keyword">if</span> (!utils.isEmpty(sheet)) &#123;</div><div class="line">hssfSheet = workbook.getSheet(sheet);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; workbook.getNumberOfSheets(); i++) &#123;</div><div class="line">hssfSheet = workbook.getSheetAt(i);</div><div class="line"><span class="keyword">int</span> maxIndex = hssfSheet.getLastRowNum();<span class="comment">// 获取最大下标</span></div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> endIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(start)) &#123;</div><div class="line">start = String.valueOf(<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(end)) &#123;</div><div class="line">end = maxIndex + String.valueOf(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(start) &lt;= <span class="number">1</span>) &#123;</div><div class="line">startIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = Integer.parseInt(start) - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(end) &gt; maxIndex) &#123;</div><div class="line">endIndex = maxIndex + <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">endIndex = Integer.parseInt(end);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = startIndex; j &lt; endIndex; j++) &#123;</div><div class="line">Student student = <span class="keyword">new</span> Student();</div><div class="line">HSSFRow row = hssfSheet.getRow(j);</div><div class="line">                      <span class="comment">//空行</span></div><div class="line"><span class="keyword">if</span> (utils.isBlank(row)) &#123;</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line">HSSFCell c1 = row.getCell(<span class="number">0</span>);</div><div class="line">HSSFCell c2 = row.getCell(<span class="number">1</span>);</div><div class="line">HSSFCell c3 = row.getCell(<span class="number">2</span>);</div><div class="line">HSSFCell c4 = row.getCell(<span class="number">3</span>);</div><div class="line">HSSFCell c5 = row.getCell(<span class="number">4</span>);</div><div class="line">HSSFCell c6 = row.getCell(<span class="number">5</span>);</div><div class="line">HSSFCell c7 = row.getCell(<span class="number">6</span>);</div><div class="line">student.setId(CommonTools.get32UUID());<span class="comment">//获取uuid 这个方法就不列出了，很简单</span></div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c1))&#123;</div><div class="line">String stcode = utils.getValue(c1);</div><div class="line">student.setStcode(stcode);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c2))&#123;</div><div class="line">String stname = utils.getValue(c2);</div><div class="line">student.setStname(stname);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c3))&#123;</div><div class="line">String sex = utils.getValue(c3);</div><div class="line">student.setSex(sex);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c4))&#123;</div><div class="line">String phone = utils.getValue(c4);</div><div class="line">student.setPhone(phone);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c5))&#123;</div><div class="line">String birthday = utils.getValue(c5).replaceAll(<span class="string">"/"</span>, <span class="string">"-"</span>);</div><div class="line">student.setBirthday(birthday);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c6))&#123;</div><div class="line">String school = utils.getValue(c6);</div><div class="line">student.setSchool(school);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c7))&#123;</div><div class="line">String address = utils.getValue(c7);</div><div class="line">student.setAddress(address);</div><div class="line">&#125;</div><div class="line">sList.add(student);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">result.put(<span class="string">"sList"</span>, sList);</div><div class="line"><span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">importXlsx</span><span class="params">(String start, String end, XSSFWorkbook workbook, String sheet)</span> </span>&#123;</div><div class="line">Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">List&lt;Student&gt; sList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">XSSFSheet xssfSheet = <span class="keyword">null</span>;</div><div class="line"><span class="comment">// 如果传过来sheet页的名称,取当前sheet页,否则遍历所有sheet</span></div><div class="line"><span class="keyword">if</span> (!utils.isEmpty(sheet)) &#123;</div><div class="line">xssfSheet = workbook.getSheet(sheet);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; workbook.getNumberOfSheets(); i++) &#123;</div><div class="line">xssfSheet = workbook.getSheetAt(i);</div><div class="line"><span class="keyword">int</span> maxIndex = xssfSheet.getLastRowNum();<span class="comment">// 获取最大下标</span></div><div class="line"><span class="keyword">int</span> startIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> endIndex = <span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(start)) &#123;</div><div class="line">start = String.valueOf(<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (utils.isEmpty(end)) &#123;</div><div class="line">end = maxIndex + String.valueOf(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(start) &lt;= <span class="number">1</span>) &#123;</div><div class="line">startIndex = <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">startIndex = Integer.parseInt(start) - <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (Integer.parseInt(end) &gt; maxIndex) &#123;</div><div class="line">endIndex = maxIndex + <span class="number">1</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">endIndex = Integer.parseInt(end);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = startIndex; j &lt; endIndex; j++) &#123;</div><div class="line">Student student = <span class="keyword">new</span> Student();</div><div class="line">XSSFRow row = xssfSheet.getRow(j);</div><div class="line">XSSFCell c1 = row.getCell(<span class="number">0</span>);</div><div class="line">XSSFCell c2 = row.getCell(<span class="number">1</span>);</div><div class="line">XSSFCell c3 = row.getCell(<span class="number">2</span>);</div><div class="line">XSSFCell c4 = row.getCell(<span class="number">3</span>);</div><div class="line">XSSFCell c5 = row.getCell(<span class="number">4</span>);</div><div class="line">XSSFCell c6 = row.getCell(<span class="number">5</span>);</div><div class="line">XSSFCell c7 = row.getCell(<span class="number">6</span>);</div><div class="line"></div><div class="line">student.setId(CommonTools.get32UUID());<span class="comment">//uuid</span></div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c1))&#123;</div><div class="line">String stcode = utils.getValue(c1);</div><div class="line">student.setStcode(stcode);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c2))&#123;</div><div class="line">String stname = utils.getValue(c2);</div><div class="line">student.setStname(stname);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c3))&#123;</div><div class="line">String sex = utils.getValue(c3);</div><div class="line">student.setSex(sex);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c4))&#123;</div><div class="line">String phone = utils.getValue(c4);</div><div class="line">student.setPhone(phone);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c5))&#123;</div><div class="line">String birthday = utils.getValue(c5).replaceAll(<span class="string">"/"</span>, <span class="string">"-"</span>);</div><div class="line">student.setBirthday(birthday);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c6))&#123;</div><div class="line">String school = utils.getValue(c6);</div><div class="line">student.setSchool(school);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(!utils.isEmpty(c7))&#123;</div><div class="line">String address = utils.getValue(c7);</div><div class="line">student.setAddress(address);</div><div class="line">&#125;</div><div class="line">sList.add(student);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">result.put(<span class="string">"sList"</span>, sList);</div><div class="line"><span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">String path = <span class="string">"D:\\Desktop\\2.xlsx"</span>; <span class="comment">//文件路径</span></div><div class="line">String start = <span class="string">"0"</span>; <span class="comment">//开始条数</span></div><div class="line">String end = <span class="string">"10"</span>;<span class="comment">//结束条数</span></div><div class="line">String sheet = <span class="keyword">null</span>;<span class="comment">//sheet页名称</span></div><div class="line">ExcelService service = <span class="keyword">new</span> ExcelService();</div><div class="line">Map&lt;String, Object&gt; result = (Map&lt;String, Object&gt;) service.getExcelParser(path, sheet, start, end);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content:encoded>
      
      <comments>http://vvxtoys.cc/2018/07/10/poi-simpleDemo/#disqus_thread</comments>
    </item>
    
  </channel>
</rss>
